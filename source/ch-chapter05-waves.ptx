<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter05-waves" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Water waves</title>

  <introduction>
    <p>In the mid-nineteenth century, George Gabriel Stokes made significant contributions to the
      study of water waves, establishing much of the theoretical foundation that underpins modern
      fluid mechanics. His analysis of periodic, finite-amplitude waves on the surface of an
      incompressible fluid led to what are now known as <em>Stokes waves</em>, which describe how
      real waves deviate from purely sinusoidal motion as their amplitude increases. Stokesâ€™ work
      marked a shift from qualitative observation to quantitative description, providing a
      systematic framework for understanding the balance of gravity, inertia, and nonlinearity in
      wave motion.</p>

    <p>Our main task in this chapter is to introduce the fundamental principles governing water
      waves and the mathematical models that describe their behavior across different regimes.</p>

  <note>
    <p>
      As part of our lecture, we will study the related <url href="https://techtv.mit.edu/collections/ifluids/videos/32616-waves-in-fluids">video on the NCFMF database</url> on Waves in Fluids. The particular section of relevance is at the start, concerning the particle trajectories in waves of deep water. 
    </p>
  </note>

  </introduction>



  <section xml:id="sec-waterwaves-equations">
    <title>Governing equations of water waves</title>
<introduction>
    <p> We shall consider the case of waves on the free surface of a two-dimensional potential fluid
      (hence inviscid, incompressible, and irrotational). The free surface bounds the water from above, and is assumed to be given by 
      <me> 
        y = \eta(x, t) \qquad -\infty &lt; x &lt; \infty.
      </me>
    </p>

    <p>
      Since the fluid satisfies the assumptions of potential flow, there exists a velocity potential <m>\bu = \nabla \phi</m> where
      <me>
      \nabla^2 \phi = \pd{^2 \phi}{x^2} + \pd{^2\phi}{y^2} = 0 \qquad \text{in the fluid}.   
      </me>
    </p>

    <p>
      What makes water-wave problems unique (and challenging) is that not only do we need to solve for the potential (and hence velocities) within the fluid, as given by Laplace's equation above, but that we must do so in an <em>a priori</em> unknown domain, where the free-surface location <m>y = \eta(x, t)</m> must also be solved in parallel. Key considerations, then, must relate to the precise boundary conditions to impose.
    </p>
  </introduction>
    <subsection xml:id="subsec-waterwaves-boundaryconditions">
      <title>Boundary conditions</title>

      <subsubsection xml:id="subsubsec-waterwaves-otherBC">
        <title>Bottom boundary conditions</title>
      <p>
        If we consider waves on a fluid of infinite (or deep) depth, then far below the free surface, we expect that the velocity tends to zero. Hence a suitable boundary condition is
        <men xml:id="eqn-waterwaves-farfield-infinite">
          \bu = \nabla \phi \to 0 \quad \text{as $y \to -\infty$}.
        </men>
      </p>

      <p>
        On the other hand, for the case of fluid bounded below by a flat bed, say at <m>y = -H</m>, we have
        <men xml:id="eqn-waterwaves-bottom">
          \bu \cdot \bn = 0 \Longrightarrow \pd{\phi}{y} = 0 \qquad \text{on $y = -H$}. 
        </men>
      </p>
      </subsubsection>

      <subsubsection xml:id="subsubsec-waterwaves-dynamicBC">
        <title>Dynamic boundary conditions</title>
        

      <p>
        There are now two boundary conditions to consider at the free surface. The <em>dynamic boundary condition</em> corresponds to the requirement of satisfying a force balance at the free surface. At the free surface, the pressure within the liquid must be equal to the pressure within the air. This leads to the dynamic boundary condition that 
        <men xml:id="eqn-waterwaves-pressure">
          p = p_{\text{atm}} \qquad \text{at $y = \eta(x, t)$},
        </men> tv
        where <m>p_{\text{atm}}</m> is the atmospheric pressure above the fluid (assumed to be constant). 
      </p>

      <p>
        Typically, we need the above pressure condition expressed in terms of <m>\phi</m>, and this suggests using Bernoulli's equation. We require yet another version of Bernoilli's equation from a previous chapter, this one for unsteady flow and posed in terms of a potential function. This involves returning to an earlier manipulation of the momentum equation giving <xref ref="eqn-bernoulli-unsteady-chap3"/>:
      </p>

      <theorem xml:id="thm-bernoulli-unsteady-potential">
        <title>Bernoulli's equation for unsteady potential flow</title>
        <statement>
          <p>
           Bernoulli's equation for unsteady potential flow states that 
           <men xml:id="eqn-bernoulli-unsteady-potential">
            \pd{\phi}{t} + \frac{1}{2}|\nabla\phi|^2 + \frac{p}{\rho} + \chi = F(t),
           </men>
          for an arbitrary function <m>F(t)</m>, and where <m>\bg = -\nabla\chi</m> is the conservative body force. 
          </p>
        </statement>

        <proof>
          <p>
            Returning to <xref ref="eqn-bernoulli-unsteady-chap3"/>, we re-write in terms of the potential function and set the vorticity <m>\omega = \nabla \times \bu = 0</m>, giving 
            <me>
              \pd{}{t}(\nabla \phi) = - \nabla \left(\frac{1}{\rho}\nabla p +
            \frac{1}{2} |\nabla \phi|^2 + \chi\right).
            </me>
            We can interchange the order of differentiation on the left 
            <me>
            \nabla\left(  \pd{\phi}{t}+\frac{1}{\rho}\nabla p +
            \frac{1}{2} |\nabla \phi|^2 + \chi\right) = 0.
            </me> 
            We now integrate each of the spatial components and this yields the desired result.
          </p>
        </proof>
      </theorem>

      <p>
        Below, we will set the body force indeed to be gravity. Thus if we write 
        <me>
          \chi = gy \Longrightarrow \bg = -\nabla \chi = \Bigl[0, -g\Bigr],
        </me>
        and gravity is then directed in the negative <m>y</m>-direction. 
      </p>

      <p>
        We now evaluate Bernoulli's equation <xref ref="eqn-bernoulli-unsteady-potential"/> on the free surface, <m>y = \eta</m>. This gives 
        <me>
        \pd{\phi}{t} + \frac{1}{2}|\nabla\phi|^2 + \frac{p_{\text{atm}}}{\rho} + g\eta = F(t), \qquad \text{on $y = \eta$}.
        </me>
        It is convenient to set the arbirary function <m>F(t) = \frac{p_{\text{atm}}}{\rho}</m>, yielding the final result:
        <me>
        \pd{\phi}{t} + \frac{1}{2}|\nabla\phi|^2 + g\eta = 0, \qquad \text{on $y = \eta$},
        </me>
        which is a re-phrasing of the necessary dynamic boundary condition on the free surface. 
      </p>
      </subsubsection>

      <subsubsection xml:id="subsubsec-waterwaves-kinematicBC">
        <title>Kinematic boundary conditions</title>

        <p>
          In the case of fluids near solid surfaces, we require a <em>no-penetration</em> condition, which enforces that the fluid velocity is zero in a direction normal to the surface, <m>\bu \cdot \bn = 0</m>. For the case of a free boundary, such as the one at <m>y = \eta(x, t)</m>, there is a similar constraint, and it may be shown that this is equivalent to imposing that the material fluid fluid elements on the free surface must remain on the free surface. 
        </p>

        <p>
          Thus, if <m>y = \eta</m> for some fluid particle at time <m>t</m>, then <m>y = \eta</m> for the same particle for all time. Thus we need
          <me>
            \DD{(y - \eta)}{t} = 0, \qquad \text{on $y = \eta$}.
          </me>
        </p>

        <p>
          Expansion and use of the material derivative then implies the <em>kinematic boundary condition</em>
          <men xml:id="eqn-waterwaves-kinematicBC">
            v = \pd{\eta}{t} + u \pd{\eta}{x}, \qquad \text{at $y = \eta$}.
          </men>
        </p>
      </subsubsection>
    </subsection>

    <subsection xml:id="subsec-summary-of-potential-flow">
      <title>Summary of the governing equations</title>

      <p>
        Let us summarise the governing water-wave equations in one section. 
      </p>

      <theorem xml:id="thm-waterwaves-governing">
        <title>Water wave equations in potential flow</title>
        <statement>
          <p>
           Consider two-dimensional free-surface flow of a potential (inviscid, incompressible, irrotational) fluid. The fluid satisfies Laplace's equation, 
           <me>
            \nabla^2 \phi = 0, \qquad \text{in the fluid domain}.
           </me>
          </p>

          <p>
            On the free surface, we have the kinematic boundary condition and dynamic boundary conditions:
            <mdn>
              <mrow xml:id="wwfull02">\pd{\eta}{t} + u \pd{\eta}{x} = v, \qquad &amp; y = \eta(x, t)</mrow>
              <mrow xml:id="wwfull03">\pd{\phi}{t} + \frac{1}{2}|\nabla \phi|^2 + g\eta = 0, \qquad &amp; y = \eta(x, t).</mrow>
            </mdn>
          </p>

          <p>
            Finally there is typically a condition in the far field, either at infinity in the case of infinite depth, or a condition on a channel bottom in the case of finite depth. For example, in the case of infinite depth and an otherwise motionless fluid at infinity, we would require 
           <me>
            \nabla \phi \to 0, \qquad \text{as $y \to -\infty$}.
           </me>
          </p>

          <p>
            While for the case of a finite channel bottom at <m>y = -h</m>, we would require 
            <me>
              \pd{\phi}{y} = 0 \qquad \text{on $y = -h$}.
            </me>
            
          </p>
        </statement>
      </theorem>
      
      
    </subsection>


  </section>

  <section xml:id="sec-wave-parameters">
    <title>Wave parameters</title>

    <p>
      A general travelling wave is written as 
      <men xml:id="eqn-travelling-wave">
        \eta = a\sin\left[ kx - \omega t \right].
      </men>
      An additional phase, e.g. in <m>\sin(kx - \omega t - \beta)</m> can be included but this can be removed through a shift in space or time. What do the quantities <m>k</m> and <m>\omega</m> represent?
    </p>

    <p>
     We can factor out the <m>k</m> and obtain 
     <me>
      \eta = a\sin \left[k\left( x - \frac{\omega}{k}t\right)\right].
     </me>
     The quantity <m>k</m> is called the <em>wavenumber</em>. If we define it instead to be 
     <men xml:id="eqn-wavenumber">
      k \equiv \frac{2\pi}{\lambda},
     </men>
      then we see that shifting <m>x</m> by <m>\pm \lambda</m> does not change the wave. The quantity <m>\lambda</m> is called the <em>wavelength</em>.
    </p>

    <p>
      Let us now turn to the quantity <m>\omega/k</m>. If we introduce
      <men xml:id="eqn-wavespeed">
        c \equiv \frac{\omega}{k},
      </men>
      then <m>c</m> is called the <em>phase speed</em>. It corresponds to the speed at which the "phase" of the wave (the crests and troughs) propagate.
    </p>

    <p>
      At a fixed location in space, what is the time that it takes for the condition at this point to repeat itself? It is the time required for the wave to travel one wavelength, <m>\lambda</m>. Hence this is defined as <em>the period</em> of the wave:
      <men xml:id="eqn-wave-period">
        T \equiv \frac{\lambda}{c}.
      </men>
    </p>

    <p>
      These concepts can be generalised to wave in a three-dimensional fluid, where we would write instead
      <men xml:id="eqn-wave-3d">
        \eta = a\sin(kx + ly + mz - \omega t) = a \sin(\boldsymbol{K} \cdot \bx - \omega t).
    </men></p>

    <p>
    In this case, <m>\boldsymbol{K} = (k, l, m)</m> is the <em>wavenumber vector</em> and has magnitude <m>K = \sqrt{k^2 + l^2 + m^2}</m>. The wavelength is then 
    <men xml:id="eqn-wave-3d-wavelength">
      \lambda = \frac{2\pi}{K}.
    </men>
    </p>

    <p>
      The phase velocity is given by 
      <men xml:id="eqn-3d-phase">
        \boldsymbol{c} = \frac{\omega}{K} \frac{\boldsymbol{K}}{K}.
      </men>
      
    </p>
    
  </section>

  <section xml:id="sec-waterwaves-stokeswaves">
    <title>Stokes waves</title>

    <subsection xml:id="subsec-waterwaves-linearisation">
      <title>Linearisation of the water-wave equations</title>


      <p>
        Our task in this section is to linearise the water-wave equations given in <xref ref="thm-waterwaves-governing"/>. The culprit to the difficulty in seeking solutions concerns two main issues. The first is the nonlinearity in Bernoulli's equation (i.e. the term <m>|\nabla\phi|^2</m>). The second is to do with the specification of the unknown free surface, <m>\eta(x, t)</m>, and the need to solve the extra equations on this unknown location. 
      </p>

      <p>
        The idea of linearisation relies upon the consideration that if disturbances in the fluid are small, then the quadratic terms in the free-surface conditions can be neglected. One way to see this is to introduce a scaling on all the associated quantities. For example, we consider the free surface as written as 
        <men xml:id="etasmall">
          \eta(x, t) = \delta \overline{\eta}(x, t), 
        </men>
       where <m>\delta \ll 1</m> (<m>\delta</m> is a small number). The parameter <m>\delta</m> is simply a notational device to help remind us of the smallness of the free surface.  
      </p>  

      <p>
        Now since we assume the motion in the fluid is also small, then we introduce a similar scaling on the potential function. We assume 
        <men xml:id="phismall">
          \phi(x, y, t) = \delta \overline{\phi}(x, y, t), 
        </men>
        within the fluid. As a consequence, all velocities are small and of order <m>\delta</m>. 
      </p>
        
      <p>Now consider the evaluation of the vertical velocity on the surface. By Taylor's formula, we can expand: 
        <me>
          v = \pd{\phi(x, \eta, t) }{y}= \pd{\phi(x, 0, t)}{y} + \pd{^2\phi(x, 0, t)}{y^2} \eta + \text{higher-order terms}.
        </me>
     In fact, if we use our assumptions <xref ref="etasmall"/> and <xref ref="phismall"/>, we can see the size of the vertical velocity more explicitly: 
        <me>
          v = \delta \pd{\overline{\phi}(x, 0, t)}{y} + \delta^2 \pd{^2\overline{\phi}(x, 0, t)}{y^2} \overline{\eta} + O(\delta^3).
        </me>
      We will essentially ignore all terms of <m>\delta^2</m> or smaller. 
      </p>

      <p>
        Let us consider now the kinematic condition <xref ref="wwfull02"/>. Since the term with the horizontal velocity <m>u \pd{\eta}{x} = O(\delta^2)</m>, then we see that the kinematic approximation now yields
        <me>
          \delta\pd{\overline{\eta}}{t} = \delta \pd{\overline{\phi}}{y} + O(\delta^2), \qquad \text{on $y = 0$}.
        </me>
        As we indicated, the use of <m>\delta</m> is only to aid with ordering. We see that if we return back to the original variable scalings, then the above indicates that the approximate kinematic condition to be considered is: 
        <me>
          \pd{\eta}{t} \sim \pd{\phi}{y} \qquad \text{on $y = 0$}.
        </me>
        It is typical, when dealing with linear water waves, to dispense with the notation indicating "approximate", i.e. <m>\sim</m> here, on the understanding that the solutions are satisfied only approximately. 
      </p>

      <remark>
        <p>
          The development of the linearised equation(s) seem quite lengthy, as presented above, but with understanding, you will see that they are quite simple. In essence, you have replaced the exact free-surface condition of 
          <me>
          \pd{\eta}{t} + u \pd{\eta}{x} = v, \qquad \text{on $y = \eta(x, t)$},
          </me>
         with  
          <me>
          \pd{\eta}{t} = v, \qquad \text{on $y = 0$},
          </me>
          on the assumption the flow is linearised about <m>\phi = 0</m> and <m>\eta = 0</m>.
        </p>
      </remark>

      <p>
        You will be able to practice this linearisation in the exercises. 
      </p>

      <p>
        The linearisation of Bernoulli's equation in <xref ref="wwfull03"/> is done similarly, and the end result is that the term, 
        <me>
          |\nabla \phi|^2 = \left( \pd{\phi}{x}\right)^2  + \left( \pd{\phi}{y}\right)^2,
        </me>
        is assumed to be small compared to the other terms of the equation. Therefore, Bernoulli's equation is then approximated as 
      <me>
        \pd{\eta}{t} + u \pd{\eta}{x} = v \qquad \text{on $y = \eta$}.
      </me>
      </p>
     

      <theorem xml:id="thm-waterwaves-equations">
        <title>Linear water wave equations</title>
        <statement>
          <p>
           Consider two-dimensional potential flow (inviscid, incompressible, irrotational) of fluid. A model for linear water waves is as follows:
           <mdn>
            <mrow xml:id="ww01"> \nabla^2 \phi = 0 &amp; \qquad \text{$-\infty &lt; y &lt; \eta$}</mrow>
            <mrow xml:id="ww02"> \pd{\phi}{t} + \frac{1}{2} |\nabla \phi|^2 + g\eta = 0 &amp; \qquad \text{on $y = \eta$}</mrow>
            <mrow xml:id="ww03"> \pd{\eta}{t} + u \pd{\eta}{x} = v &amp; \qquad \text{on $y = \eta$}</mrow>
           </mdn> 
           where the free surface is located at <m>y = \eta(x, t)</m>.
          </p>

          <p>
            In water of infinite depth, we require that 
            <men xml:id="ww04-inf">
          \nabla\phi \to (0, 0) \qquad \text{as $y \to -\infty$},
            </men>
            while for the case of finite depth, we have 
            <men>
          \pd{\phi}{y} = 0 \qquad \text{on $y = -h$}.
            </men>
          </p>
        </statement>
      </theorem>
    </subsection>

    <subsection xml:id="subsec-linear-waves-solution">
      <title>Solving for linear waves in infinite depth</title>

      <p>
        We now seek to solve the linear water wave equations in <xref ref="thm-waterwaves-equations"/>.
      </p>

      <p>
        We assume that the wave takes the form of a simple harmonic wave:
        <men xml:id="eqn-linear-wave">
         \eta(x, t) = A\cos(kx - \omega t). 
        </men>
        Examining the free-surface conditions in <xref ref="ww02"/> and <xref ref="ww03"/> suggests that the potential should take the form of a sinusoidal:
        <men xml:id="eqn-linear-wave-phi">
          \phi(x, y, t) = f(y) \sin(kx - \omega t),
        </men>
        which we shall verify is appropriate.
      </p>

      <p>
        Firstly, substitution of <xref ref="eqn-linear-wave-phi"/> into Laplace's equation <xref ref="ww01"/> yields
        <men xml:id="eqn-linear-wave-laplace-01">
        f''(y) - k^2 f(y) = 0.
        </men>
      </p>

      <p>
        Turning now to the two free-surface conditions <xref ref="ww02"/> and <xref ref="ww03"/>, as well as the condition of infinite depth, we have the following necessary constraints: 
        <mdn>
          <mrow>f'(0) \amp= \omega A, </mrow>
          <mrow> \omega f(0) \amp= gA, </mrow>
          <mrow xml:id="ww04-02"> f(-\infty) \amp\to 0. </mrow>
        </mdn>
      </p>

      <p>
        The solution of <xref ref="eqn-linear-wave-laplace-01"/> yields
        <me>
          f(y) = B \e^{ky} + D \e^{-ky},
        </me>
       and so the infinite depth condition <xref ref="ww04-inf"/> yields <m>D \equiv 0</m>. We substitute now <m>f(y) = B \e^{ky}</m> into the two remaining conditions and simplify, yielding the matrix equation: 
       <me>
        \begin{pmatrix}
        \omega \amp -k \\
        g \amp -\omega
        \end{pmatrix}
        \begin{pmatrix}
        A \\ B
        \end{pmatrix}
        = 
        \begin{pmatrix}
        0 \\ 0
        \end{pmatrix}.
       </me>
      </p>

      <p>
        Therefore, in order for there to be nontrivial solutions, the determinant of the matrix must ber zero, and this yields
        <me>
          \omega^2 = gk,
        </me>
        or alternatively if we take the positive root, 
        <men xml:id="eqn-dispersion-deep">
          \omega = \sqrt{gk}.
        </men>
      </p>

      <p>
        The above expression is known as the <em>dispersion relation</em> for water waves in deep water. 
      </p>
    </subsection>


    
  </section>

  <section xml:id="sec-waterwaves-generalisations">
    <title>Generalisations of water waves</title>

    <p>
     During the lectures and exercises, you will cover some of the following variants. 
     <ul>
      <li>
        <p>
          Linear water waves in finite depth: part of <xref ref="ex-waterwaves-finite"/> and done in Problem Class Week 6.
        </p>

        <p>
          In lectures and the exercise, you will confirm that the dispersion relation in finite depth is modified to: 
          <me>
            \omega = \omega_\text{finite} = \sqrt{gk \tanh(kh)}.
          </me>
          In the limit <m>h \to \infty</m>, since <m>\tanh(kh) \to 1</m>, this approaches the deep-water dispersion relation of 
          <me>
            \omega_\text{deep} = \sqrt{gk},
          </me>
          as shown in <xref ref="eqn-dispersion-deep"/>.
        </p>
      </li>
      <li>
        <p>
          Linear water waves in a current: part of <xref ref="ex-waterwaves-current"/> and done in Week 6 Thursday video. 
        </p>

        <p>
          In these problems, you will modify the setup to include a horizontal current at infinity, with <m>\phi \sim Ux</m> as <m>x \to -\infty</m>. The main difference in this case is that there are additional terms to be included in the linear kinematic and dynamic conditions. As shown in the exercise, the dispersion relation is modified to 
          <me>
            \omega = \omega_\text{current} = Uk \mp \sqrt{gk \tanh(kh)}.
          </me> 
        </p>

        <p>
          There are now two distinct wavespeeds. In the version where there is zero current, <m>U = 0</m>, the wavespeeds reduce to a single one (i.e. a single <m>|c|</m>, with both left- and right-travelling waves; remember that we usually drop the <m>\pm</m>). 
        </p>
      </li>
     <li>
        <p>
          Linear water waves in two fluids of different densities: part of <xref ref="ex-waterwaves-density"/> and done in Week 7 Problem Class.
        </p>

        <p>
          The procedure is the same for this version, but the algebra is noticeably more involved. In this case, the dispersion relation is
          <me>
            \omega = \pm \sqrt{\left(\frac{\rho_1 - \rho_2}{\rho_1 + \rho_2}\right) gk}.
          </me>
        </p>
      </li>
     <li>
        <p>
          Linear water waves with surface tension: part of <xref ref="ex-waterwaves-surfacetension"/> and done in Week 7 Problem Class.
        </p>

        <p>
          For the case of deep water waves, this modifies the dispersion relation to 
          <me>
          \omega = \sqrt{gk + \frac{Tk^3}{\rho}}.
          </me>
          
        </p>
      </li>
    </ul>
    </p>
    
  </section>

  <!-- <section xml:id="sec-waterwaves-instability">
    <title>Instability in waves</title>

    <p>
      To be covered Week 6.
    </p>
  </section> -->

  <!-- <section xml:id="sec-waterwaves">
    <title>Group velocity </title>
    
  </section> -->

  <exercises xml:id="exercises-water-waves">
   
    <exercise>
      <title>Derivation of the kinematic condition</title>
      <statement>
        <p>
          In this question, you will derive the kinematic boundary condition on a free surface, which ensures that fluid particles on the free surface must remain on the free surface. Consider a vector that points to a location on a 2D free surface given by 
          <me>
        \br(s, t) = (x, \eta(x, t)).
      </me>
    </p>

    <p>
      Introduce the curve <m>F(x, y, t) = y - \eta(x, t)</m>. For any particle on the surface, it must be the case that <m>F(x, y, t) \equiv 0</m>. By applying the material derivative show that the condition that 
            <me>
              \DD{F}{t} = 0,
            </me>
            for particles on the free surface is equivalent to the kinematic condition 
            <me>
              v = \pd{\eta}{t} + u\pd{\eta}{x} \qquad \text{on $y = \eta(x, t)$}.
            </me>
          </p>
        </statement>

          <solution>
            <p> 
              By the definition of the material derivative, we have that
              <me>
                \DD{(y - \eta)}{t} = \pd{(y - \eta)}{t} + (u, v) \cdot \nabla(y - \eta) = -\pd{\eta}{t} + (u, v) \cdot (-\eta_x, 1).
              </me>
             Equating the above to zero for the case of <m>y = \eta(x, t)</m> yields the desired result.
            </p>
          </solution>
    </exercise>

    <exercise xml:id="ex-waterwaves-finite">
      <title>Stokes waves in finite depth</title>
      <p>
        Consider small 2D water waves on the free surface of a potential (incompressible and irrotational) fluid with velocity potential <m>\phi(x, y,t)</m>, with <m>\phi</m> satisfying <m>\nabla^2 \phi = 0</m>. Let the free surface be at <m>y = \eta(x, t)</m> and assume the water is confined above a flat channel of depth <m>y = -h</m>. Show that on the free surface, <m>y = \eta(x, t)</m>, the kinematic equation is given by 
        <me>
          \pd{\phi}{y}= \pd{\eta}{t} + \pd{\phi}{x}\pd{\eta}{x},
        </me>
        while the dynamic (Bernouilli) equation is
        <me>
        \pd{\phi}{t} + \frac{1}{2}|\nabla \phi|^2 + g\eta = 0.
        </me>
      </p>
     
      <p>
        Show that when the problem is linearised by ignoring quadratic terms, then instead the boundary conditions can be simplified to be 
        <md>
          <mrow>\pd{\phi}{y} \amp= \pd{\eta}{t}, </mrow>
          <mrow>\pd{\phi}{t} + g\eta \amp= 0, </mrow>
        </md>
        and now applied on <m>y = 0</m>.
      </p>

      <p>
        Show that travelling harmonic waves, with <m>\eta = A\cos(kx - \omega t)</m> and <m>\phi = f(y)\sin(kx - \omega t)</m>, are possible and derive the associated dispersion relation, 
        <me>
          \omega^2 = gk \tanh(kh). 
        </me>
      </p>

      <p>
        In deriving the above, it will be convenient for you to use the hyperbolic cosine and sine functions: 
        <me>
          \cosh z = \frac{\e^{z} + \e^{-z}}{2} \quad \text{and} \quad \sinh z = \frac{\e^{z} - \e^{-z}}{2},
        </me>
        and note that the cosh function is even at <m>z = 0</m> (and therefore has a zero derivative). The use of hyperbolic functions is used in the solution of <m>f(y)</m> and is a common trick when solving boundary-value problems with exponentials. 
      </p>
    </exercise>

    <exercise xml:id="ex-waterwaves-current">
      <title>Linear waves in a current</title>

      <introduction>
      <p>
        We now consider linear waves in a channel of depth <m>h</m>, as in the previous question. This time, however, assume that there is a uniform flow of speed <m>U</m> at infinity.</p>



    </introduction>

      <task>
        <statement>
                    <p>
          Begin by writing down the boundary conditions that you expect at <m>y = -h</m> and also far upstream, with <m>x \to -\infty.</m>
        </p>
        
        <p>Therefore, this time, we shall consider the velocity as expressed as 
        <me>
          u = U + \pd{\phi}{x}, \qquad v = \pd{\phi}{y},
        </me>
        and again linearise the necessary equations. 
      </p>
        </statement>

              <solution>
        <p>
          We begin with the governing equations as shown in <xref ref="thm-waterwaves-governing"/>.
        </p>

        <p>
          On the channel bottom, we expect that the vertical velocity is zero, hence 
          <me>
            \pd{\phi}{y} = 0, \qquad y = -h,
          </me>
          while at upstream infinity, we expect the the velocity to be uniform and of speed <m>U</m>. Hence in terms of the potential, 
          <me>
            \phi \sim Ux, \qquad x \to -\infty.
          </me>
        </p>

        <p>
          Indeed, this suggests that we should linearise about the uniform flow, with 
          <me>
            \phi = Ux + \hat{\phi},
          </me>
         where <m>\hat{\phi}</m> is the approximation, which we expect to be small (as is standard in linear problens, we often ignore the hat notation). 
        </p>
        </solution>
      </task>

      <task>
        <statement>
      <p>Linearise the associate free-surface equations, and show that this time, they produce
        <me>
          \pd{\phi}{y} = \pd{\eta}{t} + U \pd{\eta}{x}, \qquad \text{on $y = 0$},
        </me>
        and
        <me>
          \pd{\phi}{t} + U \pd{\phi}{x} + g\eta = 0, \qquad \text{on $y = 0$}.
        </me>
      </p>

      <p>
        When considering the second of the two equations above (Bernoilli's) return to the original Bernoulli equation: 
        <me>
          \pd{\phi}{t} + \frac{1}{2}|\nabla \phi|^2 + \frac{p}{\rho} + gy = F(t),
        </me>
        and choose your constant <m>F</m> more strategically.
      </p>
        </statement>


        <solution>


                <p>
          The linearisation process for the kinematic condition remains largely the same, except we would produce: 
          <me>
            \pd{\eta}{t} + \left[ U + \pd{\hat\phi}{x}\right] \pd{\eta}{x} = \pd{\hat{\phi}}{y}.
          </me>
         Again quadratic terms are ignored, and we see that the requisite condition becomes (dropping the hat):  
          <me>
            \pd{\eta}{t} + U\pd{\eta}{x} = \pd{\phi}{y}, \qquad y = \eta(x, t).
          </me>
        </p>

        <p>
          The linearisation of Bernoulli's equation is done similarly.</p>
        
          <p> When considering the Bernoulli equation, 
          <me>
          \pd{\phi}{t} + \frac{1}{2}|\nabla \phi|^2 + \frac{p}{\rho} + gy = F(t),
        </me>
        it is prudent to take the choice of <m>F(t)</m> so that the inertial term is removed. Specifically, if we take 
        <me>
          F(t) = \frac{U^2}{2} + p_\text{atm}{\rho}, 
        </me>
        this would remove the leading term from inertia.
      </p>
 
         <p> 
          The only difference with the usual linearisation process is the inertial term: 
          <me>
            |\nabla \phi|^2 = \left\lvert \left(U + \pd{\hat{\phi}}{x}\right)^2 + \left(\pd{\hat{\phi}}{y}\right)^2 \right\rvert = 2U \pd{\hat\phi}{x} + \ldots
          </me>
         so now Bernoulli's equation yields (dropping hats):
         <me>
          \pd{\phi}{t} + U \pd{\phi}{x} + g\eta = 0, \qquad y = \eta(x, t). 
         </me>
        </p>
        </solution>
      </task>

      <task>
        <statement>
      <p>
        Show finally that the the dispersion relation predicts possible waves of speeds
        <me>
          c_{\pm} = U \pm \left( \frac{g}{k} \tanh(kh)\right)^{1/2}.
        </me>
      </p>

      <p>
        The regime where the flow speed is less than <m>\sqrt{gh}</m> is known as subcritical. The regime where flow is greater than <m>\sqrt{gh}</m> is supercritical. What can you anticipate about the waves in these two regimes based on the wave speeds above?
      </p>
        </statement>

      <solution>
        <p>
          At this point, the linear solution follows similar steps to the case of finite depth with zero current. We have <m>\eta = A\cos(kx - \omega t)</m> and <m>\phi = f(y) \sin(kx - \omega t)</m>. 
        </p>

        <p>
          Written in terms of <m>f</m>, we must now solve the following system: 
          <md>
            <mrow>f'' + k^2 f = 0, </mrow>
            <mrow>f'(-h) = 0, </mrow>
            <mrow>f'(0) = (\omega - Uk)A, </mrow>
            <mrow>-(\omega - Uk) f(0) + gA = 0, </mrow>
          </md>
        </p>

        <p>
          The first two equations yileld the typical solution for the case of finite depth: 
          <me>
            f(y) = B \cosh[k(y + h)].
          </me>
         The last two conditions yield
         <men>
        \begin{pmatrix}
        \omega - Uk &amp; -k \sinh (kH) \\
        g &amp; -(\omega - Uh)\cosh(kh)
        \end{pmatrix}
        \begin{pmatrix}
        A \\ B
        \end{pmatrix}
        = 0.
         </men> 
        </p>

        <p>
          For there to be non-trivial solutions, we thus need 
          <me>
            (\omega - Uk)^2 = gk \tanh(kh),
          </me>
          and therefore there are two possible wave speeds, namely
          <me>
            c_\pm = U \mp \left(\frac{g}{k}\tanh(kh)\right)^{1/2}.
          </me>
        </p>

        <p>
          In the deep water limit, if <m>U &lt; \sqrt{g/k}</m> this yields subcritical solutions, and it is possible to have a wave pattern that is non-trivial upstream of the flow. 
        </p>
        </solution> 
      </task>



      <!-- </solution> -->
    </exercise>

    <exercise xml:id="ex-waterwaves-density">
      <title>Fluids of different densities</title>
      <p>
        Inviscid incompressible fluid of density <m>\rho_2</m> lies in the region <m>y &gt; 0</m> above a fluid with greater density <m>\rho_1</m> for <m>y &lt; 0</m>. Assume there there is a small-amplitude disturbance the two fluids with the surface given by <m>y = \eta(x, t)</m>. Assuming <m>\eta</m> and the fluid velocities are small, show that the linearised boundary conditions on the approximated boundary at <m>y = 0</m> are given by 
        <md>
          <mrow>\pd{\eta}{t} = \pd{\phi_1}{y} = \pd{\phi_2}{y} \amp \qquad \text{at $y = 0$}, </mrow>
          <mrow>\rho_1\left( \pd{\phi_1}{t}+ g\eta\right) = \rho_2\left(\pd{\phi_2}{t}+ g\eta\right) \amp \qquad \text{at $y = 0$}. </mrow>
        </md>
        (Notice that these are three conditions; two kinematic conditions for the two fluids, and a dynamic (Bernoulli) condition).
      </p>

      <p>
        If <m>\eta(x, t) = A\cos(kx - \omega t)</m> with <m>k > 0</m>, derive the dispersion relation
        <me>
          \omega^2 = \left( \frac{\rho_1 - \rho_2}{\rho_1 + \rho_2}\right) gk.
        </me>
      </p>
    </exercise>

    <exercise xml:id="ex-waterwaves-surfacetension">
      <title>Fluids with surface tension</title>

        <p>
          Suppose now that there is surface tension <m>T</m> between the two fluids of <xref ref="ex-waterwaves-density"/>. In lectures, it was shown that the linear dynamic boundary condition is given by 
          <me>
            \rho_1\left( \pd{\phi_1}{t} + g\eta\right) - \rho_2 \left( \pd{\phi_2}{t} + g\eta\right) = T \pd{^2 \eta}{x^2}, \qquad \text{on $y = 0$}.
          </me>
          consider the specific situation where the top fluid is air, with <m>\rho_2 = 0</m>. Then the dynamic condition is 
          <me>
          \pd{\phi}{t} + g\eta = \frac{T}{\rho} \pd{^2 \eta}{x^2}, \qquad \text{on $y = 0$},
          </me>
         and only need to consider the single potential <m>\phi_1 = \phi</m>.</p>


        <p>The linear kinematic condition should be unchanged from the usual linear kinematic condition, <m>\pd{\eta}{t} = v = \pd{\phi}{y}</m> on <m>y = 0</m>.
        </p>
        
        <p>For the case of deep water waves, show that the frequency <m>\omega</m> is now related to the wavenumber <m>k</m> by the equation 
          <me>
          \omega^2 = gk + \frac{Tk^3}{\rho}.
          </me>
        </p>
    </exercise>

    <exercise>
      <title>The dispersion relation (simple)</title>
      <introduction>
      <p>
        The following is a classic elementary demonstration of dispersive effects when considering the addition of two sinusoidals with two nearly-identical values of the wavenumber. It can be used to motivate the definition of group and phase velocities. 
      </p>

      <p>
        Consider two sinusoidal waves with nearly the same wavenumber and frequency: 
        <me>
          \eta(x, t) = \sin(k_1 x - \omega_1 t) + \sin(k_2 x - \omega_2 t). 
        </me>
      </p>
    </introduction>
        
        <task>
          <statement>
            <p>
            Use the trig angle identity 
            <me>
              \sin A + \sin B = 2\sin\left( \frac{A + B}{2}\right) \cos\left(\frac{A - B}{2}\right),
            </me>
            to put the wave <m>\eta</m> into the form of a product of sinusoidal waves. 
            </p>
          </statement>
        </task>

        <task>
          <statement>
            <p>
            Consider now 
            <me>
              k_{1,2} = k \pm \Delta k \quad \text{and} \quad
              \omega_{1,2} = \omega + \Delta \omega,
            </me>            
            i.e. each wavenumber and frequency are centred about either <m>k</m> or <m>\omega</m>, respectively.
            </p>

            <p>
              In the limit that <m>\Delta k, \Delta \omega \ll 1</m> (are small), argue that the wave consists of a rapidly oscillating waveform within a slowly-varying envelope. 
            </p>
          </statement>
        </task>

        <task>
          <statement>
            <p>
            show that the envelope developed in the last part exhibits maxima as 
            <me>
              x(t) = \frac{\Delta \omega}{\Delta k} t,
            </me>
            and therefore in the limit <m>\Delta k, \Delta \omega \to 0</m>, the velocicty of such maxima (called the group velocity) is given by 
            <me>
              v_g = \dd{\omega}{k}.
            </me>
            </p>
          </statement>
        </task>
    </exercise>
    
  </exercises>

</chapter>