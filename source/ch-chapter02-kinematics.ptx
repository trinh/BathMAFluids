<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter02-kinematics" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Kinematics</title>

  <introduction>

    <p>
     <figure xml:id="fig-euler-vid">
        <image source="01_euler_trim.gif" width="70%"/> 
        <caption>Eulerian description of flow from the <url href="https://techtv.mit.edu/collections/ifluids/videos/32597-eulerian-and-lagrangian-descriptions-in-fluid-mechanics" visual="NCFMF">NCFMF video</url>.</caption>
      </figure>
    </p>

    <p>
      Fluid <em>kinematics</em> refers to the study of fluid motions without considering the associated forces (or energies) that cause such a fluid to move. In a nutshell, it relates to studying e.g. the general velocity and acceleration fields of a fluid, visualising the fluid trajectories, and so forth. 
    </p>

    <p>
      There are some unintuitive challenges when it comes to defining even the most basic quantities
      in fluid dynamics. Consider the following two thought experiments. </p>

    <p> In the first experiment, we consider a tube filled with water, where the bottom is released
      at time <m>t = 0</m>. One can imagine that the entire column of fluid will fall under the
      effect of gravity.</p>

      <figure xml:id="kinematic-tube01">
        <caption>(a) Tube filled with fluid with a plate to be removed; (b) fluid falls under the effect of gravity with uniform acceleration everywhere.</caption>
      <image source="ch-chapter01-kinematics-tube01.png" width="80%"/>
      </figure>

    <p>Each particle within the fluid is accelerated downwards at a constant rate
      (gravity). Therefore the velocity of the fluid is given by <m>\bu = (0, 0, -U(t)).</m>
      In this case, we imagine that acceleration can be defined simply as the partial derivative, in time, of the velocity field, or 
      <me>\ba
      = \pd{\bu}{t} = (0, 0, -\dot{U}(t)) = (0, 0, -g),
    </me>
    where we have used the over-dot notation for a derivative in time. 
  </p>

    <p>
      However, consider now the second thought experiment of fluid being pumped through the vessel
      shown in the figure below. The fluid has reached a steady-state (so the streamlines of the flow, if you can imagine them, are constant and travelling from left-to-right).
    </p>

    <figure xml:id="kinematic-tube02">
      <image source="ch-chapter01-kinematics-tube02.png" width="80%"/>
        <caption>Fluid pumped through a tube with variable cross-sectional area, <m>A_1, A_2</m> and corresponding velocities <m>U_1, U_2</m>.</caption>
    </figure>

    <p> Upstream of the bottleneck, the volume flowrate is equal to the velocity times area, or <me>
      \textrm{Upstream flow rate (area times velocity)} = A_1 U_1.
    </me>
     This is the amount of fluid that is flowing through a cross section of the pipe
      upstream. Similarly, we have 
     <me>
      \textrm{Downstream flow rate (area times velocity)} = A_2 U_2.
    </me></p>
    
    <p>
      However, since
      mass must be conserved, that fact that there is a smaller cross-sectional area downstream must
      mean that the velocity is higher downstream. Therefore, <m>U_2 > U_1</m>, and to achieve this, the fluid must therefore have been accelerated somewhere within the channel.</p>

    <p>
      However, a thought to the situation might convince you that the velocity field in the channel is time-independent: it only changes as a function of its position and is therefore of the form <m>\bu = \bu(\bx)</m>. Indeed, at every fixed point in the channel, the velocity <em>at that point</em> is not changing in time. Therefore, if we use our previous definition that <m>\ba = \dot{\bu}</m> we see that the acceleration would be zero everywhere!
    </p>

    <p>
      The crux of the issue, and the difference between the two thought experiments, is that velocity is both a function of space and time, i.e. <m>\bu = \bu(\bx, t)</m>. The change in velocity (acceleration) can therefore derive from changes in <m>\bu</m> at fixed space and variable time; but also due to changes in <m>\bu</m> at fixed time and variable space. Disentangling this leads us to define the nature of Eulerian and Lagrangian coordinates, presented next.
    </p>
  </introduction>


  <section xml:id="sec-eulerlagrang">
    <title>Eulerian and Lagrangian coordinates</title>

    <introduction>
      <p> There are essentially two natural ways to think of motion in a fluid. We can imagine
        positioning ourselves at a fixed point in space, <m>\bx = (x, y, z)</m>. At this point, we
        then attempt to measure a fluid quantity such as the density, <m>\rho(\bx, t)</m>, or
        temperature, <m>T(\bx, t)</m>. This is essentially the <em>Eulerian frame</em>. One can
        imagine, for example, fixing sensor station into the ocean bottom, and obtaining
        measurements of the water temperature. </p>

        <image source="ch-chapter01-kinematics-euler-vs-lagrange.png">
          <shortdescription>(a) The Eulerian interpretation; (b) the Lagrangian interpretation.</shortdescription>
        </image>

      <p> Alternatively, we can imagine tracking of a single fixed particle (or a fluid element)
        within the flow. The particle begins at some position. Let us define a label to describe the
        particle's initial position. For example, if the particle's position is given by <me>
          (x, y, z) = (x_1(t), y_1(t), z_1(t)),
        </me> we can define the corresponding <em>Lagrangian
        label</em> as <me>
          \bX = (X, Y, Z) = (x_1(0), y_1(0), z_1(0)).
        </me> We then ask for the
        corresponding measurement of the fluid quantity that corresponds to the label <m>\bX</m>.
        For example, this is equivalent to tagging a free-floating buoy in the ocean with the label <m>
        \bX</m>, then measuring the temperature of the water as the buoy drifts in the ocean. This
        Lagrangian temperature could be written <m>\mathcal{T}(\bX, t),</m> where <m>\bX</m> is simply a
        fixed quantity for the particular buoy. </p>

      <p> We are now in a position to define the Eulerian velocity field of a fluid.
        <definition xml:id="def-velocity">
          <statement>
            <p> The Eulerian velocity <m>\bu(\bx,t)</m> is the velocity of the fluid at the
              point with spatial coordinates <m>\bx</m> at time <m>t</m>. Note that, in physical terms
              this velocity is the average velocity at the time <m>t</m> of the fluid particles
              (e.g. molecules, ions) in a small box centred on the point <m>\bx</m>. See also <xref
                ref="rem-continuum"/> for a discussion of the continuum assumption.
            </p>
          </statement>
        </definition>
      </p>
      <p> It will be useful to introduce the concept of steady flow.
        <definition xml:id="def-steady-flow">
          <statement>
            <p> A velocity field <m>\bu</m> is defined as steady if it can be written <m>\bu=\bu(\bx)</m>.
            </p>
          </statement>
        </definition>
        Note that steady flow does not mean that the fluid particles are not moving.
        It simply means that at a fixed point in space, the Eulerian velocity does not change in time.
        The Lagrangian velocity of a fluid particle will generally change in time, even in a steady flow.
      </p>
      <p>
        A simple example of the conversion between the Eulerian and Lagrangian reference frames is in
        <xref ref="ex-eulerian-lagrangian"/>.
      </p>


    </introduction>

    <subsection xml:id="subsec-laglabel">
      <title>The convective derivative</title>

      <p>Let us now be more specific. We wish to consider how different quantities in our flow
        changes with time, but the matter is made complicated by the two above perspectives (fixed
        or following the flow).</p>

      <p> Again, let us consider a scalar property of the fluid (for example, its density,
        temperature, velocity component, pressure, etc.), and let us suppose that this quantity is a
        function of both position, <m>\bx</m>, and time, <m>t</m>, and denote it by <m>f(\bx, t)</m>.
        This is the <em>Eulerian description</em> of the property since it is defined by specifying
        a fixed position in space. Fixing <m>\bx</m> and then measuring <m>f</m> is akin to standing
        in the fluid at a fixed location and measuring the property value in time. </p>

      <p> We can alternatively write the property by its Lagrangian description. That is, given a
        label <m>\bX</m>, we obtain the current position of the particle associated with this label, <m>\bx(\bX,
        t)</m>, then obtain its property value. This we can write as the following: <me>
          F(\bX, t) \equiv f(\bx(\bX, t), t).
        </me> Now, fixing <m>\bX</m> and changing <m>t</m> corresponds
        to tracking the scalar property at a material point in the flow, or, equivalently, how <m>f</m> changes
        as we move with the particle along the deforming fluid. </p>

      <p> There are thus two ways of considering time derivatives. 
        <definition xml:id="def-eulerlag">
          <statement>
            <p> We use the normal partial derivative notation to refer to an <em>Eulerian time
        derivative</em>, considered at a fixed point in space: <me>
                \pd{}{t} \equiv \pd{}{t} \biggr\rvert_{\bx} = \text{rate of change with $\bx$ held
        constant}.
              </me>
            </p>
            <p> On the other hand, the <em>Lagrangian time derivative</em> is defined at a fixed
              material point in the fluid. <me>
                \DD{}{t} \equiv \pd{}{t} \biggr\rvert_{\bX} = \text{rate of change with $\bX$ held
        constant}.
              </me>
        We often refer to the Lagrangian time derivative as the <em>convective derivative</em> or
        the <em>material derivative</em>. </p>
          </statement>
        </definition>
      </p>

      <remark>
        <p>
          The reason why the above derivatives are introduced is because, for the purpose of much of
          fluid dynamics, it is easier to work with Eulerian coordinates and quantities. However,
          for the purpose of deriving many governing equations, it turns out to be much easier to
          work with Lagrangian variables. This is because physical forces act on physical particles, or
          material elements, of the fluid.
        </p>
      </remark>

      <p> The natural question is how the two derivatives relate to one another. This is given by
        the following theorem. <theorem xml:id="thm-DDt">
          <title>The material/convective derivative</title>
          <statement>
            <p> The <em>material or convective derivative</em> can be defined in terms of Eulerian derivative in the
        following way: <men xml:id="eqn-DDt">
                \DD{}{t} = \pd{}{t} + (\bu \cdot \nabla).
              </men>
            </p>
            <proof>
              <p> This is a result of the chain rule. For a scalar function <m>f = f(\bx, t)</m>, we
        have the fact that <md>
                  <mrow>\DD{f}{t} \amp= \DD{t}{t} \pd{f}{t} + \DD{x}{t}\cdot \nabla f </mrow>
                  <mrow>\amp= \pd{f}{t} + \bu \cdot \nabla f. </mrow>
                </md>
              </p>
            </proof>
          </statement>
        </theorem>
      </p>

      <p>
        <note>
          <p>You are asked to work out the above proof more carefully using individual coordinates
            (instead of vector notation) in the problem set.</p>
        </note>
      </p>

      <p> We can now apply the above result to the question of how to calculate the acceleration
        within the fluid (more specifically, we are enquiring about the acceleration of a volume or
        particle within the fluid). The acceleration is given by the convective or material
        derivative of the velocity: <men xml:id="eqn-accel">
          \ba \equiv \DD{\bu}{t} = \pd{\bu}{t} + (\bu \cdot \nabla) \bu.
        </men>
      You will practice using this formula in <xref ref="ex-eulerian-lagrangian2"/> of the problem set.
      </p>
    </subsection>
  </section>

  <section xml:id="sec-flowexamples">
    <title>Examples and flow visualisation</title>

    <p>There are different ways to visualise the dynamics of a fluid. Given the velocity, <m>\bu(\bx,
      t)</m>, we can plot a vector field at each point in space, and at a fixed moment in time.
      Little arrows are used to indicate the direction and the length of the arrow can be chosen to
      represent the magnitude. Joining these up at a fixed moment in time into smooth curves gives the
      <em>streamlines</em> of the flow. This is often the easiest type of visualisation to perform
      mathematically, but the hardest experimentally.</p>

    <p>Another representation of the flow is using <em>particle paths</em> or <em>pathlines</em>.
      Given a point and time, the particle path is the trajectory that would result if a particle
      were dropped into the flow at that chosen point and time. It is thus found by solving an
      equation where at every point on the trajectory, the particle's velocity is the specified
      velocity of the fluid.</p>

    <p>A third representation is a <em>streakline</em>. If dye were continuously released into a
      fluid from a fixed chosen point, the streakline at a given time is the line that would be
      made by the dye. It is thus found by finding the current position of those particles whose
      pathline has visited the chosen point at any past time. This is often the easiest type
      of visualisation to perform experimentally, but the hardest to perform
      mathematically.</p>

      <p>Note that in a steady flow, the streamlines, pathlines and streaklines all coincide. However,
        in an unsteady flow, they are all different. Although the video is dated and the sound and
        picture quality are not up to modern standards, the clearest introduction to
        these concepts is given in the first fourteen minutes of the 1963 production titled
        ``Flow visualization'' available at
        <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>.
        </p>

    <p>
      In the definition below, we define these concepts more concretely.
    </p>

    <p>
      <definition xml:id="def-streamline">
        <title>Particle streamlines</title>
        <statement>
          
          <p>Consider a fixed time, <m>t = t_1</m>.</p>

          <p>Select an initial point, <m>\bx_1</m> at this time.</p>

          <p>The <em>streamline</em>, <m>\bx = \bx(s)</m> through the above point is given by solving the parametric equation <me>
              \dd{\bx}{s} = \bu(\bx(s), t_1), \quad \text{with $\bx(s = 0) = \bx_1$,}
            </me> 
            where <m>s</m> is a parameter along the streamline. Choosing a variety of different initial points, <m>\bx_1</m>, and solving
            the above equation gives a family of streamlines at time <m>t_1</m>.
          </p>
        </statement>
        </definition>
      </p>

      <p>Basically, given a velocity field, we freeze time.
        The streamlines are those curves that are traced out by the velocity field in the "snapshot".</p>

      <p>
          <definition xml:id="def-particle-path">
        <title>Pathline or particle path</title>
        <statement>
          <p>Consider now a particle that begins at the location <m>\bx_2</m> at time <m>t = 0</m>.</p>

          <p>We consider the <em>partial path</em> or <em>pathline</em> of the particle, given by the curve <m>\bx = \bx(t)</m> and found by solving the equation
            <me>
            \dd{\bx}{t} = \bu(\bx(t), t), \quad \text{with $\bx(0) = \bx_2$.}
            </me>
            Choosing a variety of initial points, <m>\bx_2</m>, yields a family of pathlines.</p>
        </statement>
      </definition>
    </p>

    <p>The pathline or particle path from an initial point is what we would physically expect if we were to dye the point with a colour and follow the dye colour as time increases.</p>

      <p>
          <definition xml:id="def-streakline">
        <title>Streakline</title>
        <statement>
          <p>Consider now fixing a location <m>\bx_3</m>.</p>
            <p>The <em>streakline</em> for a point <m>\bx_3</m> is given by solving the equation <me>
              \dd{\bx}{t} = \bu(\bx(t), t), \qquad \textrm{with $\bx(t_3) = \bx_3$},
            </me>
            for a variety of values of <m>t_3</m>. This gives the current position of all particles
            that have passed through the point <m>\bx_3</m> at any time <m>t_3</m> in the past. </p>

        </statement>
      </definition>
    </p>
          
    <p> If it is the case that the velocity is time independent, i.e. <m>\bu = \bu(\bx)</m>,
            then the three above definitions coincide. </p>

    <!-- <p>
      <remark>
        <p> Above, we have been somewhat diligent not to abuse notation and distinguish between
          independent and dependent variables. For example, <m>x</m> is the independent variable
          that corresponds to an arbitrary spatial location. Therefore, when referring to a
          particular particle trajectory, we would introduce a new dependent variable, <m>x_1</m>,
          which depends on time, with <me>
            x = x_1(t),
          </me> being the horizontal position of the particle. </p>
        <p> In many usages, this rigorous distinguishing of dependent and independent variables is
          commonly abused (because the notation becomes too burdensome). Therefore, we will commonly
          write e.g. that <me>
            x = x(t),
          </me> is the position of the particle. The above abuse of
          notation uses both <m>x</m> as independent variable (left) and dependent variable (right). </p>
      </remark>
    </p> -->

        <p>You will practice the theory of these concepts in <xref ref="ex-particle-paths-streamlines"/>
          and do a worked example in <xref ref="ex-streamlines-pathlines-streaklines"/> of the problem set.
        </p>

    <subsection>
      <title>Examples of streamlines, pathlines, and streaklines</title>
    <p>
      Let us practice these concepts.
    </p>
      
      

    <p>
    <example>
      <p> Consider a fluid described by the two-dimensional velocity field 
        <me>
          \bu(\bx, t) = (x, -y, 0).
        </me>
        Derive and plot the streamlines of the flow. Discuss what occurs with particle paths and streaklines.</p>

    <answer>
      <p> There are many online applications, such as <url
          href="https://www.desmos.com/calculator/yhubcn7dij"
          visual="https://www.desmos.com/calculator/yhubcn7dij">this one</url> that will allow you
        plot a two-dimensional direction field. It is also good to do it yourself by hand. <image
          source="directionfieldexample.png">
          <shortdescription>(for accessibility)</shortdescription>
        </image>
      </p>

      <p>The streamlines follow from <xref ref="def-streamline"/>. We seek to solve the equations
        <md>
          <mrow>\dd{x}{s} \amp= x, </mrow>
          <mrow>\dd{y}{s} \amp= -y, </mrow>
          <mrow>\dd{z}{s} \amp= 0. </mrow>
        </md> 
      Solving thus gives <m>x = A \e^s, y = B\e^{-s}, z = C,</m> for constants <m>A, B, C</m>. </p>

      <p> You can put initial conditions to determine the constant and plot the trajectories for different values of <m>s</m>.</p>
      
      <p>However, in this case, it is easier to remove the time-like variable, <m>s</m>, entirely. Notice that 
        <me>
        xy = AB = \textrm{constant}.
        </me> 
      Therefore, the trajectories lie along hyperbolae. </p>

      <p> Notice that in this case, the velocity field is time-independent, and therefore the
        particle paths coincide with the streamlines and streaklines. </p>


    <p>
      For instance, the particle path through a particle at <m>\bx_2 = (1, 1, 0)</m> is given by (replacing <m>s</m> with <m>t</m>):
      <me>
        \bx(t) = (\e^t, \, \e^{-t}, \, 0).
      </me>
     Similarly, the <em>streakline</em> through the point <m>(1, 1, 0)</m> is precisely the set of points above.
    </p>
    </answer>
    </example>
  </p>

    <example>
        <p> Consider the unsteady flow given by <me>\bu(\bx, t) = (\cos t, \sin t, 0)</me>. Plot the
          streamlines of the flow on the plane <m>z = 0</m>, and also the particle trajectories. What occurs with the streaklines?</p>

  
   <answer>
    <p>
      In this case, the velocity field is changing in time. Consider firstly the concept of the streamline in <xref ref="def-streamline"/>.
    </p>

    <p>
      We solve the governing equations for the streamlines <m>\bx = \bx(s)</m>, 
      <me>
        \dd{x}{s} = \cos t, \quad \dd{y}{s} = \sin t, \quad \dd{z}{s} = 0,
      </me>
      for fixed <m>t</m>. 
    </p>

    <p>
      This gives 
      <me>
        x(s) = A + s \cos t, \quad y(s) = B + \sin t, \quad z(s) = C,
      </me>
    for constants <m>A, B, C</m>. Therefore the streamline are given by straight in the <m>(x, y)</m> plane, if <m>z = C</m> is fixed.
    </p>

    <p>
      Consider instead the definition of particle paths via <xref ref="def-particle-path"/>. We seek to solve
      <me>
        \dd{x}{t} = \cos t, \quad \dd{y}{t} = \sin t, \quad \dd{z}{t} = 0,
      </me>
      yielding 
      <me>
       x(t) = A + \sin t, \quad y(t) = B - \cos t, \quad z(t) = C, 
      </me>
      for constants <m>A, B, C</m>. Therefore, we see that the particle paths are closed circles (in the <m>xy</m>-plane) of unit radius encircling the point <m>(A, B, 0)</m>.
    </p>

    <p>
      In this case, considering the streakline via <xref ref="def-streakline"/>, we conclude that the streakline coincides with the particle path. Can you reason why this must be the case in this situation? What is necessary in order for this not to be true? 
    </p>
   </answer>
    </example>
  </subsection>
  </section>


  <!-- ============================================================
       WORKSHEET 
    ============================================================ -->

<worksheet xml:id="ws-kinematics">
<exercisegroup xml:id="kinematics-exercises">
<title>Kinematics</title>
<introduction>
  <p>The kinematics chapter covered the basic essentials about the measurement
    and computation of fluid velocities and acceleration.
    We examined the difference between Eulerian and Lagrangian coordinates and derivatives.
    Examples of streamlines and velocity fields were examined.</p>
<p>
  <warning>
  <p>We look to complete worksheets in the week prior to the content being delivered.
    Once this is done, this disclaimer message will be removed.</p>
</warning>
</p>
</introduction>

<exercise xml:id="ex-eulerian-lagrangian">
<title>Eulerian and Lagrangian descriptions</title>
<statement>
      <p>
        A velocity field is described in Eulerian terms in Cartesian coordinates by <m>\mathbf{u}=(-y,x)</m>.
        What is the Lagrangian position of the particle that starts at the point <m>(x_0,y_0)</m>?
        Describe its path.
        What is its velocity?
        Express the position and velocity in polar coordinates. What do you notice?
      </p>
      <answer>
        <p>
          A particle moves with the velocity of the fluid, so we have
          <me>
            \dd{x}{t} = -y(t),\quad \dd{y}{t} = x(t)
            \quad\Rightarrow\quad
            \dd{^2x}{t^2} = -\dd{y}{t} = -x(t).
          </me>
          Trying solutions of the form <m>x(t)=\e^{\lambda t}</m> gives <m>\lambda=\pm i</m>,
          so the general solution is
          <me>
            x(t) = Ae^{it}+Be^{-it},
          </me>
          or, equivalently,
          <me>
            x(t) = C\cos t + D\sin t,
          </me>
          where <m>C</m> and <m>D</m> are constants, and
          <me>
            y(t) =-\dd{x}{t}= C\sin t - D\cos t.
          </me>
          Setting <m>x(0)=x_0</m> and <m>y(0)=y_0</m> gives <m>C=x_0</m> and <m>D=-y_0</m>, so
          <me>
            \bx(t) = (x_0\cos t - y_0\sin t, x_0\sin t + y_0\cos t).
          </me>
          This is a circular path of radius <m>\sqrt{x_0^2+y_0^2}</m> going anticlockwise around the origin.
          The velocity is
          <me>
            (x,y)(t) = (-x_0\sin t - y_0\cos t, x_0\cos t - y_0\sin t).
          </me>
          The calculation works out more simply in polar coordinates; the velocity field is
          <me>
            \bu = r\be_\theta,
          </me>
          meaning the equation for particle paths is
          <me>
            \dd{r}{t} = 0,\quad\dd{r\theta}{t}= r\quad\Rightarrow\quad \dd{\theta}{t}=1.
          </me>
          Thus <m>r(t)=r_0=\sqrt{x_0^2+y_0^2}</m> and <m>\theta(t)=\theta_0+t</m>,
          where <m>\theta_0=\tan^{-1}(y_0/x_0)</m>. The velocity is <m>\bu(t)=r_0\be_{\theta}(t)</m>.
        </p>
      </answer>
</statement>
</exercise>

<exercise xml:id="ex-eulerian-lagrangian2">
<title>Eulerian and Lagrangian descriptions</title>
<statement>
      <p>
      <figure xml:id="fig-nozzle">
        <caption>Sketch of nozzle.</caption>
        <image source="ch-chapter02-nozzle.png" width="60%">
        </image>
      </figure>
        A fluid flows through the nozzle shown from <m>x=0</m> to <m>x=L</m> with one-dimensional velocity
        <me>
          u=U\left(1+\frac{x}{L}\right)
        </me>
        in the <m>x</m>-direction, where <m>U</m> and <m>L</m> are constants.
        Note that, in reality the flow would be two- or three-dimensional,
        but we ignore this here for simplicity.
      </p>
      <p>
        <ol>
          <li>
            <p>
              What is the particle acceleration?
            </p>
            <answer>
              <p>
                <md>
                  <mrow> \ba=\amp\DD{\bu}{t} </mrow>
                  <mrow> =\amp \pd{\bu}{t} + (\bu \cdot \nabla) \bu</mrow>
                  <mrow> =\amp0+\left(u\pd{u}{x}+v\pd{u}{y}+w\pd{u}{z}\right)\be_x
                +\left(u\pd{v}{x}+v\pd{v}{y}+w\pd{v}{z}\right)\be_y
                +\left(u\pd{w}{x}+v\pd{w}{y}+w\pd{w}{z}\right)\be_z</mrow>
                  <mrow> =\amp u\pd{u}{x}\be_x</mrow>
                  <mrow> = \amp U\left(1+\frac{x}{L}\right)\frac{U}{L}\be_x</mrow>
                  <mrow> = \amp \frac{U^2}{L}\left(1+\frac{x}{L}\right)\be_x</mrow>
                </md>
              </p>
            </answer>
          </li>
          <li>
            <p>
              If a particle starts at <m>x=0</m> at time <m>t=0</m>, what is its position at time <m>t</m>?
            </p>
            <answer>
              <p>
                We have
                <me>
                  \dd{x}{t}=u(x)=U\left(1+\frac{x}{L}\right).
                </me>
                Solving by separation of variables gives,
                <md>
                  <mrow>\amp\int_0^x\frac{dx}{1+x/L}=\int_0^t U\,dt</mrow>
                  <mrow>\Rightarrow\quad\amp L\ln\left(1+\frac{x}{L}\right)=Ut</mrow>
                  <mrow>\Rightarrow\quad\amp x(t)=L\left(\e^{Ut/L}-1\right).</mrow>
                </md>
              </p>
            </answer>
          </li>
          <li>
            <p>
              What is its Lagrangian velocity as a function of time?
            </p>
            <answer>
              <p>
                The velocity is
                <md>
                  <mrow>\dd{x}{t}=\amp\dd{}{t}\left(L\left(\e^{Ut/L}-1\right)\right)</mrow>
                  <mrow>=\amp L\frac{U}{L}\e^{Ut/L}</mrow>
                  <mrow>=\amp U\e^{Ut/L}.</mrow>
                </md>
              </p>
            </answer>
          </li>
          <li>
            <p>
              What is its Lagrangian acceleration as a function of time?
            </p>
            <answer>
              <p>
                The acceleration is
                <md>
                  <mrow>\dd{^2x}{t^2}=\amp\dd{}{t}\left(U\e^{Ut/L}\right)</mrow>
                  <mrow>=\amp \frac{U^2}{L}\e^{Ut/L}.</mrow>
                </md>
              </p>
            </answer>
          </li>
          <li>
            <p>
              Write the Lagrangian velocity and acceleration as a function of <m>x</m>.
              Compare with the corresponding Eulerian velocity and particle acceleration.
              What do you notice?
            </p>
            <answer>
              <p>
                The velocity is
                <me>
                  U\e^{Ut/L}=U\left(1+\frac{x}{L}\right),
                </me>
                as expected. This is the same as the Eulerian velocity at the particle position.
                The acceleration is
                <md>
                  <mrow>\frac{U^2}{L}\e^{Ut/L}=\amp\frac{U^2}{L}\left(1+\frac{x}{L}\right),</mrow>
                </md>
                which is the same as the particle acceleration, as expected from the defintion.
              </p>
            </answer>
          </li>
          <li>
            <p>
              How long does it take for a particle to travel from <m>x=0</m> to <m>x=L</m>?
            </p>
            <answer>
              <p>
                The particle reaches <m>x=L</m> when
                <md>
                  <mrow>\amp L\left(\e^{Ut/L}-1\right)=L</mrow>
                  <mrow>\Rightarrow\quad\amp \e^{Ut/L}=2</mrow>
                  <mrow>\Rightarrow\quad\amp t=\frac{L}{U}\ln(2).</mrow>
                </md>
              </p>
            </answer>
          </li>
        </ol>
      </p>
</statement>
</exercise>

<exercise xml:id="ex-particle-paths-streamlines">
<title>Particle paths and streamlines</title>
<statement>
  <ol>
    <li>
      <p>
        Define the particle paths and streamlines for a velocity field
    <m>\bu(\bx,t)</m>. When do these coincide?
      </p>
      <answer>
        <p>
          Particle paths are the trajectories of individual fluid particles, which are found by solving the ODE
          <me>
            \dd{\bx}{t} = \bu(\bx,t).
          </me>
          Streamlines are curves that are instantaneously tangent to the velocity field, and therefore satisfy
          <me>
            \dd{\bx}{s} = \bu(\bx,t),
          </me>
          where <m>s</m> is a parameter along the streamline. The two coincide if the flow is steady, i.e. <m>\bu(\bx,t)=\bu(\bx)</m>.
        </p>
      </answer>
    </li>
  <li>
  <p>
    Show that a quantity <m>f(\bx,t)</m> is preserved following the flow if
  <me>
    \DD{f}{t}=\pd{f}{t}+\bu\cdot\bnabla f=0.
  </me>
</p>
<answer>
  <p>
    <figure xml:id="lagrange-problem">
      <image source="ch-chapter02-lagrange-problem2.jpg" width="80%"/>
        <caption>Pathline, showing the particle positions at times <m>t</m> and <m>t+\de t</m>.</caption>
    </figure>
    
    <xref ref="lagrange-problem"/> shows the points <m>\bx(t)</m> and
          <m>\bx(t+dt)=\bx(t)+\de\bx</m>, and the equation for pathlines gives
          <m>\de\bx=\bu(\bx,t)\de t</m>.
    We follow the value of <m>f</m> following a particle:
    <md>
      <mrow> \dd{f}{t}\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(f(\bx+\de\bx,t+\de t)-f(\bx,t)\right)</mrow>
      <mrow>\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(f(\bx,t)+\de\bx\cdot\bnabla f(\bx,t)+\de t\pd{f}{t}(\bx,t)+\dots-f(\bx,t)\right)</mrow>
    <mrow>\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(\bu(\bx,t)\de t\cdot\bnabla f(\bx,t)+\de t\pd{f}{t}(\bx,t)+\dots\right)</mrow>
    <mrow>\amp=\pd{f}{t}+\bu\cdot\bnabla f=\DD{f}{t},</mrow>
    </md>
    (''<m>\dots</m>'' denotes higher order terms). Thus the value is preserved if <m>\DD{f}{t}=0</m>.
  </p>
  </answer>
</li>
<li>
  <p>
    Show also that <m>f</m> is constant along streamlines if
  <me>
    \bu\cdot\bnabla f=0.
  </me>
   </p>
   <answer>
  <p>
    Now suppose that in <xref ref="lagrange-problem"/>, we have shown instead the situation of a streamline.</p>
    
    <p>In this case,
    the points <m>\bx(s)</m> and <m>\bx(s+ds)=\bx(s)+\de\bx</m> are shown, and the equation for streamlines gives
          <m>\de\bx=\bu(\bx,t)\de s</m>.
    We follow the value of <m>f</m> along the streamline:
    <md>
      <mrow>\dd{f}{s}\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(f(\bx+\de\bx,t)-f(\bx,t)\right)</mrow>
      <mrow>\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(f(\bx,t)+\de\bx\cdot\bnabla f(\bx,t)-f(\bx,t)\right)</mrow>
    <mrow>\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(\bu(\bx,t)\de s\cdot\bnabla f(\bx,t)\right)</mrow>
    <mrow>\amp=\bu\cdot\bnabla f.</mrow>
    </md></p>
   
   <p> Thus the value of <m>f</m> is preserved if <m>\bu\cdot\bnabla f=0</m>.
  </p>
  </answer>
  </li>
  </ol>
</statement>
</exercise>

<exercise xml:id="ex-streamlines-pathlines-streaklines">
<title>Streamlines, pathlines and streaklines</title>
  <statement>
    <p>
      The velocity of a two-dimensional fluid flow in Cartesian coordinates is
     <m>u = 1</m>, <m>v = t e^{-4x}</m>. Calculate and sketch the following:
    <ol>
      <li>the streamlines at a fixed time <m>t &gt; 0</m>,
        <answer>
          <figure xml:id="flowvisualisationproblem">
      <image source="ch-chapter02-flowvisualisationproblem.png" width="100%"/>
        <caption>Sketch of streamlines, pathline and streaklines.</caption>
    </figure>
          <p>
            The streamlines are given by
           <me>
              \pd{y}{x}=te^{-4x}\quad\Rightarrow\quad
              y=y_0-\frac{t}{4} e^{-4x},
            </me>
            for any constant <m>y_0</m>. Different values of <m>y_0</m> give different streamlines.
            See <xref ref="flowvisualisationproblem"/> for a sketch.
          </p>
        </answer>
      </li>
      <li>the pathline of the particle starting from <m>(0,0)</m>,
      <answer>
        <p>
          The pathlines for a particle starting from <m>(x_0,y_0)</m> are given by
          <md xml:id="eqn-pathline">
            <mrow>\amp\dd{x}{t}=1,\quad
            \dd{y}{t}=te^{-4x}</mrow>
            <mrow>\Rightarrow\quad\amp
            x = x_0 + t,\quad
            y = y_0 + \frac{1}{16} e^{-4x_0} - \frac{1+4t}{16} e^{-4(x_0+t)}.</mrow>
          </md>
          Eliminating <m>t</m>:
          <me>
            y = y_0 + \frac{1}{16} e^{-4x_0}
            - \frac{1+4x-4x_0}{16} e^{-4x}.
          </me>
          This is a general pathline. For the particular particle that starts from <m>(0,0)</m>:
          <me>
            y = \tfrac{1}{16}\left(1 - (1+4x)e^{-4x}\right).
          </me>
          See <xref ref="flowvisualisationproblem"/> for a sketch. 
        </p>
      </answer>
      </li>
      <li>and the streaklines passing through <m>(0,0)</m>.
      <answer>
        <p>
          Suppose the particle that started at <m>(x_0,y_0)</m> hits the special point
          <m>(0,0)</m> at time <m>t_1</m>. From the pathline equation:
          <me>
            0 = x_0 + t_1, \quad
            0 = y_0 + \tfrac{1}{16} e^{-4x_0}
              - \tfrac{1+4t_1}{16} e^{-4(x_0+t_1)}.
          </me>
          Solving for <m>x_0</m> and <m>y_0</m>:
          <me>
            x_0 = -t_1,\quad
            y_0 = -\tfrac{1}{16}\left(e^{4t_1} - 1 - 4t_1\right).
          </me>
          At time <m>t</m> the particle is at:
          <me>
            x = t - t_1,\quad
            y = \tfrac{1}{16}\left((1+4t_1) - (1+4t)e^{-4(t-t_1)}\right).
          </me>
          Eliminating <m>t_1</m> gives the streakline at time <m>t</m>:
          <me>
            y = \tfrac{1}{16}\left((1+4t)(1-e^{-4x}) - 4x\right).
          </me>
          See <xref ref="flowvisualisationproblem"/> for a sketch.
          Note that the streamlines, pathlines and streaklines are all very different.
        </p>
      </answer>
      </li>
      <li>
        <p>For a line/curve in the <m>(x,y)</m>, its timeline at time <m>t</m> is the
        locus of the material elements at time <m>t</m> that started on the line/curve
        at <m>t=0</m>. In experiments this can be visualised using a streak of dye
        placed initally along the line/curve. Tracking this over time gives the timelines.</p>

        <p>Calculate and sketch the timelines of the line (i) <m>y=0</m>, (ii) <m>x=0</m>.</p>
      <answer>
        <p>
          From the pathline equation, a particle starting from
          <m>(x_0,0)</m> reaches
        <me>
          x = x_0 + t,\quad
          y = \tfrac{1}{16} e^{-4x_0}
              - \tfrac{1+4t}{16} e^{-4(x_0+t)}
        </me>
          at time <m>t</m>. Eliminating <m>x_0</m> gives the timeline:
        <me>
          y = \tfrac{1}{16}\left(e^{4t} - 1 - 4t\right)e^{-4x}.
        </me>
        See <xref ref="flowvisualisationproblem"/> for a sketch. 
      </p>
        <p>
          From the pathline equation, a particle starting from
          <m>(0,y_0)</m> reaches
        <me>
          x = t,\quad
          y = y_0 + \tfrac{1}{16}
              - \tfrac{1+4t}{16} e^{-4t}
        </me>
          at time <m>t</m>. Since <m>y_0</m> can take any value, the timeline is just the line
          <m>x = t</m>.
        See <xref ref="flowvisualisationproblem"/> for a sketch. 
        </p>
      </answer>
      </li>
    </ol>
  </p>
  </statement>

</exercise>
</exercisegroup>
</worksheet>

</chapter>