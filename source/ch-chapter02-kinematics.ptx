<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter02-kinematics" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Kinematics</title>

  <introduction>

    <p>
      There are some unintuitive challenges when it comes to defining even the most basic quantities
      in fluid dynamics. Consider the following two thought experiments. </p>

    <p> In the first experiment, we consider a tube filled with water, where the bottom is released
      at time <m>t = 0</m>. One can imagine that the entire column of fluid will fall under the
      effect of gravity.</p>

      <figure xml:id="kinematic-tube01">
        <caption>(a) Tube filled with fluid with a plate to be removed; (b) fluid falls under the effect of gravity with uniform acceleration everywhere.</caption>
      <image source="ch-chapter01-kinematics-tube01.png" width="80%"/>
      </figure>

    <p>Each particle within the fluid is accelerated downwards at a constant rate
      (gravity). Therefore the velocity of the fluid is given by <m>\bu = (0, 0, -U(t)).</m>
      In this case, we imagine that acceleration can be defined simply as the partial derivative, in time, of the velocity field, or 
      <me>\ba
      = \pd{\bu}{t} = (0, 0, -\dot{U}(t)) = (0, 0, -g),
    </me>
    where we have used the over-dot notation for a derivative in time. 
  </p>

    <p>
      However, consider now the second thought experiment of fluid being pumped through the vessel
      shown in the figure below. The fluid has reached a steady-state (so the streamlines of the flow, if you can imagine them, are constant and travelling from left-to-right).
    </p>

    <figure xml:id="kinematic-tube02">
      <image source="ch-chapter01-kinematics-tube02.png" width="80%"/>
        <caption>Fluid pumped through a tube with variable cross-sectional area, <m>A_1, A_2</m> and corresponding velocities <m>U_1, U_2</m>.</caption>
    </figure>

    <p> Upstream of the bottleneck, the volume flowrate is equal to the velocity times area, or <me>
      \textrm{Upstream flow rate (area times velocity)} = A_1 U_1.
    </me>
     This is the amount of fluid that is flowing through a cross section of the pipe
      upstream. Similarly, we have 
     <me>
      \textrm{Downstream flow rate (area times velocity)} = A_2 U_2.
    </me></p>
    
    <p>
      However, since
      mass must be conserved, that fact that there is a smaller cross-sectional area downstream must
      mean that the velocity is higher downstream. Therefore, <m>U_2 > U_1</m>, and to achieve this, the fluid must therefore have been accelerated somewhere within the channel.</p>

    <p>
      However, a thought to the situation might convince you that the velocity field in the channel is time-independent: it only changes as a function of its position and is therefore of the form <m>\bu = \bu(\bx)</m>. Indeed, at every fixed point in the channel, the velocity <em>at that point</em> is not changing in time. Therefore, if we use our previous definition that <m>\ba = \dot{\bu}</m> we see that the acceleration would be zero everywhere!
    </p>

    <p>
      The crux of the issue, and the difference between the two thought experiments, is that velocity is both a function of space and time, i.e. <m>\bu = \bu(\bx, t)</m>. The change in velocity (acceleration) can therefore derive from changes in <m>\bu</m> at fixed space and variable time; but also due to changes in <m>\bu</m> at fixed time and variable space. Disentangling this leads us to define the nature of Eulerian and Lagrangian coordinates, presented next.
    </p>
  </introduction>


  <section xml:id="sec-eulerlagrang">
    <title>Eulerian and Lagrangian coordinates</title>

    <introduction>
      <p> There are essentially two natural ways to think of motion in a fluid. We can imagine
        positioning ourselves at a fixed point in space, <m>\bx = (x, y, z)</m>. At this point, we
        then attempt to measure a fluid quantity such as the density, <m>\rho(\bx, t)</m>, or
        temperature, <m>T(\bx, t)</m>. This is essentially the <em>Eulerian frame</em>. One can
        imagine, for example, fixing sensor station into the ocean bottom, and obtaining
        measurements of the water temperature. </p>

        <image source="ch-chapter01-kinematics-euler-vs-lagrange.png">
          <shortdescription>(a) The Eulerian interpretation; (b) the Lagrangian interpretation.</shortdescription>
        </image>

      <p> Alternatively, we can imagine tracking of a single fixed particle (or a fluid element)
        within the flow. The particle begins at some position. Let us define a label to describe the
        particle's initial position. For example, if the particle's position is given by <me>
          (x, y, z) = (x_1(t), y_1(t), z_1(t)),
        </me> we can define the corresponding <em>Lagrangian
        label</em> as <me>
          \bX = (X, Y, Z) = (x_1(0), y_1(0), z_1(0)).
        </me> We then ask for the
        corresponding measurement of the fluid quantity that corresponds to the label <m>\bX</m>.
        For example, this is equivalent to tagging a free-floating buoy in the ocean with the label <m>
        \bX</m>, then measuring the temperature of the water as the buoy drifts in the ocean. This
        Lagrangian temperature could be written <m>\mathcal{T}(\bX, t),</m> where <m>\bX</m> is simply a
        fixed quantity for the particular buoy. </p>


    </introduction>

    <subsection xml:id="subsec-laglabel">
      <title>The convective derivative</title>

      <p>Let us now be more specific. We wish to consider how different quantities in our flow
        changes with time, but the matter is made complicated by the two above perspectives (fixed
        or following the flow).</p>

      <p> Again, let us consider a scalar property of the fluid (for example, its density,
        temperature, velocity component, pressure, etc.), and let us suppose that this quantity is a
        function of both position, <m>\bx</m>, and time, <m>t</m>, and denote it by <m>f(\bx, t)</m>.
        This is the <em>Eulerian description</em> of the property since it is defined by specifying
        a fixed position in space. Fixing <m>\bx</m> and then measuring <m>f</m> is akin to standing
        in the fluid at a fixed location and measuring the property value in time. </p>

      <p> We can alternatively write the property by its Lagrangian description. That is, given a
        label <m>\bX</m>, we obtain the current position of the particle associated with this label, <m>\bx(\bX,
        t)</m>, then obtain its property value. This we can write as the following: <me>
          F(\bX, t) \equiv f(\bx(\bX, t), t).
        </me> Now, fixing <m>\bX</m> and changing <m>t</m> corresponds
        to tracking the scalar property at a material point in the flow, or, equivalently, how <m>f</m> changes
        as we move with the particle along the deforming fluid. </p>

      <p> There are thus two ways of considering time derivatives. 
        <definition xml:id="def-eulerlag">
          <statement>
            <p> We use the normal partial derivative notation to refer to an <em>Eulerian time
        derivative</em>, considered at a fixed point in space: <me>
                \pd{}{t} \equiv \pd{}{t} \biggr\rvert_{\bx} = \text{rate of change with $\bx$ held
        constant}.
              </me>
            </p>
            <p> On the other hand, the <em>Lagrangian time derivative</em> is defined at a fixed
              material point in the fluid. <me>
                \DD{}{t} \equiv \pd{}{t} \biggr\rvert_{\bX} = \text{rate of change with $\bX$ held
        constant}.
              </me>
        We often refer to the Lagrangian time derivative as the <em>convective derivative</em> or
        the <em>material derivative</em>. </p>
          </statement>
        </definition>
      </p>

      <remark>
        <p>
          The reason why the above derivatives are introduced is because, for the purpose of much of
          fluid dynamics, it is easier to work with Eulerian coordinates and quantities. However,
          for the purpose of deriving many governing equations, it turns out to be much easier to
          work with Lagrangian variables. This is because physical forces act on physical particles, or
          material elements, of the fluid.
        </p>
      </remark>

      <p> The natural question is how the two derivatives relate to one another. This is given by
        the following theorem. <theorem xml:id="thm-DDt">
          <title>The material/convective derivative</title>
          <statement>
            <p> The <em>material or convective derivative</em> can be defined in terms of Eulerian derivative in the
        following way: <men xml:id="eqn-DDt">
                \DD{}{t} = \pd{}{t} + (\bu \cdot \nabla).
              </men>
            </p>
            <proof>
              <p> This is a result of the chain rule. For a scalar function <m>f = f(\bx, t)</m>, we
        have the fact that <md>
                  <mrow>\DD{f}{t} \amp= \DD{t}{t} \pd{f}{t} + \DD{x}{t}\cdot \nabla f </mrow>
                  <mrow>\amp= \pd{f}{t} + \bu \cdot \nabla f. </mrow>
                </md>
              </p>
            </proof>
          </statement>
        </theorem>
      </p>

      <p>
        <note>
          <p>You are asked to work out the above proof more carefully using individual coordinates
            (instead of vector notation) in the problem set.</p>
        </note>
      </p>

      <p> We can now apply the above result to the question of how to calculate the acceleration
        within the fluid (more specifically, we are enquiring about the acceleration of a volume or
        particle within the fluid). The acceleration is given by the convective or material
        derivative of the velocity: <men xml:id="eqn-accel">
          \ba \equiv \DD{\bu}{t} = \pd{\bu}{t} + (\bu \cdot \nabla) \bu.
        </men>
      </p>
    </subsection>
  </section>

  <section xml:id="sec-flowexamples">
    <title>Examples and flow visualisation</title>

    <p>There are different ways to visualise the dynamics of a fluid. Given the velocity, <m>\bu(\bx,
      t)</m>, we can plot a vector field at each point in space, and at a fixed moment in time.
      Little arrows are used to indicate the direction and the length of the arrow can be chosen to
      represent the magnitude. Joining these up at a fixed moment in time into smooth curves gives the
      <em>streamlines</em> of the flow. This is often the easiest type of visualisation to perform
      mathematically, but the hardest experimentally.</p>

    <p>Another representation of the flow is using <em>particle paths</em> or <em>pathlines</em>.
      Given a point and time, the particle path is the trajectory that would result if a particle
      were dropped into the flow at that chosen point and time. It is thus found by solving an
      equation where at every point on the trajectory, the particle's velocity is the specified
      velocity of the fluid.</p>

    <p>A third representation is a <em>streakline</em>. If dye were continuously released into a
      fluid from a fixed chosen point, the streakline at a given time is the line that would be
      made by the dye. It is thus found by finding the current position of those particles whose
      pathline has visited the chosen point at any past time. This is often the easiest type
      of visualisation to perform experimentally, but the hardest to perform
      mathematically.</p>

      <p>Note that in a steady flow, the streamlines, pathlines and streaklines all coincide. However,
        in an unsteady flow, they are all different. Although the video is dated and the sound and
        picture quality are not up to modern standards, the clearest introduction to
        these concepts is given in the first fourteen minutes of the 1963 production titled
        ``Flow visualization'' available at
        <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>.
        </p>

    <p>
      In the definition below, we define these concepts more concretely.
    </p>

    <p>
      <definition xml:id="def-streamline">
        <title>Particle streamlines, pathlines and streaklines</title>
        <statement>
          
          <p>The <em>streamline</em> is given by solving the parametric equation <me>
              \dd{\bx_1}{s} = \bu(\bx_1, t_0),
            </me> where <m>s</m> is a parameter along the streamline, and <m>t_0</m> is the chosen
            time. Choosing a variety of different initial points, <m>\bx_1(0)</m>, and solving
            the above equation gives a family of streamlines at time <m>t_0</m>.
          </p>

          <p> The <em>particle path</em> or <em>pathline</em> for a particle <m>\bx(t)</m> is given by
            solving the equation <me>
            \dd{\bx}{t} = \bu(\bx(t), t), \qquad \textrm{with $\bx(0) = \bx_2$},
            </me>
            for a chosen initial value of <m>\bx_2</m>. Choosing a variety of points <m>\bx_2</m> yields
            a family of pathlines.</p>

            <p>The <em>streakline</em> for a point <m>\bx_3</m> is given by solving the equation <me>
              \dd{\bx}{t} = \bu(\bx(t), t), \qquad \textrm{with $\bx(t_3) = \bx_3$},
            </me>
            for a variety of values of <m>t_3</m>. This gives the current position of all particles
            that have passed through the point <m>\bx_3</m> at any time <m>t_3</m> in the past. </p>

          <p> If it is the case that the velocity is time independent, i.e. <m>\bu = \bu(\bx)</m>,
            then these three definitions coincide. </p>
        </statement>
      </definition>
    </p>

    <p>
      <remark>
        <p> Above, we have been somewhat diligent not to abuse notation and distinguish between
          independent and dependent variables. For example, <m>x</m> is the independent variable
          that corresponds to an arbitrary spatial location. Therefore, when referring to a
          particular particle trajectory, we would introduce a new dependent variable, <m>x_1</m>,
          which depends on time, with <me>
            x = x_1(t),
          </me> being the horizontal position of the particle. </p>
        <p> In many usages, this rigorous distinguishing of dependent and independent variables is
          commonly abused (because the notation becomes too burdensome). Therefore, we will commonly
          write e.g. that <me>
            x = x(t),
          </me> is the position of the particle. The above abuse of
          notation uses both <m>x</m> as independent variable (left) and dependent variable (right). </p>
      </remark>
    </p>

    <p>
      Let us practice these concepts.
    </p>
    <example>
      <p> Consider a fluid described by the two-dimensional velocity field <m>\bu = (x, -y, 0)</m>.
        Derive and plot the streamlines of the flow.</p>
    <answer>
      <p> There are many online applications, such as <url
          href="https://www.desmos.com/calculator/yhubcn7dij"
          visual="https://www.desmos.com/calculator/yhubcn7dij">this one</url> that will allow you
        plot a two-dimensional direction field. It is also good to do it yourself by hand. <image
          source="directionfieldexample.png">
          <shortdescription>(for accessibility)</shortdescription>
        </image>
      </p>

      <p> The particle paths or streamlines of the flow are found by solving the equations: <md>
          <mrow>\dd{x}{t} \amp= x, </mrow>
          <mrow>\dd{y}{t} \amp= -y, </mrow>
          <mrow>\dd{z}{t} \amp= 0. </mrow>
        </md> Solving thus gives <m>x = A \e^t, y =
        B\e^{-t}, z = C,</m> for constants <m>A, B, C</m>. </p>
      <p> You can put initial conditions to determine the constant and plot the trajectories in
        time. However, in this case, it is easier to remove the time variable entirely. Notice that <me>
        xy = AB = \textrm{constant}
        </me> Therefore, the trajectories lie along the
        above hyperbolae. </p>

      <p> Notice that in this case, the velocity field is time-independent, and therefore the
        particle paths coincide with the streamlines. </p>
    </answer>
    </example>

    <example>
      <statement>
        <p> Consider the unsteady flow given by <me>\bu = (\cos t, \sin t, 0)</me>. Plot the
          streamlines of the flow on the plane <m>z = 0</m>, and also the particle trajectories. </p>
        <!-- <answer>
          <p>
            I think the pathlines and streaklines coincide in this case, but not the streamlines.
          </p>
        </answer> -->
      </statement>
    </example>
  </section>


<worksheet xml:id="ws-kinematics">
<exercisegroup xml:id="kinematics-questions">
<title>Kinematics</title>
<introduction>
<p>
Intro.
</p>
</introduction>
<exercise xml:id="particle-paths-streamlines">
<title>Particle paths and streamlines</title>
<statement>
  <ol>
    <li>
      <p>
        Define the particle paths and streamlines for a velocity field
    <m>\bu(\bx,t)</m>. When do these coincide?
      </p>
      <answer>
        <p>
          Particle paths are the trajectories of individual fluid particles, which are found by solving the ODE
          <me>
            \dd{\bx}{t} = \bu(\bx,t).
          </me>
          Streamlines are curves that are instantaneously tangent to the velocity field, and therefore satisfy
          <me>
            \dd{\bx}{s} = \bu(\bx,t),
          </me>
          where <m>s</m> is a parameter along the streamline. The two coincide if the flow is steady, i.e. <m>\bu(\bx,t)=\bu(\bx)</m>.
        </p>
      </answer>
    </li>
  <li>
  <p>
    Show that a quantity <m>f(\bx,t)</m> is preserved following the flow if
  <me>
    \DD{f}{t}=\pd{f}{t}+\bu\cdot\bnabla f=0.
  </me>
</p>
<answer>
  <p>
    <figure xml:id="lagrange-problem">
      <image source="ch-chapter02-lagrange-problem2.jpg" width="80%"/>
        <caption>Pathline, showing the particle positions at times <m>t</m> and <m>t+\de t</m>.</caption>
    </figure>
    Figure <xref ref="lagrange-problem"/> shows the points <m>\bx(t)</m> and
          <m>\bx(t+dt)=\bx(t)+\de\bx</m>, and the equation for pathlines gives
          <m>\de\bx=\bu(\bx,t)\de t</m>.
    We follow the value of <m>f</m> following a particle:
    <md>
      <mrow> \dd{f}{t}\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(f(\bx+\de\bx,t+\de t)-f(\bx,t)\right)</mrow>
      <mrow>\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(f(\bx,t)+\de\bx\cdot\bnabla f(\bx,t)+\de t\pd{f}{t}(\bx,t)-f(\bx,t)\right)</mrow>
    <mrow>\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\left(\bu(\bx,t)\de t\cdot\bnabla f(\bx,t)+\de t\pd{f}{t}(\bx,t)\right)</mrow>
    <mrow>\amp=\pd{f}{t}+\bu\cdot\bnabla f=\DD{f}{t}.</mrow>
    </md>
    Thus the value is preserved if <m>\DD{f}{t}=0</m>.
  </p>
  </answer>
</li>
<li>
  <p>
    Show also that <m>f</m> is constant along streamlines if
  <me>
    \bu\cdot\bnabla f=0.
  </me>
   </p>
   <answer>
  <p>
    Now suppose figure <xref ref="lagrange-problem"/> shows a streamline. In this case,
    the points <m>\bx(s)</m> and <m>\bx(s+ds)=\bx(s)+\de\bx</m> are shown, and the equation for streamlines gives
          <m>\de\bx=\bu(\bx,t)\de s</m>.
    We follow the value of <m>f</m> along the streamline:
    <md>
      <mrow>\dd{f}{s}\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(f(\bx+\de\bx,t)-f(\bx,t)\right)</mrow>
      <mrow>\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(f(\bx,t)+\de\bx\cdot\bnabla f(\bx,t)-f(\bx,t)\right)</mrow>
    <mrow>\amp=\lim_{\de s\rightarrow0}\frac1{\de s}\left(\bu(\bx,t)\de s\cdot\bnabla f(\bx,t)\right)</mrow>
    <mrow>\amp=\bu\cdot\bnabla f.</mrow>
    </md>
    Thus the value of <m>f</m> is preserved if <m>\bu\cdot\bnabla f=0</m>.
  </p>
  </answer>
  </li>
  </ol>
</statement>
</exercise>
</exercisegroup>
</worksheet>

</chapter>