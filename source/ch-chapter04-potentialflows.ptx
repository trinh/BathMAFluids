<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter04-potentialflows" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Potential flows</title>

  <introduction>
    <p>Typically, the most basic introduction on fluid dynamics usually involves the study of two-dimensional incompressible and irrotational flows, otherwise known as <em>potential flows</em>. There is a good reason for this: the theory is elegant, visualisable, and uses to its benefit the enormous power of complex-variable theory. </p>

    <p>
      Previously, we defined the concept of vorticity via <m>\omega = \nabla \times \bu</m>, which serves as a measure of the local angular velocity of the flow. It turns out that in 2D, irrotational flows, with <m>\omega = 0</m>, provide a powerful restricton to the complexity of flows, allowing the development of the above <em>potential flow theory.</em>. 
    </p>

    <figure>
      <caption>From "Fundamental Principles of Flows" and "Characteristics of the Laminar and Turbulent Flows" by Hunter Rouse. Courtesy of IIHR, University of Iowa. </caption> 
      <video youtube="glfm3NMMxh0"></video>
    </figure>

  </introduction>

<section xml:id="sec-Potential-and-streamfunction">
  <title>The velocity potential</title>

<introduction>
  <p>
    In this chapter, we focus on 2D flows where the velocity vector is given by 
    <me>
      \bu(x, y, t) = u(x, y, t)\bi + v(x, y, z)\bj = [u, v].
    </me>
    With the velocity given as above, the vorticity is then 
    <men xml:id="eqn-2d-vorticity">
      \bomega = \nabla \times \bu = \left(\pd{v}{x} - \pd{u}{y}\right)\bk.
    </men>
    If we assume that the flow is irrotational according to <xref ref="def-irrotational"/>, then <m>\nabla \times \bu = 0</m> and 
    <men xml:id="eqn-2d-irrotational">
      \pd{v}{x} - \pd{u}{y} = 0.
    </men>
  </p>

  <p>
    Further, we know that if the flow is irrotational, then there exists a <em>velocity potential</em>, <m>\phi</m>, such that <m>\bu = \nabla \phi</m>. Thus the velocities are expressed as 
    <men xml:id="eqn-vel-potential">
      u = \pd{\phi}{x} \quad \textrm{and} \quad v = \pd{\phi}{y}.
    </men>
  </p>

  <p>
    The above result about irrotational flows is a standard result in Vector Calculus, but we will re-state the result here for reference, and provide a review of its proof. 
  </p>

    <theorem xml:id="thm-exist-potential">
      <title>Existence of a potential</title>
      <statement>
        <p>
          Consider a three-dimensional time-dependent velocity field, <m>\bu = \bu(\bx, t)</m> defined on a simply connected domain <m>\bx\in D \subset \mathbb{R}^3 \times \mathbb{R}^+.</m>
        </p>
          
          <p>Then <m>\bu</m> is irrotational, i.e. <m>\nabla \times \bu = 0</m> if and only if there exists a scalar potential, defined on <m>D \times \mathbb{R}^+</m>, such that <m>\bu = \nabla \phi</m>.
        </p>
      </statement>

      <proof>
        <p>
          Define 
          <me>
            \phi(\bx, t) \equiv \phi_0(t) + \int_C \bu \cdot \de{x},
          </me>
          where <m>C</m> is any contour connecting an arbitrary origin point to the point <m>\bx</m> (changing the origin point will change the "constant" of integration <m>\phi_0(t)</m>).
        </p>

        <p>
          We can verify, using the definition of differentiation, and the fundamental theorme of calculus, applied along each of the three coordinate directions, that <m>\nabla \phi = \bu</m> as desired. 
        </p>

        <p>
          The key is to prove that the above definition is unique, regardless of the choice of contour <m>C</m>. To this end, consider two contours, <m>C_1</m> and <m>C_2</m>, both with the same origin point, <m>O</m>, and end point <m>P</m>. Then the contour <m>C_1 - C_2</m> is a close contour beginning and ending at <m>O</m>. 
        </p>

        <figure xml:id="fig-potential-proof">
          <caption>Proof of the uniqueness of the potential</caption>
          <image source="potentialproof.jpg" width="80%"/>
        </figure>

        <p>
          By Stokes' theorem, 
          <me>
            \int_{C_1 - C_2} \bu \cdot \de{x} = \iint_S (\nabla \times \bu) \, \bn \, \de{S}, 
          </me>
          where <m>S</m> is any surface with bounding curve <m>C_1 - C_2</m>, and with unit normal <m>\bn</m> positively oriented with the bounding curve. However, the right hand-side is zero by irrotationality, and therefore 
          <me>
            \int_{C_1} \bu \cdot \de{x} = \int_{C_2} \bu \cdot \de{x},
          </me>
          and our choice of curve in the definition of the potential is irrelevant. 
        </p>

        <p>
          The converse direction of the theorem follows directly from the fact that "curl grad equals zero", i.e. <m>\nabla \times \nabla \phi = 0</m>.
        </p>
      </proof>
    </theorem>

  <p>
    Let us return to discussing the setting of potential flow.
  </p>

  <p>
    In addition to being irrotational, we furthermore have assumed that the flow is incompressible. Therefore from <xref ref="def-incompressible"/>,
    <men xml:id="eqn-2d-divu">
      \nabla \cdot \bu = \pd{u}{x} + \pd{v}{y} = \pd{^2\phi}{x^2} + \pd{^2\phi}{y^2} = 0.
    </men>
    This is the crucial result, which is that in potential flows, we need only solve the Laplace equation: 
    <men xml:id="eqn-2d-laplace">
      \nabla^2 \phi = 0,
    </men>
    within the flow region. This is effectively a single linear equation for the single unknown <m>\phi</m>. However, for different problems, the boundary conditions can render even this "simple" problem difficult. 
  </p>

  <p>
  Once the velocity potential <m>\phi</m> has been solved, the velocities in the flow can be recovered from the relationship <xref ref="eqn-vel-potential"/>. The pressure in the flow also follows from Bernoulli's equation. For the situation of a steady potential flow, following <xref ref="thm-bernoulli-potential"/>, it is 
  <men xml:id="eqn-2d-bernoulli">
    \frac{p}{\rho} + \frac{1}{2} |\nabla \phi|^2 + \chi = \textrm{constant}.
  </men>
  </p>
</introduction>

  <subsection>
    <title>Elementary flows</title>

    <p>The next three examples will introduce you to the elementary flows consisting of uniform flow, stagnation point flow, and line source/sink flows. You will also investigate the notion of a source "strength".</p>
    
    <example xml:id="example-potential-uniform">
      <title>Uniform flow</title>
      <idx><h>uniform flow</h></idx>
     <p>
      Consider the potential given by the linear function 
      <me>
        \phi(x, y) = Ux \cos\alpha + Uy \sin\alpha,
      </me>
      with constants <m>U</m> and <m>\alpha</m>. Then by differentiation we have that the velicity is 
      <me>
        \bu = U[\cos\alpha, \sin\alpha].
      </me>
     </p> 

     <p>
      The image shown below shows the streamlines of the flow.
     </p>

      <figure xml:id="fig-potential-uniform">
          <caption>Streamlines (or velocity field) of uniform flow with <m>U = 1</m> and <m>\alpha = \pi/4</m>.</caption>
        <image source="uniformflow" width="90%"/> 
        </figure>
    </example>
  
    <example xml:id="example-potential-stagnation">
      <title>Stagnation point flow</title><idx><h>stagnation point flow</h></idx>
      <p>
        We can verify that the velocity potential 
        <me>
          \phi = \frac{1}{2} (x^2 - y^2),
        </me>
        satisfies Laplace's equation. The corresponding velocity field is given by 
        <me>
          [u, v] = [x, -y]. 
        </me>
       and corresponds to <em>stagnation point flow</em>.
      </p>

      <p> The streamlines (or velocity field) is shown below.
      </p>
      <figure xml:id="fig-potential-stagnation">
          <caption>Streamlines (or velocity field) of stagnation point flow.</caption>
        <image source="stagnationflow" width="90%"/> 
        </figure>
    </example>
  
  <example xml:id="example-potential-linesource">
    <title>Line source</title>
   <idx><h>line source</h></idx> 

   <p>
   We aim to derive the potential and velocity for a <em>line source</em>, imagined as the flow consisting of a point source or point sink that ejects/drains fluid from a point in space. Since it would be expected for the potential to be axisymmetric, we attempt to solve <m>\nabla^2 \phi = 0</m> in plane polar coordinates. This is given by
   <me>
    \nabla^2 \phi = \frac{1}{r} \pd{}{r}\left(r \pd{\phi}{r}\right) + \frac{1}{r^2} \pd{^2 \phi}{\theta^2} = 0.
   </me>
   We assume that the potential takes the form <m>\phi = \phi(r)</m>. Then direct integration gives
   <me>
    \phi = \frac{Q}{2\pi} \log r, 
   </me>
   where we have set an additional constant of integration to zero without loss of generality. The leading constant has been set to <m>Q/(2\pi)</m> so that <m>Q</m> can be later identified with a physical quantity. 
  </p> 

  <p>
    The velocity then follows from consideration of the gradient in polar form, 
    <me>
      \bu = \nabla \phi = \pd{\phi}{r} \be_r + \frac{1}{r}\pd{\phi}{\theta} \be_{\theta} = \frac{Q}{2\pi r} \be_r,
    </me>
    where the unit vectors written in the Cartesian basis are <m>\be_r = [\cos\theta, \sin\theta]</m> and <m>\be_{\theta} = [-\sin\theta, \cos\theta]</m>. Thus we can write the velocity as 
    <me>
      \bu = \frac{Q}{2\pi r^2} r[\cos\theta, \sin\theta] = \frac{Q}{2\pi r^2} [x, y].
    </me>
   The above corresponds to a velocity field directed radially outwards from the origin. The flow is a called a <em>line source</em> because fluid is ejected from the origin (a source). It refers to a "line" because in <m>(x, y, z)</m>, the source runs parallel to the <m>z</m>-axis.  
  </p>


      <p> The streamlines (or velocity field) are shown below.
      </p>
      <figure xml:id="fig-potential-linesource">
          <caption>Streamlines (or velocity field) of line source flow.</caption>
        <image source="linesource" width="90%"/> 
        </figure>

  <p>
    Let us also identify the <em>strength</em> of this line source. Consider a closed contour <m>C</m> around the origin. Then the quantity 
    <me>
      \int_C \bu \cdot \bn \, \de{s},
    </me>
    is the flux (the flow per unit time) of fluid crossing the contour, with <m>\bn</m> denoting the unit normal along <m>C</m>.
  </p>

  <p>
    For simplicity, let us take the contour <m>C</m> to be a circle of constant radius <m>r = a</m>. Then since the unit normal is precisely <m>\be_r</m>, we have that 
    <me>
      \int_C \bu \cdot \bn \, \de{s} = \int_0^{2\pi} \frac{Q}{2\pi a} \be_r \cdot \be_r \, (a \, \de\theta) = Q. 
    </me>
   In computing the above integral, remember that the conversion following the polar Jacobian is <m>\de{s} = r \de{\theta}</m> where <m>r = a</m>.
  </p>

  <p>
    Therefore, <m>Q</m> is the rate at which fluid is produced from the line source. If <m>Q \lt 0</m>, we refer to the flow as a <em>line sink</em>.
    <idx><h>line sink</h></idx>
  </p>
    
  </example>

<p>
  Crucially, because the governing fluid mechanical equation is only Laplace's equation: this is a linear partial differential equation, and therefore the summation of elementary flows also produces an admissible flow. 
</p>

  <example xml:id="example-potential-movingsource">
    <title>Line source in a uniform flow</title>
   <p> 
   For instance, we may combine a uniform flow in the <m>x</m>-direction with a line source:
  <me>
    \phi = Ux + \frac{Q}{2\pi} \log r = Ux + \frac{Q}{2\pi} \log \sqrt{x^2 + y^2}.
  </me>
  We can then obtain the velocity field as 
  <me>
    \bu = [U, 0] + \frac{Q}{2\pi(x^2 + y^2)} [x, y].
  </me>
</p> 

<p> The streamlines (or velocity field) is shown below.
      </p>
      <figure xml:id="fig-potential-movinglinesource">
          <caption>Streamlines (or velocity field) of a line source in a uniform flow with <m>U = 1</m> and <m>Q = 1</m>.</caption>
        <image source="movinglinesource" width="90%"/> 
        </figure>

<p>
  Where do you think the stagnation point lies in this flow? 
</p>
  </example>

  </subsection>
</section>

  <section>
   <title>The streamfunction</title>
<introduction>
   <p>
    Our next task is to introduce the concept of the <em>streamfunction</em>. Remember that in 2D, the irrotational flow led to the equation <xref ref="eqn-2d-irrotational"/> and this led to the existence of the potential function. If we begin with incompressibility, however, we have <xref ref="eqn-2d-divu"/>, which can be written as 
    <men xml:id="eqn-1d-divu-cross">
      \nabla \times [-v, u] = 0.
    </men>
    And we can deduce the existence of an analogous function, the <em>streamfunction</em>, <m>\psi(x, y, t)</m> satisfying, 
    <men xml:id="eqn-2d-uv-streamfunction">
      u = \pd{\psi}{y} \quad \textrm{and} \quad v = -\pd{\psi}{x}.
    </men>
  Alternatively and more conveniently, we can write 
    <men xml:id="eqn-2d-streamfunction">
      \bu = \nabla \times (\psi \bk).
    </men>
    To establish the existence of the streamfunction, we follow a similar proof as in <xref ref="thm-exist-potential"/> but now with the definition that 
   <men xml:id="eqn-streamfunction-def-psi">
    \psi(x, y, t) = \psi_0(t) + \int_0^{\bx} (u \de{y} - v \de{x}),
   </men>
   where again <m>\psi_0(t)</m> is an arbitrary function of <m>t</m>. The proof is otherwise identical, relying on establishing the independence of path of the integral using Stokes' theorem.  
   </p>

   <p>
    Why all this work? The streamfunction has an intuitive intepretation via the following result. </p>

    <theorem xml:id="thm-streamfunction">
      <title>The streamfunction is constant along streamlines</title>
      <statement>
        <p>
          The streamfunction, <m>\psi(x, y, t)</m>, is constant along streamlines of the flow (i.e. the trajectory formed by a particle in the flow).
        </p>
      </statement>

      <proof>
        <p>
          The proof follows simply by the fact that
          <me>
            \bu \cdot \nabla \psi = \left(\pd{\psi}{y}, -\pd{\psi}{x}\right) \cdot \left(\pd{\psi}{x}, \pd{\psi}{y}\right) = 0,
          </me>
          and for which the substitution in the first equality follows from <xref ref="eqn-2d-uv-streamfunction"/>. 
        </p>

        <p>
          The above equality indicates that the velocity vector, <m>\bu</m>, is orthogonal to the vector pointing along <m>\nabla \psi</m>. However, it is known from Vector Calculus that <m>\nabla \psi</m> runs along curves of steepest descent/ascent of <m>\psi</m>---these must hence be orthogonal to the level sets of <m>\psi</m>. Therefore, the level sets of <m>\psi</m> are tangential to <m>\bu</m> (the definition of a streamline).
        </p>
      </proof>
    </theorem>


   <p>
    A graphical depiction of the property in <xref ref="thm-streamfunction"/> is shown below.</p>

    <figure xml:id="fig-streamfunction">
      <caption>Flow between two streamlines, where the streamlines <m>\psi_1</m> and <m>\psi_2</m> are constant. Later, we will consider the flux through the contour <m>C</m> illustrated in the figure along with its unit normal <m>\bn</m>.</caption>
      <image source="streamfunction.jpg" width="70%"/>
    </figure>


      <!-- <figure>
        <image source="uniformflow" width="90%"/> 
          <caption>Streamlines (or velocity field) of uniform flow with <m>U = 1</m> and <m>\alpha = \pi/4</m>.</caption>
        </figure> -->

   

   <p>
    The streamfunction is thus constant on streamlines. Consider two streamlines. The following theorem relates the flux between the streamlines to the streamline values. 
   </p>
    <theorem xml:id="thm-flux-streamlines">
      <title>Flux between streamlines</title>
      <statement>
        <p>
        Consider two streamlines <m>\psi = \psi_1</m> and <m>\psi = \psi_2</m>. We assume that the streamlines pass through the points A and B respectively. Consider a contour <m>C</m> connecting A and B. The <em>flux</em> (net flow of fluid) through <m>C</m> and hence between the streamlines is
        <me>
          |\textrm{flux}| = |\psi_2 - \psi_1|
        </me>
        We have not specified the sign of the flux as it is subject to the considered direction through <m>C</m>.
        </p>
      </statement>

        <proof>
          <p>
            By definition, the flux is given by the integral 
            <me>
              \int_C \bu \cdot \bn \, \de{s},
            </me>
            where <m>C</m> is any smooth path joining the two streamlines with unit normal <m>\bn</m>, as shown in <xref ref="fig-streamfunction"/>.
          </p>

          <p>
            Note that given the curve, and in consideration of a small arclength element <m>\de{s}</m>, the tangent and normal are given by 
            <me>
              \bt = \frac{[\de{x}, \de{y}]}{\sqrt{\de{x}^2 + \de{y}^2}} = \frac{[\de{x}, \de{y}]}{\de{s}}, \qquad 
              \bn = \frac{[-\de{y}, \de{x}]}{\de{s}}.
            </me>
            Therefore we can write <m>\bn \de{s} = [\de{y}, -\de{x}]</m>. Then the flux is re-written as the following: 
            <md>
              <mrow>\textrm{flux} \amp= \int_C \left[\pd{\psi}{y}, -\pd{\psi}{x}\right] \cdot [\de{y}, \de{x}], </mrow>
              <mrow>\amp= \int_C \left(\pd{\psi}{x} \, \de{x} + \pd{\psi}{y} \right), </mrow>
              <mrow>\amp= \bigl[ \psi \bigr]_C, </mrow>
              <mrow>\amp= \psi(B) - \psi(A), </mrow>
              <mrow>\amp= \psi_2 - \psi_1, </mrow>
            </md>
          In the third line above, <m>[\psi]_C</m> is the change of <m>\psi</m> across the contour.  
          Note that there is somewhat an arbitrary choice of direction for the contour <m>C</m>, as related to the selection of the normal direction <m>\bn</m>, and the positivity or negativity of the flux. To be safe, we have taken the absolute value in the problem.
        </p>
        </proof>

    </theorem>

    <p>
      An example of the use of the above theorem is given in <xref ref="ps-potential-fluxcalc"/>. 
    </p>

    <example>
      <statement>
        <p>
          Let the velocity of a two-dimensional flow be given by the formula
          <me>
            \bu = [3ax^2 - 3ay^2, \, -6axy]
          </me>
          where <m>a</m> is a positive constant. By finding the streamfunction, <m>\psi</m>, calculate the volume flux across a curve connecting points <m>A = (0, 0)</m> and <m>B = (1, 1)</m> using <xref ref="thm-flux-streamlines"/>.
        </p>
      </statement>

      <solution>
        <p>
          (Done in problem class)

          We can check, using the integration of velocity components that 
          <me>
            \psi = 3ax^2 y - a y^3 + C.
          </me>
          Hence the flux is
          <me>
            Q = \psi(B) - \psi(A) = 2a.
          </me>
          We can verify this flux should be positive if the normal is oriented to the right of the curve from A to B. 
        </p>
      </solution>
    </example>
      
    
    <p>
        Finally, note that the velocity potential was governed by Laplace's equation, <m>\nabla^2 \phi = 0</m>. The streamfunction is also governed by the same Laplace's equation. 
    </p>
       
   <theorem xml:id="thm-streamfunction-laplace">
          <title>Streamfunction satisfies Laplace's equation</title>
          <statement>
            <p>
              Like the velocity potential, the streamfunction satisfies Laplace's equation: 
              <men xml:id="eqn-2d-streamfunction-laplace">
                \pd{^2 \psi}{x^2} + \pd{^2 \psi}{y^2} = \nabla^2 \psi = 0.
              </men>
            </p>
          </statement>

            <proof>
              <p>
                Substitute the relationship <xref ref="eqn-2d-uv-streamfunction"/> into <xref ref="eqn-2d-irrotational"/>.
              </p>
            </proof>
        </theorem>
   
   <p>
    Like in the situation of certain flows, e.g. the line source in <xref ref="example-potential-linesource"/>, it is easier to work in alternative coordinate systems to study the streamfunction. Since we know that <m>\bu = \nabla \times (\psi \bk)</m> by <xref ref="eqn-2d-streamfunction"/>, we can use the conversion of the curl to polar coordinates in <xref ref="eqn-identity-curlpolar"/> to give 
    <men xml:id="eqn-streamfunction-polar">
      u_r = \frac{1}{r} \pd{\psi}{\theta} \quad \textrm{and} \quad u_{\theta} = -\pd{\psi}{r}\,
    </men>
   which allows us to relate the radial and angular velocities to the streamfunction. 
   </p>
</introduction>

   <subsection>
    <title>Elementary flows</title>

   <p>
    Let us return to each of the examples in <xref ref="sec-Potential-and-streamfunction"/> and reconsider their corresponding streamfunctions. 
   </p>


    <example>
      <title>Uniform flow</title>
      <idx><h>uniform flow, streamfunction</h></idx>

      <p>
        From <xref ref="example-potential-uniform"/>, we can directly integrate <m>u = \psi_y</m> and <m>v = -\psi_x</m> to get 
        <me>
          \psi = Uy\cos\alpha - Ux\sin\alpha, 
        </me>
       up to an arbitrary constant. Therefore, lines of constant <m>\psi</m> correspond to 
       <me>
        y = x\tan\alpha + \textrm{constant},
       </me>
      which indeed yields the image seen in <xref ref="fig-potential-uniform"/>.
      </p>
    </example>

    <example>
      <title>Stagnation point flow</title><idx><h>stagnation point flow, streamfunction</h></idx>

      <p>
        Now turning to <xref ref="example-potential-stagnation"/>, we integrate <m>u = y = \psi_x</m> and <m>v = x = \psi_y</m>. This gives
        <me>
          \psi = xy, 
        </me>
        up to an arbitrary constant. Indeed curves of constant <m>\psi</m> match the hyperbole shown in <xref ref="fig-potential-stagnation"/>.
        
      </p>
    </example>

  <example xml:id="example-streamfunction-linesource">
    <title>Line source</title>
   <idx><h>line source, streamfunction</h></idx> 

   <p>
    For the situation of the line source in <xref ref="example-potential-linesource"/>, we want to work with polar coordinates. From the previous work, we have for this situation the potential <m>\phi = Q/(2\pi log r</m>. It then follows from the polar version of the gradient in <xref ref="eqn-identity-grad-polar"/>, that the velocity is entirely radial and 
    <men xml:id="eqn-streamfunction-u-linesource">
     \bu = \pd{\phi}{r}\be_r + 0 = \frac{Q}{2\pi r} \be_r.
    </men>
    We use the formulae in <xref ref="eqn-streamfunction-polar"/> and integrate <m>\frac{1}{r} \pd{\psi}{\theta} = \frac{Q}{2\pi r}</m> yielding
    <me>
      \psi = \frac{Q}{2\pi} \theta.
    </me>
    Then indeed note that the lines of constant <m>\psi</m> are given by the radial lines of constant <m>\theta</m>, matching the illustration in <xref ref="fig-potential-linesource"/>.  
   </p>
  </example>
   
<p>
    Another remark concerns the fact that <m>\psi</m> is a multi-valued function in the example of the line source <xref ref="example-streamfunction-linesource"/>, gaining a jump of <m>Q</m> every time the origin is encircled. This is indeed a warning that the standard proof, analogous to <xref ref="thm-exist-potential"/>, leading to the existence of a unique streamfunction, via <xref ref="eqn-streamfunction-def-psi"/> would not apply since the velocity field <xref ref="example-streamfunction-linesource"/> is not defined at the origin. However, despite this, we see that the streamfunction provides well-defined predictions of streamlines on the <em>cut</em> plane with e.g. <m>\theta \in [0, 2\pi)</m>.
   </p>

  <example>
    <title>Line source in a uniform flow</title>

  <p>
    Like the case of the potential function in <xref ref="example-potential-movingsource"/>, the linearity of the equation governing the streamfunction implies that we can consider the combination of those streamfunctions for a line source with a uniform flow. This yields 
    <me>
      \psi = Uy + \frac{Q}{2\pi}\theta, 
    </me>
    for the case of uniform flow of speed <m>U</m> in the positive <m>x</m>-direction. The streamlines are then given by 
    <me>
      Uy + \frac{Q}{2\pi} \theta = \frac{Q}{2\pi}C,
    </me>
   having designed the constant combination on the right hand-side for convenience. Then using <m>y = r\sin\theta</m>, we have
   <me>
    r = \left(\frac{Q}{2\pi U}\right) \frac{C - \theta}{\sin\theta}.
   </me>
  </p>
  </example>

<p>
  Our previous examples were reliant on considering the flows generated by the velocity potentials studied previously. However, we can also consider "fundamental solutions" of the equation <m>\nabla^2 \psi = 0</m> in their own right. Recall that in deriving the velocity potential of the line source in <xref ref="example-potential-linesource"/>, we considered the solution of an axi-symmetric problem, where <m>\phi = \phi(r)</m> is only dependent on the distance from the origin. A similar argument must imply that the analogous axi-symmetric streamfunction is a permissible solution. And this leads us to the following example. 
</p>

  <example xml:id="example-streamfunction-linevortex">
   <title>Line vortex </title>
   <idx><h>line vortex</h></idx>

   <p>
    The fundamental solution for the streamfunction, in plane polar coordinates, is the axisymmetric solution, 
    <men xml:id="eqn-streamfunction-linevortex">
      \psi = -\frac{\Gamma}{2\pi}\log r,
    </men>
    defined up to a constant, and corresponds to a <em>line vortex</em>.
   </p>

   <p>
    The streamlines of such a flow correspond to circular trajectories with <m>r</m> constant, and are visualised in 
    <!-- <xref ref="fig-streamfunction-linevortex"/>. -->
</p>

      <figure xml:id="fig-streamfunction-linevortex">
          <caption>Streamlines (or velocity field) of a line vortex with <m>\Gamma = 1</m>.</caption>
        <image source="linevortex" width="90%"/> 
        </figure>
  

   <p>
    Recall that the radial and angular velocities are given by <xref ref="eqn-streamfunction-polar"/>. Therefore, we see that the velocity vector is given by 
    <men xml:id="eq-u-line-vortex">
      \bu = -\pd{\psi}{r} \be_{\theta} = \frac{\Gamma}{2\pi r} \be_{\theta},
    </men>
    and thus this flow corresponds to entirely circular trajectories orbiting the origin, and with angular velocity increasing as <m>r \to 0</m>.
   </p>

   <p>
    The quantity <m>\Gamma</m> is called the <em>vortex strength</em>, analogous to the source strength <m>Q</m> in <xref ref="example-potential-linesource"/>. Let us consider the amount of circulation around a contour <m>C</m> that contains the origin: 
    <me>
      \oint_C \bu \cdot \de{\bx} = \oint_C (u \, \de{x} + v \, \de{y}),
    </me>
    i.e. one envisions encircling the origin along <m>C</m>, adding up each of the velocity components tangential to the path. This is the circulation. By Stokes' theorem it is equal to the flux of vorticity of the corresponding bounding surface. 
   </p>

   <p>
    Choosing <m>C</m> to be the circle of radius <m>r = a</m>, we have <m>\de{\bx} = a \be_{\theta} \de{\theta}</m>. Then the circulation is given by
    <men xml:id="eq-line-vortex-circulation">
      \oint_C \bu \cdot \de{\bx} = \int_0^{2\pi} \frac{\Gamma}{2\pi a} \be_{\theta} \cdot \be_{\theta} a \de\theta = \Gamma.
    </men>
    So indeed this gives us an intuitive understanding of <m>\Gamma</m>. Notice that <m>\Gamma \gt 0</m> corresponds to flow in the anticlockwise sense, and <m>\Gamma \lt 0</m> corresponds to flow in the clockwise sense.
   </p>

   <p>
    In <xref ref="ps-streamfunction-flux-compute"/>, you will practice the computation of fluxes using line integrals. 
   </p>
  </example>
</subsection>
</section>

<section xml:id="sec-complex-potential">
  <title>The complex potential</title>
<introduction>
 <p>
  In the previous two sections, we studied the properties and utility of the velocity potential <m>\phi</m> and streamfunction <m>\psi</m> in the context of two-dimensional potential flows (inviscid, incompressible, irrotational). We did this with techniques from real-valued Vector Calculus.  As it turns out, there is a much more elegant and powerful framework for studying two-dimensional flow which leverages the significant power of complex analysis and complex variables. 
 </p>

 <p>
  In fact, you may have already noticed this on an intuitive level, given the intimate relationships between <m>\phi</m> and <m>\psi</m>, seeming to exhibit a certain kind of symmetry in formulae and operations. Complex analysis is the language in which we can make this kind of "symmetry" transparent. 
 </p>

 <p>
  We begin by reviewing (or in some cases, introducing) you to some key theorems about the properties of well-behaved (analytic) complex functions. 
 </p>

 <p>
  In his section, we will refer to a complex function generically as
  <me>f(z) = u(x, y) + \im v(x, y)
  </me>
  where <m>u</m> and <m>v</m> and the real-valued decompositions of the complex-valued function <m>f</m>. Also, <m>z = x + \im y</m>.
 </p>

 <p>
  A complex function is differentiated in much the same way as real-valued functions, with the definition that 
  <men xml:id="eqn-complex-derivative">
    f'(z) = \lim_{\Delta z \to 0} \frac{f(z + \Delta z) - f(z)}{\Delta z}.
  </men>
 The crucial difference with real-valued differentiation is that the above limit is required to hold whilst approaching the point <m>z</m> in any direction of the complex plane.
 </p>

  <remark>
    <p>
      As long as you stay away from exceptional points of a function, the "calculus" of complex functions is largely the same as for real-valued functions, e.g. 
      <md>
       <mrow> \dd{(z^m)}{z} = mz^{m-1}, \qquad \dd{\e^z}{z} = \e^z,</mrow> 
      <mrow>\dd{(\log (z+1))}{z} = \frac{1}{z + 1}, \quad \dd{\sin(z^2)}{z} = 2z\cos(z^2). </mrow>
      </md>
      and the usual rules of algebraic manipulations hold. There are some caveats, however, which are dealt with on an individual manner.
    </p>
  </remark>

    <remark>
    <title>Examinable content</title>
   
    <p>
      The proofs of all theorems from this section are non-examinable, but you are expected to understand the theorems and their relevance to the theory of potential flow.
    </p>
  </remark>
 

 <p>
  Below, we will often use susbcripts for partial differentiation, e.g. <m>u_x = \pd{u}{x}</m>.
 </p>
</introduction>

 <subsection xml:id="subsec-complex-introduction">
  <title>Cauchy's theorem and harmonic functions</title>

  <p>We will follow the reference text by <xref ref="ref-kreyszig"/> and <xref ref="ref-fornberg"/>  and introduce the basic notions of complex functions that we will need. 
  </p>

    <definition xml:id="def-analytic">
      <title>Analyticity</title>
      <idx><h>analytic</h></idx>
      <statement>
        <p>
        A function <m>f: \mathbb{C} \to \mathbb{C}</m> is said to be analytic in a domain if <m>f(z)</m> is defined and differentiable at all points in the domain. The function is said to be <em>analytic at a point</em> <m>z = z_0</m> if it is analytic in a neighbourhood of <m>z_0</m>.     
        </p>

        <p>
          When we refer to an <em>analytic function</em>, we mean a function that is analytic in some domain of <m>\mathbb{C}</m> (often clear by context).
        </p>

        <p>
      The function is <em>holomorphic</em><idx><h>holomorphic</h></idx> if it is analytic; the terms are synonyms. 
        </p>

        <p>
          An analytic function is <em>entire</em><idx><h>entire</h></idx> if its region of analyticity includes all points in <m>\mathbb{C}</m>, including infinity. 
        </p>
      </statement>
    </definition>

  <p>
    Note that above, we have stated that a function is analytic if it is well-defined and differentiable <em>once</em>(!) As it turns out, the requirement that a complex-valued function is differentiable is a strong condition. An analytic function turns out to be infinitely differentiable by consequence!
  </p>
 
  <remark>
    <p>
      In this module, we will not be concerned with formalities when they are not relevant. For example, in our definition of analyticity, we do not specify if the relevant domains are open or closed. The functions we work with are generally non-pathological---they may have isolated singularities or exceptional points, but generally the application and context will make it clear the limits of our results.
    </p>
  </remark>


 
  <p>
    Now we have one of the most important theorems of complex analysis. </p>

    <theorem xml:id="thm-CR1">
      <title>Cauchy-Riemann equations I</title>
      <statement>
        <p>
         If <m>f(z) = u(x, y) + \im v(x, u)</m> is differentiable, then the Cauchy-Riemann equations, given by
       <men xml:id="eqn-CR">
       u_x = v_y \quad \text{and} \quad u_y = -v_x,
       </men>
       hold.
        </p>

        <p>
          In particular, if <m>f</m> is analytic on a domain, then its real and complex parts must satisfy the Cauchy-Riemann equations <xref ref="eqn-CR"/> (in that domain).
        </p>
      </statement>

        <proof>
          <p>
            (Non-examinable)
          </p>
          <p> 
            This follows by considering the definition of the derivative <xref ref="eqn-complex-derivative"/> when the point <m>z</m> is approached from the <m>x</m> or <m>y</m> directions. 
          </p>

          <p>
            With <m>\Delta z = \Delta x</m> real, we can verify from applying the definition that 
            <me>
              f'(z) = \pd{u}{x} + \im \pd{v}{x}.
            </me>
            On the other hand, approaching with <m>\Delta z = \im \Delta y</m> gives 
            <me>
              f'(z) = -\im \pd{u}{y} + \pd{v}{y}. 
            </me>
          Equating the two results then yields the Cauchy-Riemann equations.
          </p>
        </proof>
    </theorem>

<p>
  It turns out that the Cauchy-Riemann equations are not only necessary to an analytic function, but are actually sufficient as well. 
</p>

  <theorem xml:id="thm-CR2">
    <title>Cauchy-Riemann equations II</title>
    <statement>
      <p>
      If two real-valued continuous functions, <m>u(x, y)</m> and <m>v(x, y)</m> of two real variables <m>x</m> and <m>y</m> have continuous firsst partial derivatives that satisfy the Cauchy-Riemann equations <xref ref="eqn-CR"/> in some domain, then <m>f(z) = u(x, y) + \im v(x, y)</m> is analytic in that domain.      
      </p>
    </statement>

      <proof>
        <p>
          (Non-examinable)
        </p>
        <p>
          The proof is not difficult, but we will refer students to <xref ref="ref-kreyszig"/> for its proof. It relies on constructing the derivative of <m>f</m> along any direction using the decomposition into the two Cartesian directions.
        </p>
      </proof>
  </theorem>

  <theorem xml:id="thm-complex-inf-derivatives">
    <statement>
      <p>
       If <m>f</m> is analytic, it is differentiable to all orders. 
      </p>
    </statement>
  </theorem>
  

<p>
  Our last step involves relating complex functions to the solution of Laplace's equation(s), i.e. <xref ref="eqn-2d-laplace"/> or <xref ref="eqn-2d-streamfunction-laplace"/>, that govern potential flow.
</p>

  <theorem xml:id="thm-complex-laplace">
    <title>Analyticity and Laplace's equation</title>
    <statement>
      <p>
      If <m>f(z) = u(x, y) + \im v(x, y)</m> is analytic in a domain <m>D</m>, then <m>u</m> and <m>v</m> satisfy Laplace's equation, 
      <me>
        \nabla^2 u = u_{xx} + u_{yy} = 0 \quad \textrm{and} \quad
        \nabla^2 v = v_{xx} + v_{yy} = 0,
      </me>
      in <m>D</m>, and have continuous second partial derivatives in <m>D</m>.
          
      </p>
    </statement>

      <proof>
        <p>
          Since <m>f</m> is analytic, then it follows from <xref ref="thm-CR1"/> that <m>u_x = v_y</m> and <m>u_y = -v_x</m>. It furthermore follows from <xref ref="thm-complex-inf-derivatives"/> that <m>f</m> is differentiable to all orders; therefore, we can take derivatives to obtain 
          <me>
            u_{xx} = v_{yx} \quad \text{and} \quad -u_{yy} = v_{xy}. 
          </me>
          The second derivatives are continuous and therefore <m>v_{xy} = v_{yx}</m>. Therefore <m>u_{xx} + u_{yy} = 0</m>. Laplace's equation is analogously proved for <m>v</m>.
          
        </p>
      </proof>
  </theorem>

<p>
  The above theorem is truly a remarkable result; it would not be a stretch to state that this single result was at the forefront of why complex analysis played such an important role in the development of applied mathematics and physics in the 18th, 19th, and 20th centuries. 
</p>

<p>
  Since Laplace's equation, <m>\nabla^2 \phi = 0</m>, is such an important equation in physics, occuring in theories of gravitation, electrostatics, fluid mechanics, etc. the theorem establishes that there exists a parallel theory in the language of complex variables for the specific case of two-dimensional applications. 
</p>

<p>
  A potential fluid, for example, can be studied by manipulating complex functions of the form 
  <me>
    f(z) = \phi(x, y) + \im \psi(x, y).
  </me>
  One can envision all kinds of different forms of <m>f</m>---polynomials, cosines and sines, exponentials, logarithms, etc. As long as the function is locally differentiable, it is thus analytic and therefore can be associated with (some kind of) fluid flow.
</p>
 </subsection>

 <subsection xml:id="subsec-complex-examples">
  <title>Examples of elementary flows</title>

  <p>
    Let us return to the examples of flows studied in <xref ref="sec-Potential-and-streamfunction"/> and re-interpret them using the theory of analytic functions.
  </p>

  <p>
    We will associate the velocity potential, <m>\phi</m>, and streamfunction <m>\psi</m> with an analytic function in the following way. 
  </p>

    <definition xml:id="def-complex-potential">
      <statement>
        <p>
         Let <m>\phi(x,y)</m> and <m>\psi(x, y)</m> be the respective velocity potential and streamfunction for some potential flow. We define
    <men xml:id="eqn-complex-potential">
      f(z) = \phi(x, y) + \im \psi(x, y),
    </men>
    and call <m>f</m> the <em>complex potential</em>. 
        </p>

        <p>
          Note that by differentiating in the horizontal and vertical directions, we have 
          <me>
            \dd{f}{z} = \pd{}{x} (\phi + \im \psi) = \pd{}{y} (\phi + \im \psi). 
          </me>
         Therefore it follows that the horizontal and vertical velocity components of the flow, related via <m>\bu = [u, v]</m>, are given by 
         <men xml:id="eqn-complex-velocity">
          \dd{f}{z} = u - \im v.
         </men>
          
        </p>
      </statement>
    </definition>
  


    <example>
      <title>Uniform flow</title>
      <idx><h>uniform flow, complex</h></idx>

      <p>
        We can verify that the complex potential for uniform flow is given from 
       <me>
        f(z) = U \e^{-\im \alpha} z.
       </me>
       This can be compared to  <xref ref="example-potential-uniform"/>.
      </p>
    </example>
  
    <example>
      <title>Stagnation point flow</title>
      <idx><h>stagnation point flow, complex</h></idx>

      <p>
        We can verify that the complex potential for a stagnation point flow is given by
       <me>
        f(z) = \frac{z^2}{2}.
       </me>
       This can be compared to  <xref ref="example-potential-stagnation"/>.
      </p>
    </example>
  
    <example>
      <title>Line source</title>
      <idx><h>line source, complex</h></idx>

      <p>
        We can verify that the complex potential for a line source flow is given by
       <men xml:id="eqn-complex-linesource">
        f(z) = \frac{Q}{2\pi} \log z
       </men>
       This can be compared to  <xref ref="example-potential-linesource"/>.
      </p>

      <p>
        The complex logarithm is an example of a function that is not analytic at the isolated point <m>z = 0</m> where it possesess a <em>branch point</em>. However, it still provides a permissible analytic function away from the origin. 
      </p>

      <p>
        The evaluation of the complex logarithm can be performed via the definition 
        <men xml:id="eqn-complex-logarithm">
          \log z = \log r + \im \theta,
        </men>
        where <m>z = r\e^{\im \theta}</m> is the polar form representation of <m>z</m>. In particular <m>log z</m> is a multi-function with a <em>branch point</em> at the origin. 
      </p>

      <p>
        With the above decomposition of the logarithm in mind, notice that we can then conclude that the velocity potential and streamfunction are given by 
        <me>
          \phi = \Re[f] = \frac{Q}{2\pi} \log r \quad \text{and} \quad
          \psi = \Im[f] = \frac{Q}{2\pi} \theta.
        </me>
        Indeed the streamlines are along the rays <m>\theta</m> constant.
      </p>

      <p>
        From <xref ref="eqn-complex-linesource"/>, we can also compute the velocities using the relationship <xref ref="eqn-complex-velocity"/>. We thus have 
        <me>
         u - \im v = \frac{Q}{2\pi} \frac{1}{z} = \frac{Q}{2\pi} \frac{x - \im y}{(x^2 + y^2)},
        </me>
        once we have multiplied the top and bottom by the conjugate of <m>z</m>.
      </p>
    </example>
  
    <example>
      <title>Line vortex flow</title>
      <idx><h>line vortex, complex</h></idx>

      <p>
        We can verify that the complex potential for a line vortex is given by
       <men xml:id="eq-line-vortex-complex-potential">
        f(z) = -\frac{\im \Gamma}{2\pi} \log z.
       </men>
       This can be compared to  <xref ref="example-streamfunction-linevortex"/>.
      </p>

      <p>
        Again, using the definition of the complex logarithm, via <xref ref="eqn-complex-logarithm"/>, we can write <m>f</m> in terms of its real and complex components as 
        <me>
          f(z) = \frac{\Gamma}{2\pi} (\theta - \im \log r),
        </me>
        where <m>z = r\e^{\im\theta}</m>.</p>
        <p>
       Therefore, the streamfunction is given by <m>\psi = -(\Gamma/2\pi) \log r</m> and is constant along circular trajectories with constant distance from the origin, <m>r</m>. 
      </p>
    </example>
  
 </subsection>
</section>

<section xml:id="sec-method-of-images">
  <title>The method of images</title>

  <introduction>
  <p>
    The preceeding sections would give the misleading impression that solving potential-flow problems for two-dimensional flows is easy. This is not the case, and the primary reason is due to the presence of <em>boundary conditions</em>. The elementary flows we have previously considered were unconfined and/or we did not consider additonal constraints on their behaviours at infinity. In reality, a real physical fluid, whether in the ocean, the air, or in a container, is confined in some direction, and we must often consider subtle questions about the mechanism that produces the fluid motion. 
  </p>

  <p>
    In this section, we consider the situation of solving for the potential flow in a fluid region with boundaries. Recall that this is equivalent to finding a velocity potential satisfying <m>\nabla^2 \phi = 0</m> or an analytic complex potential, <m>f(z)</m>. 
  </p>

  <p>
    Recall from <xref ref="note-noflux-BC"/> that on solid boundaries, we must impose the no-flux condition that
    <me>
      \bu \cdot \bn = \nabla \phi \cdot \bn = 0 \quad \text{on $\partial V$}.
    </me>
  </p>
  </introduction>

  <subsection xml:id="subsec-images-planar">
    <title>Planar boundaries: a half-plane</title>

   <p>
    Consider the situation illustrated in <xref ref="image-planar01"/>.
</p> 
    <figure xml:id="image-planar01">
      <caption>A flow region in the right half-plane, with a single source placed at <m>x = d</m>.</caption>
      <image source="image-planar01.jpg" width="80%"/>
    </figure>
   
   <p>
    We envision a semi-infinite region of fluid bounded on the left by a wall at <m>x = 0</m>. A single (line) source of strength <m>Q</m> is placed at <m>x = d</m>. Therefore from <xref ref="eqn-complex-linesource"/>, we would expect that at least near <m>x = d</m>, the complex potential behaves as 
    <me>
      f(z) \sim \frac{Q}{2\pi} \log (z-d) \quad \text{as $z \to d$}.
    </me>
    However the above solution does not satisfy the required boundary conditions at <m>x = 0</m> since it corresponds to a velocity field for which the horizontal velocity penetrates through <m>x = 0</m>. This can be verified via inspection. For example, we can inspect the velocity or the streamlines; this is part of <xref ref="ps-image-planar01"/>.
   </p>

   <p>
    Rephrased in terms of the streamlines, the boundary condition at <m>x = 0</m> is equivalent to the constraint that 
    <me>
      \Im f(z) = \psi = \textrm{constant at $x = 0$}.
    </me>
   </p>

   <p>
    Our inspired solution to the above problem is referred to as <em>the method of images</em>.</p>

    <note xml:id="note-method-of-images">
      <title>Method of images</title>

      <p>
        Given potential flow problem, we consider the superposition of elementary sinks/sources, i.e. 
       <me>
        f(z) = \frac{1}{2\pi} \sum_{j=0}^{N-1} Q_j \log(z - z_j), 
       </me>
      and/or vortices,
      <me>
        f(z) = -\frac{\im}{2\pi} \sum_{j=0}^{N-1} \Gamma_j \log(z - z_j).
      </me>
      The strengths and locations of the individual contributions are chosen so that boundary conditions on the required boundaries (including at infinity) can be met. 
      </p>
    </note>
   
   <p>
    Notice that the <em>linearity</em> of the potential flow problem is crucial: any analytic function is associated with a velocity potential that satisfies Laplace's equation, <m>\nabla^2 \phi = 0</m>, and therefore the superposition of such functions also yields a permissible complex potential, <m>f</m>. 
   </p>
    
    
    <p>We consider the addition of a "fictitious" image source, with the same strength at the reflected point <m>x = -d</m>, which lies outside of the posited fluid region. This gives the complex potential of 
    <me>
      f(z) = \frac{Q}{2\pi} \log(z - d) + \frac{Q}{2\pi} \log(z + d). 
    </me>
    This yields the illustration of the flow in <xref ref="fig-image-planar02"/>
</p> 
     <figure xml:id="fig-image-planar02">
      <caption>Placement of the image source at <m>x = -d</m> makes it so the boundary condition on <m>x = 0</m> can be satisfied.</caption>
      <image source="image-planar02.jpg" width="80%"/>
    </figure>
   
   <p>
    The corresponding complex velocity is given by 
    <me>
      u - \im v = f'(z) = \frac{Q}{2\pi}\frac{z}{z^2 - d^2}.
    </me>
    So indeed, on the central boundary, we have <m>z = \im y</m>, and 
    <me>
      u - \im v = - \im \frac{Q}{\pi} \frac{y}{y^2 + d^2},
    </me>
    and the velocity is entirely vertical. So indeed, the condition that <m>\bu \cdot \bn = 0</m> on the planar boundary is satisfied. 
   </p>

   <p>
    In order to study the complex velocity, <m>f(z)</m>, and develop an equation for the streamlines of the flow, we must first navigate the fact that the complex logarithm function is only well-defined in a slit complex plane. First, let
    <me>
    z - d = r_1 \e^{\im \theta_1} \quad \textrm{and} \quad z + d = r_2 \e^{\im \theta_2}.
    </me>
    Using the definition of the complex logarithm <xref ref="eqn-complex-logarithm"/>, we have
    <me>
    f(z) = \frac{Q}{2\pi} \left[ \log r_1 + \log r_2\right] + \im \frac{Q}{2\pi}\left[ \theta_1 + \theta_2 \right].
    </me>
    The definitions of <m>r_1, r_2</m> and <m>\theta_1, \theta_2</m>, are shown in the below figure. In order for each logarithm to be well defined, the angles <m>\theta_1</m> and <m>\theta_2</m> must be restricted to be less than a complete revolution. We thus restrict <m>\theta_1 \in [0, 2\pi)</m> and <m>\theta_1 \in [-\pi, \pi)</m>. 
  </p>
    <figure xml:id="fig-image-duallog">
      <caption>When considering the evaluation of the flow, we must take care of the fact that the logarithm is multi-valued. A branch cut from each of the two branch points is imposed.</caption>
      <image source="image-duallog.jpg" width="100%"/>
    </figure>
  <p>
  In <xref ref="ps-image-planar02"/>, you will be asked to develop an equation for the streamlines of this flow. 
   </p>

  <p>
    The above ideas can be extended to the situation of a line vortex in a half plane. Again, we are interested in describing the flow due to a line vortex at <m>z = d</m>, and therefore we expect that near this point,
    <me>
      f(z) \sim -\frac{\im\Gamma}{2\pi} \log(z - d) \quad \textrm{as $z \to d$}.
    </me>
    However, the above potential does not satisfy the necessary zero-flux condition at <m>x = 0</m>.
  </p>

  <p>
    In this case, the approach is to add an image vortex at <m>z = -d</m>, but opposite in direction:
    <me>
      f(z) = -\frac{\im\Gamma}{2\pi} \log(z - d) + \frac{\im\Gamma}{2\pi} \log(z + d).
    </me>
    Therefore, this flow is composed by a line vortex circulating anticlockwise on the right, and a line vortex circulating clockwise on the left. It can be verified that the complex velocity is given by 
    <me>
      u - \im v = -\frac{\im \Gamma d}{\pi(z^2 - d^2)}
    </me>
    and indeed the velocity at <m>x = 0</m> is entirely vertical and there is no flux through the boundary. 
  </p>

  <p>
    There is an exercise in <xref ref="ps-image-planar03"/>.
  </p>

  <remark>
    <title>Uniqueness of solutions</title>
    <p>
      You may be wondering: if a permissible potential function is found that satisfies the necessary boundary conditions, can we be certain it is the unique solution in the problem (up to a constant)? You may understand the construction of potentials, via the method of images, but perhaps irked that it involves the insertion of these so-called 'fictitious' points. The answer, at least for most non-pathological problems in potential flow theory (i.e. all the problems you study) is <em>yes</em>, the solution you have found is assured to be the only solution (up to a constant).</p> 
      
     <p> This is, to some extent, related to the <url href="https://proofwiki.org/wiki/Uniqueness_of_Analytic_Continuation">uniqueness of analytic continuation</url>. In a nutshall, the relevant theorem states that given two admissible complex potentials, say <m>f_1(z)</m> and <m>f_2(z)</m>, that agree on the line <m>x = 0</m> (in the case of the above situation), it is the case that <m>f_1 = f_2</m> everywhere (where they are analytic). 
    </p>

    <p>
      Therefore, you can be certain that solutions you find via the trick of method of images are the only solutions.
    </p>
    
  </remark>
  </subsection>


  <!-- <subsection">
    <title>Planar boundaries: vortex flow</title>
    
  </subsection> -->


</section>

<section xml:id="sec-conformal-mapping">
  <title>Conformal mapping</title>

  <introduction>
    <p>
      The essential idea of conformal mapping is as follows. Suppose that we are given a two-dimensional potential fluid flow problem in a region, <m>R \subseteq \mathbb{C}</m>, with impermeable boundary <m>\partial R</m>. There may be singularities in <m>R</m> corresponding to sinks, sources, vortices, etc. We then seek a <em>conformal mapping</em> from the <m>z</m>-plane to the <m>\zeta</m>-plane via
      <me>
        \zeta = g(z),
      </me>
      so that the region <m>R</m> is mapped to a new region <m>\hat{R} \subseteq \mathbb{C}</m>, as shown in <xref ref="fig-conformal-general"/>.
    </p>
    
    <p>
      The hope is that within the <m>\zeta</m>-plane, the fluid region is sufficiently simple that a complex potential, say <m>F(\zeta)</m>, can be found. This task is aided by virtue of the fact that sinks/sources and vortices are preserved by the conformal map. Typically, we wish for <m>\hat{R}</m> to be e.g. the upper half-plane or the unit disc, with <m>\partial\hat{R}</m> to be the real axis or circumferance of the unit disc, respectively. Once found, the complex potential in the <m>z</m>-plane is then obtained simply by inverting the conformal map, i.e. 
      <me>
        f(z) = F(g(\zeta)) = \phi(x, y) + \im \psi(x, y).
      </me>
      This simple idea turns out to yield many insights to potential flows in two dimensions. 
    </p>

    <figure xml:id="fig-conformal-general">
      <caption>A general conformal mapping from the <m>z</m>-plane to the <m>\zeta</m>-plane. The object is to map the region <m>R</m> to the region <m>\hat{R}</m>, which is geometrically simpler.</caption>
      <image source="conformal_generalmap.jpg" width="100%">
        <shortdescription>Conformal mapping</shortdescription>
      </image>
    </figure>
  </introduction>

  <subsection>
    <title>Source in a wedge</title>

    <p>
      Consider fluid contained in a wedge with walls at <m>\theta = 0</m> and <m>\theta = \alpha > 0</m>, and with the fluid in <m>0 &lt; \theta &lt; \alpha</m>. A source of strength <m>Q</m> is placed somewhere within the flow, say at the point <m>z = c</m>. 
    </p>

    <p>
      Consider then the map 
      <men xml:id="eqn-conformal-wedge-map">
       \zeta = g(z) = z^{\pi/\alpha}.
      </men>
      It can be verified that this map transforms the fluid region to the upper half-<m>\zeta</m>-plane. Indeed the ray <m>\theta = 0</m> is mapped to the positive real axis and the ray <m>\theta = \alpha</m> is mapped to the negative real axis. This is shown in <xref ref="fig-conformal-wedge"/>.
    </p>

    <figure xml:id="fig-conformal-wedge">
      <caption>The map from the wedge-shaped region in the <m>z</m>-plane (left) and the upper half-<m>\zeta</m>-plane (right). </caption>
      <image source="conformal_wedge.jpg" width="100%">
        <shortdescription>conformal map</shortdescription>
      </image>
    </figure>

    <p>
      In the <m>\zeta</m>-plane, the fluid problem thus consists of solving for flow in the upper half-plane with a source of strength <m>Q</m> at the location <m>\zeta = c^{\pi/\alpha} = \zeta_c</m>, with an impermeable boundary on the real <m>\zeta</m>-axis. Indeed, from the previous section, we know this can be solved using the method of images, with a source placed at both the point <m>\zeta_c</m> and its complex conjugate point, <m>\overline{\zeta_c}</m>. It then follows that the complex potential is 
      <men xml:id="eqn-conformal-zeta-wedge">
       F(\zeta) = \frac{Q}{2\pi} \log(\zeta - \zeta_c) + \frac{Q}{2\pi} \log(\zeta - \overline{\zeta_c}).
      </men>
     We can then invert the above formula, expressing the complex potential in the <m>z</m>-plane as 
     <men xml:id="eqn-conformal-z-wedge">
      f(z) = F(g(z)) = \frac{Q}{2\pi} \log(z^{\pi/\alpha} - c^{\pi/\alpha}) + \frac{Q}{2\pi} \log(z^{\pi/\alpha} - \overline{c^{\pi/\alpha}}).
     </men>
    </p>

    <p>
      We can verify with a computational plot that this complex potential indeed seems to duplicate the necessary fluid flow within the wedge. 
    </p>
  </subsection>

  <subsection xml:id="subsec-conformal-theory">
    <title>The conformal mapping method</title>

    <p>
      How does it work?
    </p>

    <p>
      We can say that the conformal mapping method is dependent on a number of key properties of conformal maps. 
    </p>

    <definition xml:id="def-conformal-mapping">
      <title>Conformal map</title>
      <statement>
        <p>
         Let us specifically define a <em>conformal map</em> as a mapping, <m>\zeta = g(z)</m>, where <m>g</m> is analytic in a region <m>R</m> and also that <m>\dd{g}{z} \neq 0</m> in <m>R</m>.
        </p>
      </statement>
    </definition>

    <p>
      The following properties hold for conformal maps. 
    </p>

    <proposition xml:id="prop-conformal">
      <title>Properties of conformal maps</title>
      <statement>
        <p><ol>
          <li>
            <p>
              Conformal maps preserve angles.
            </p>
          </li>
          <li>
            <p>
              If the boundary <m>\partial{\hat{R}}</m> is a streamline in the <m>\zeta</m>-plane, then the corresponding boundary <m>\partial R</m> is a streamline in the <m>z</m>-plane (and vice versa). 
            </p>
          </li>
          <li>
            <p>
              A source (or vortex) of strength <m>Q</m> at <m>\zeta = g(c) \in \hat{R}</m> in the <m>\zeta</m>-plane corresponds to a source (or vortex) of the same strength <m>Q</m> at <m>z = c \in R</m> in the <m>z</m>-plane (and vice versa).
            </p>
          </li>
        </ol>
      </p>
      </statement>
    </proposition>
    
  </subsection>

  <subsection>
    <title>Standard conformal maps</title>
   
    <p>
    The <em>exponential map</em> is used to map a channel to a half-space. Consider a channel of width <m>h</m> in the region <m>0 &lt; \Im z &lt; h</m> in the <m>z</m>-plane. Then 
    <men xml:id="eqn-conformal-exp-map">
     \zeta = g(z) = \e^{\pi z/h},
    </men>
    maps this channel to the upper half-<m>\zeta</m>-plane. The correspondence of critical points and points at infinity in the pre-image and the image is shown in <xref ref="eqn-conformal-exp-map"/>. It is good to see the map as essentially 'unfolding' the infinite channel, sending points AD to the origin, while sending B to negative infinity and C to positive infinity. The conformal map will preserve the orientation of the boundary, so as we traverse along ABCD, the fluid region is always on the left. 
    </p>

    <figure xml:id="fig-conformal-exp">
      <caption>The exponential map maps the infinite strip of height <m>h</m> to the upper half-plane.</caption>
      <image source="conformal_exp.jpg" width="100%">
        <shortdescription>conformal map</shortdescription>
      </image>
    </figure>

    <p>
      <em>Trigonometric maps</em> are used to map semi-infinite channels into a half space. Consider for example, the region <m>R</m> given in the following diagram in <xref ref="eqn-conformal-sin-map"/>. We can then see that the semi-infinite channel of width <m>2a</m> has been mapped to the upper half-plane. The two corners at <m>z = \pm a</m> have been mapped to <m>\zeta = \pm 1</m>, respectively. 
    </p>

    <figure xml:id="fig-conformal-sin">
      <caption>The sinusoidal transformation maps the semi-infinite strip of width <m>2a</m> to the upper half-plane.</caption>
      <image source="conformal_sin.jpg" width="100%">
        <shortdescription>conformal map</shortdescription>
      </image>
    </figure>

    <p>
      The above map is given by 
      <men xml:id="eqn-conformal-sin-map">
        \zeta = g(z) = \sin\left(\frac{\pi z}{2a}\right).
      </men>
    </p>

    <!-- <p>
      In <xref ref="ps-conformal-check-exp-sin"/>, you will verify this. 
    </p> -->

    <example>
      <title>Vortex flow in a semi-infinite channel</title>
     <statement>
      <p>
        Consider the channel shown in the left of <xref ref="fig-conformal-sinh"/>. Insert a vortex of strength <m>\Gamma</m> at the point <m>z = d \in \mathbb{R^+}</m>. Verify that an appropriate conformal map is given by 
        <men xml:id="eqn-conformal-sinh">
         \zeta = g(z) = \textrm{sinh}\left(\frac{\pi z}{2a}\right),
        </men>
        and find where the map sends the relevant critical points of the pre-image.</p>
       
      <p>
        Using the conformal map, find the complex velocity of the flow. 
      </p>

      <figure xml:id="fig-conformal-sinh">
      <caption>The sinh transformation maps the semi-infinite channel with height <m>2a</m> to the right half-plane.</caption>
      <image source="conformal_sinh.jpg" width="100%">
        <shortdescription>conformal map</shortdescription>
      </image>
    </figure>
     </statement> 
      
    </example>
    
  </subsection>
</section>

  <section>
    <title>Flow past an aerofoil</title>

    <subsection xml:id="subsec-circle-maps">
      <title>Circle maps</title>

      <p>
        Previously we used the method of images to construct flows past polygonal and straight boundaries. 
      </p>

      <theorem xml:id="thm-circle-theorem">
        <title>Milne-Thomson's Circle Theorem</title>
        <statement>
          <p>
          Let <m>f(z)</m> be a given velocity potential such that any singularities in <m>f</m> occur in <m>|z| > a</m>. Then we can construct the following potential: 
          <men xml:id="eqn-milne-circle-map">
            w(z) = f(z) + \overline{f(a^2/\overline{z})},
          </men>
          and this potential has the following properties: (i) it has the asme singularities as <m>f</m> in the region <m>|z| > a</m>; and (ii) the circle <m>|z| = a</m> is a streamline. 
          </p>
        </statement>

        <proof>
          <p>
            (i) if <m>|z| &gt; a</m>, then <m>|a^2/\overline{z}| &lt; a</m>. Therefore the argument of the second term of <m>w</m> is within the circle of radius <m>|a|</m> and by assumption <m>f</m> is not singular there. 
          </p>

          <p>
            (ii) On the circle itself, <m>z = a\e^{\im\theta}</m>. 
            Then <m>a^2/\overline{z} = a\e^{\im\theta} = z</m>. Therefore, we have 
            <me>
            w(z) = f(z) + \overline{f(z)} = 2 \Re[f(z)].
            </me>
            Therefore the complex potential is entirely real. It follows that <m>\Im w = 0</m> on <m>|z| = a</m>, establishing that the circle is streamline.
          </p> 
        </proof>
      </theorem>

     <p>
      The above theorem then allows us to easily construct certain flows past circular cylinders. Here is an example.
     </p>

     <example>
      <title>Uniform flow past a circular cylinder</title>

      <p>
        We begin with the complex potential given by <m>f(z) = Uz</m>, which corresponds to horizontal uniform flow. We then consider inserting a circular cylinder with boundary <m>|z| = a</m>. Clearly, <m>f</m> satisfies the requirements of the Circle Theorem since it is non-singular for all <m>z</m>. Thus, we can construct the following result</p>

        <theorem xml:id="thm-flow-past-a-circular-cylinder">
          <statement>
            <p>
              Potential flow of consisting of uniform horizontal flow of speed <m>U</m> at infinity, past a circular cylinder of radius <m>a</m> (placed at the origin) is given by the complex potential
        <men xml:id="eqn-potential-uniform-past-circle">
          w(z) = \phi + \im \psi = Uz + \overline{\frac{Ua^2}{\overline{z}}} = Uz + \frac{Ua^2}{z}.
        </men>
            </p>
          </statement>
        </theorem>

        <p>
          The streamlines of the flow, found by taking the imaginary part of the above, are shown in <xref ref="fig-conformal-circle-flow"/>.
        </p>
        
        <figure xml:id="fig-conformal-circle-flow">
      <caption>Uniform flow past a circle</caption>
      <image source="conformal_circle_flow.png" width="70%">
        <shortdescription>Circle flow</shortdescription>
      </image>
    </figure>
     </example>

     <p>
      The next example will be studied during the problem class.
     </p>

      <example xml:id="example-uniform-past-circle-with-vortex">
        <title>Problem class example</title>
        
        <introduction>
        <p>
          Previously, it was demonstrated, via <xref ref="eqn-potential-uniform-past-circle"/> that uniform horizontal flow past a circle (circular cylinder) of radius <m>a</m> can be found via the complex potential function
          <men xml:id="eqn-flow-over-circle-problem">
            w(z) = Uz + \frac{Ua^2}{z},  
          </men>
          corresponding to uniform horizontal flow at infinity of speed <m>U</m>.
        </p>
        </introduction>

          <task>
            <statement>
              <p>
                Confirm, by use of the streamfunction <m>\psi</m>, that the circle boundary is a streamline of the flow. 
              </p>

              <p>
                It will be useful to remind yourself that 
                <men xml:id="eqn-complex-cosine">
                 \cos\theta = \frac{\e^{\im\theta} + \e^{-\im\theta}}{2}. 
                </men>
              </p>
            </statement>


            <solution>
              <p>
                We set <m>z = a\e^{\im\theta}</m> into the streamfunction. This gives 
                <me>
                  \phi + \im \psi = U \left( \e^{\im \theta} + \e^{-\im\theta}\right) = 2U\cos\theta.
                </me>
               Therefore <m>\psi = \Im w = 0</m> on the surface of the cylinder.
              </p>
            </solution>
          </task>

          <task>
            <statement>
              <p>
                Derive the complex velocity, <m>u - \im v</m> and use it to show that on the surface of the cylinder, the velocity is given by 
                <me>
                  u - \im v = 2U \e^{\im (\pi/2 - \theta)} \sin\theta,
                </me>
                where <m>z = a\e^{\im\theta}</m>.                
              </p>

              <p>
                It is helpful for you to remember that 
                <men xml:id="eqn-complex-sine">
                  \sin\theta = \frac{\e^{\im\theta} - \e^{-\im\theta}}{2\im}.
                </men>                
              </p> 
            </statement>

            <solution>
              <p>
                We need to take the derivative to obtain the complex velocity. So we have 
                <me>
                  w'(z) = u - \im v = U\left(1 - \frac{a^2}{z^2}\right).
                </me>
                So again, substitution of <m>z = a\e^{\im\theta}</m> and simplifying gives 
                <me>
                  u - \im v = U \e^{-\im \theta}\left( \e^{\im\theta} - \e^{-\im\theta}\right) = 2U \e^{\im(\pi/2 - \theta)} \sin\theta.
                </me>
              </p>
            </solution>
          </task>

          <task>
            <statement>
              <p>
               Conclude that on the surface of the cylinder, the maximum velocity is <m>|\bu| = 2U</m>. Where does this maximum velocity occur? Where do stagnation points in the flow (where the velocity is zero) occur?  
              </p>
            </statement>

            <solution>
              <p>
                From the above, we clearly see that the magnitude is <m>|u - \im v| = 2U\sin\theta</m> so the maximum speed on the cylinder is <m>2U</m>. This value is obtained at the top and bottom with <m>\theta = \pm \pi/2</m>. The stagnation point is found where the speed is zero, and this is at the fore and aft points, <m>\theta = \pi, 0</m>.
              </p>
            </solution>
          </task>


          <task>
            <statement>
              <p>
                Show that on the surface of the cylinder, the pressure force is given by 
                <me>
                  p = p_\infty + \frac{1}{2} \rho U^2(1 - 4\sin^2\theta),
                </me>
                where <m>p_\infty</m> is a constant value.
              </p>
            </statement>

          <solution>
            <p>
              We know from Bernoulli's equation, without gravity, that we have (<xref ref="thm-bernoulli-potential"/>): 
              <me>
                \left(p + \frac{\rho}{2} |\bu|^2\right)_{\text{cylinder}} = \left(p_\infty + \frac{\rho}{2} U^2\right)_{\text{infinity}}
              </me>
              where we have set the constant on the RHS of the formula to be <m>p_\infty/\rho</m>, setting a reference pressure. We now only need to substitute the speed on the cylinder, <m>|\bu| = U(4\sin^2\theta)</m>, giving
              <me>
                p = p_\infty + \frac{\rho}{2}U^2(1 - 4\sin^2\theta)
              </me>
              as desired.
            </p>
          </solution>
          </task>


        <task>
          <statement>
            <p>
              It is possible to add a line vortex to the interior of the circular cylinder, centred at <m>z = 0</m> by writing in addition to <xref ref="eqn-flow-over-circle-problem"/>, an additional term: 
              <me>
                w(z) = U \left(z + \frac{a^2}{z}\right) - \frac{\im\Gamma}{2\pi} \log z.
              </me>
              Verify again that the above modification does not change the streamline properties of <m>|z| = a</m>. 
            </p>

            <p>
              Does the above flow satisfy the condition that the flow is of uniform speed <m>U</m> far upstream? 
            </p>
          </statement>

          <solution>
            <p>
              The addition of the line vortex does not change the streamline patterns on the cylinder since it is a linear addition. Indeed, on the surface, we have from the addition: 
              <me>
                -\frac{\im \Gamma}{2\pi} (\log a + \im \pi \theta) = -\frac{\Gamma}{2\pi} (-\pi \theta + \im \log a).
              </me>
             Therefore the imaginary part is still a constant, and hence the boundary of the cylinder is still a streamline of the flow.  
            </p>

            <p>
              To verify that the upstream flow is not altered, we can take a derivative to obtain the complex velocity: 
                              <me>
                  w'(z) = u - \im v = U\left(1 - \frac{a^2}{z^2}\right) - \frac{\im}{2\pi z}.
                </me>
                So in the limit <m>|z| \to \infty</m>, we see indeed that the velocity is horizontal with speed <m>U</m>.
            </p>
          </solution>
        </task> 

        
        <task>
          <statement>
            <p>
              By studying the velocity of the flow with the rotation element, verify that the complex velocity on the surface is given by 
              <me>
                u - \im v = \im \e^{-\im\theta}\left(2U \sin\theta  - \frac{\Gamma}{2\pi a}\right). 
              </me>
            </p>

            <p>
              Conclude that a point on the cylinder that satisfies the equation 
              <me>
                \sin\theta = \frac{\Gamma}{4\pi a U},
              </me>
              is a stagnation point of the flow.
            </p>
          </statement>

          <solution>
            <p>
                            We had previously simplified the left terms in brackets: 
              <me>
                u - \im v = 2U \im \e^{-\im\theta}\sin\theta - \frac{\Gamma\im}{2\pi a} \e^{-\im\theta} = \im \e^{-\im\theta}
                \left(2U \sin\theta - \frac{\Gamma}{2\pi a}\right).
              </me>
            </p>

            <p>
              A stagnation point requires that <m>|u - \im v| = 0</m>, so setting the terms in brackets to zero implies 
              <me>
                \sin\theta = \frac{\Gamma}{4\pi a U},
              </me>
              as desired. 
            </p>
          </solution>
        </task>

        <task>
          <statement>
            <p>
              (Not examinable) Use a computational tool to investigate the streamlines of the flow for <m>\Gamma = 0, 2\pi aU, 4\pi a U, and 6\pi a U</m>. 
            </p>

            <p>
              The fact that the stagnation point shifts, moving on the topside or bottomside of the circular cylinder, dependent on the value of <m>\Gamma</m> will result in an asymmetry in the pressure, causing net force on one side of the cylinder. This is related to the well-known <em>Magnus effect</em>, which is used by athletes to cause a ball's trajectory to move from a straight path. 
            </p>
          </statement>

          <solution>

            <p>
              The point of the previous exercise is to note that when <m>\Gamma \neq 0</m>, this shifts the location of the stagnation point. For example, if <m>\Gamma = 4\pi a U</m>, then the stagnation points are found at
              <me>
                \sin\theta = 1 \Longrightarrow \theta = \pi/2,
              </me>
              i.e. the top of the cylinder.
            </p>
            <p>
              <figure xml:id="fig-circle-with-vortex">
                <caption>Flow past a circular cylinder with interior line vortex of different strengths.</caption>
                <image source="conformal_circle_with_vortex.png" width="100%">
                  <shortdescription>Flow past a circular cylinder with vortex</shortdescription>
                </image>
              </figure>
            </p>
          </solution>
        </task>

        
      </example>


    </subsection>

  
<subsection xml:id="subsec-">
  <title>The Joukowski map</title>
  
    <p>
    We shall study the following mapping. 
    </p>

    <definition xml:id="def-joukowski">
      <statement>
        <p>
         The <em>Joukowski transformation</em> is the map 
         <men xml:id="eqn-joukowski">
          z = G(\zeta) = \zeta + \frac{a^2}{\zeta}
         </men>
         where <m>a &gt; 0</m> is a parameter. The mapping is conformal at all points except <m>\zeta = 0</m> (pole) and <m>\zeta = \pm a</m> where <m>G'(\zeta) = 0</m>.
        </p>
      </statement>
    </definition>

    <p>
      Consider a circle in the <m>\zeta</m>-plane. Let <m>\zeta = r\e^{\im\theta}</m>. Then in the <m>z</m>-plane, this is mapped to 
      <me>
        z = r\e^{\im\theta} + \frac{a^2}{r}\e^{-\im\theta}  = \left(r + \frac{a^2}{r}\right)\cos\theta + \im \left(r - \frac{a^2}{r}\right)\sin\theta. 
      </me>
      Provided that <m>r &gt; a</m>, this the equation of an ellipse with principle radii <m>r + a^2/r</m> and <m>r - a^2/r</m>. The orientation of circles is preserved, with an anticlockwise rotation in <m>\zeta</m> corresponding to anticlockwise in <m>z</m>. The exterior of the circle <m>|\zeta| = r</m> is mapped to the exterior of the ellipse in <m>z</m>.</p>
      
      <p>In addition note that if <m>r \to a</m>, the ellipses tends to the line segment
      <me>
      S = \{ z = 2a\cos\theta \, | 0 \leq \theta \leq \pi\},
      </me>
      which then ranges from <m>z = 2a</m> for <m>\theta = 0</m> to <m>z = -2a</m> for <m>\theta = \pi</m>. As <m>\theta</m> further ranges in <m>[\pi, 2\pi)</m>, this traverses the horizontal plate again. One can interpret it as traversing the top or the bottom side of the plate (a view strengthened from considering the limiting images). This is shown in <xref ref="fig-conformal-joukowski01"/>.
    </p>

    <figure xml:id="fig-conformal-joukowski01">
      <caption>The Joukowski transformation in <xref ref="eqn-joukowski"/> sends circles with radius <m>r \geq 1</m> to ellipses in the <m>z-</m>plane. In the limit <m>r \to a^+</m>, this approaches a horizontal plate of length <m>4a</m>.</caption>
      <image source="conformal_joukowski01.png" width="70%">
        <shortdescription>Joukowski map</shortdescription>
      </image>
    </figure>

    <p>
      If on the other hand, <m>r &lt; a</m>, then we can verify that the mapping still produces ellipses, but now with principal radii <m>r + a^2/r</m> and <m>a^2/r - r</m>. The orientation is now reversed, with anticlockwise orientation in <m>\zeta</m> mapped to clockwise orientation. Therefore, it is the case that the interior of the discs with <m>|\zeta| = r</m> are mapped to the exterior of ellipses in <m>z</m>. Again, in the limit that <m>r \to a^-</m> the images approach a flat plate of length <m>4a</m> on the axis. 
    </p>

        <figure xml:id="fig-conformal-joukowski02">
      <caption>The Joukowski transformation in <xref ref="eqn-joukowski"/> sends circles with radius <m>r \leq 1</m> to ellipses in the <m>z-</m>plane. As <m>r \to \infty</m>, these tend to infinitely large circles. The values here are <m>r = 0.5, 0.6, 0.7, 0.8, 0.9, 1.</m></caption>
      <image source="conformal_joukowski02.png" width="70%">
        <shortdescription>Joukowski map</shortdescription>
      </image>
    </figure>



    <p>
      We can invert <xref ref="eqn-joukowski"/>, and this gives
      <men xml:id="eqn-joukowski-inverted">
        \zeta = \frac{1}{2} \left(z \pm \sqrt{z^2 - 4a^2}\right) = 
        \frac{1}{2} \left(z \pm \sqrt{z-2a}\sqrt{z + 2a}\right).
      </men>
    As noted in <xref ref="sec-intro-multifunctions"/>, we must take care to define the proper branch cut structure for the two branch points at <m>z = \pm 2a</m>. 
    </p>

    <p>
      As noted in the exercises of <xref ref="ws-intro"/>, if we let 
      <me>
        z + 2a = r_1 \e^{\im \theta_1} \quad \text{and} \quad
        z - 2a = r_2 \e^{\im \theta_2}, 
      </me>
      and take <m>\theta_1, \theta_2 \in [0, 2\pi)</m>, this corresponds to a single branch cut between <m>z = -2a</m> and <m>z = 2a</m>. This branch cut choice is the most convenient since then it directly coincides with the central axis of the ellipse. 
    </p>

    <p>
      Once the proper branch structure has been chosen, we can define the two possible inverses of the mapping, corresponding to the positive and negative branches. We have 
      <mdn>
        <mrow>\zeta = g_+(z) \amp= \frac{1}{2}\left(z + \sqrt{z^2 - 4a}\right), </mrow>
        <mrow>\zeta = g_-(z) \amp= \frac{1}{2}\left(z - \sqrt{z^2 - 4a}\right). </mrow>
      </mdn>
    </p>

    <p>
      Let us return to the perspective of images from the <m>\zeta</m>-plane to the <m>z</m>-plane. We can now consider the images of circles in the <m>\zeta</m>-plane that have either been horizontally shifted and/or vertically shifted. The two critical points (points where the map is not conformal) mentioned above correspond to either <m>\zeta = \pm a</m> or <m>z = \pm 2a</m>. 
    </p>

    <p>
      Firstly in <xref ref="fig-conformal-joukowski03"/>, we see that horizontal shifts of the circle will corresponding to shifting and deforming the ellipse such that, as a critical point is approached, this forms a point of non-conformality in the image (a cusp).
    </p>

        <figure xml:id="fig-conformal-joukowski03">
      <caption>We now consider shifting the circle with <m>|\zeta| = 2</m> to the left, so that the circumferance passes through the critical point at <m>\zeta = a = 1</m>. This produces an image that resembles an aerofoil with a sharp trailing edge.</caption>
      <image source="conformal_joukowski03.png" width="70%">
        <shortdescription>Joukowski map</shortdescription>
      </image>
    </figure>

    <p>
      Top-bottom asymmetry can also be introduced by considering vertical shifts of the preimages. 
    </p>

           <figure xml:id="fig-conformal-joukowski04">
      <caption>Vertical shifts correspond to changing the top-bottom symmetry of the aerofoil. In this case, notice that if the circle in the left plane passes through a critical point, this produces a self-intersecting shape.</caption>
      <image source="conformal_joukowski04.png" width="70%">
        <shortdescription>Joukowski map</shortdescription>
      </image>
    </figure> 
</subsection>   

    <!-- <subsection xml:id="subsec-aerofoil-flow-plate-plate">
      <title>Flow past a flat plate</title>

      <p>
        Notes to appear here following Thursday 23 Oct lecture.
      </p>



      
    </subsection> -->

    
  </section>




<exercises xml:id="ws-potentialflows">

  <introduction>
 <p>
      There is an excellent <url href="https://potentialflow.com/">website at www.potentialflows.com</url> that allows you to plug in different flow elements (sources/sinks, vortices, etc.) into a potential flow and observe the streamlines and potential-flow lines. In your exercises, use this to help you visualise the flow.
    </p>
  </introduction>

  <exercisegroup>
    <title>Potential flows, part 1</title>
    
  
  <introduction>
    <p>
      These exercises cover approximately around sections 4.1 (the velocity potential) to 4.3 (the complex potential). 
    </p>
  <!-- <warning>
  <p>We look to complete worksheets in the week prior to the content being delivered.
    Once this is done, this disclaimer message will be removed.</p>
</warning> -->
  </introduction>

  <exercise xml:id="ps-streamfunction-flux-compute">
    <title>Basic calculations</title>
    <introduction>

      <p>
        The following question relates to two-dimensional potential flow.  Remember that the fluid flux through a surface given by contour <m>C</m> is given by <xref ref="eqn-2d-flux"/>, or
        <me>
          \int_C \bu \cdot \bn \, \de{s}.
        </me>
        You will get some practice on calculating this quantity below. 
      </p>

      <p>
        We can also calculate the total force on the surface specified by <m>C</m> by using the integral in <xref ref="eqn-total-force"/>. Since the force in potential flow is given by <xref ref="thm-inviscid-force"/>, then the total force is 
        <me>
          \text{total force} = \int_C (-p\bn) \, \de{s}
        </me>
       where <m>p</m> is the pressure force given by Bernoulli's equation: 
       <me>
        p = p_0 - \frac{\rho}{2} |\bu|^2,
       </me>
       and <m>p_0</m> is a reference value and we ignore gravity.
      </p>


      <p>
      For each of the following elementary flows, state or calculate: 

      <ul>
        <li>
          <p>
             the complex potential, <m>f(z)</m>; 
          </p>
        </li>
        <li>
          <p>
            the velocity vector, written in vector form <m>\bu = [u, v]</m>;
          </p>
        </li>

        <li>
          <p>
            the flux and fluid force on a surface consisting of a circle of unit radius;
          </p>

          <p>
            <em>Hint:</em> the unit normal for the circle is <m>\bn = [\cos\theta, \sin\theta]</m>; when converting to polar coordinates remember that <m>\de{s} = r\de{\theta}</m>.
          </p>
        </li>

        <li>
          <p>
           the flux and fluid force on a surface consisting of a plate given by the line <m>y = -x + 1</m> with <m>x > 0</m>.  
          </p>
        </li>
      </ul>
      </p>
    </introduction>

    <task>
      <statement>
        <p>
          Uniform flow of velocity <m>U</m> oriented at an angle of <m>\pi/4</m> to the horizontal. 
        </p>
      </statement>

      <solution>
        <p>
          (i) complex potential given in the notes is <me>f(z) = U\e^{-\im\alpha}z = U\e^{-\im \pi/4}z</me>;</p>
          
        <p>(ii) complex velocity is given by <m>f'(z) = u - \im v = U\e^{-\im \pi/4}</m>. Writing out the velocity components in vector form, we have 
        <me>
          \bu = U \Bigl[ \cos(\pi/4), \, \sin(\pi/4) \Bigr] = U \frac{\sqrt{2}}{2} \Bigl[1, 1\Bigr].
        </me>
        
        </p>

        <p>
          (iii) We expect the flux past a circle will be zero (since the flow will enter one side and exit the other). The flux is given by 
          <me>
            \int_{r = 1} \bu \cdot \bn \, \de{s} = U\frac{\sqrt{2}}{2} \int_0^{2\pi} [1, 1] \cdot [\cos\theta, \sin\theta] \de{\theta} = 0.
          </me>
        </p>

        <p>
          The force is given by 
          <me>
          \bF_{\text{total}} = \left(\frac{\rho}{2} U^2 - p_0\right) \int_0^{2\pi} [\cos\theta, \sin\theta] \, \de{\theta} = [0, 0]. 
          </me>
          The total force again is zero since the force on the two hemispheres will cancel themselves out.
        </p>

        <p>
          (iv) The normal of the plate is given by 
          <me>\bn = \frac{[1, 1]}{\sqrt{2}}</me> 
          (here we assume this normal is pointing 'out'). We can parameterise the plate using a vector equation for the position vector:
          <me>
            \br(t) = [t, -t + 1], \quad 0 \leq t \leq 1,
          </me>
          since the equation of the line is <m>y = -x + 1</m>. Then 
          <me>
            |\br'(t)| = |[1, -1]| = \sqrt{2}. 
          </me>
          So the surface conversion is 
          <me>
            \de{s} = |\br'(t)| \, \de{t} = \sqrt{2} \de{t}.
          </me>
          The flux is then 
          <me>
            U\frac{\sqrt{2}}{2} \int_{t = 0}^1 \frac{[1, 1]}{\sqrt{2}} \cdot [1, 1] \sqrt{2} \de{t} = \sqrt{2}U.
          </me>
          The above makes perfect sense. The fluid is entirely normal to the plate, and the plate has length <m>\sqrt{2}</m>. 
        </p>

        <p>
          For the force, remember that the pressure is constant, since the speed is constant. Thus 
          <me>
            \bF_{\text{total}}= \left(\frac{\rho}{2}U^2 - p_0\right) \int_0^1 \frac{[1, 1]}{\sqrt{2}} \cdot \, \sqrt{2} \, \de{t} =\left(\frac{\rho}{2}U^2 - p_0\right) [1, 1].
          </me>
          
        </p>
      </solution>
    </task>

    <task>
      <statement>
        <p>
          A line source of strength <m>Q</m> located at the origin. 
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          Stagnation point flow with a stagnation point at the origin. 
        </p>
      </statement>
    </task>

    <task>
      <statement>
        <p>
          A line vortex flow of strength <m>\Gamma</m> placed at the origin. 
        </p>
      </statement>
    </task>

    <!-- <task>
      <statement>
        <p>
        A flow consisting of a uniform flow of speed <m>U</m> moving horizontally to the right, combined with a line source of strength <m>Q</m> placed at the origin.   
        </p>
      </statement>
    </task> -->

    
  </exercise>

  
  <exercise xml:id="ps-potential-fluxcalc">
    <title>Evaluation of the flux</title>

    <statement>
      <p>
        Return to the previous question and, instead of directly calculating the flux via a line integral, use <xref ref="thm-flux-streamlines"/> to calculate the flux for the two geometries (unit circle and straight plate) for each of the flows given. 
      </p>
    </statement>
  </exercise> 

   <exercise>
    <title>Doublet</title>
   
    <introduction>
      <p>
        A line source of strength <m>Q</m> is at <m>z = a</m> and a line sink of the same strength is at <m>z = -a</m> where <m>a > 0</m>. 
      </p>
    </introduction>

    <task>
      <statement>
        <p>
          Write down the complex potential, <m>f(z)</m>. Find <m>f'(z)</m>. Locate any stagnation points and derive an equation for the streamlines of the flow. Finally, use a plotter, such as the one at <url href="https://potentialflow.com/">the potential flow simulator</url> to sketch the streamlines. 
        </p>
      </statement>

      <answer>
        <p>
          The complex potential is the sum of a line source and line sink:
          <me>
            f(z) = \frac{Q}{2\pi} [\log(z - a) - \log(z + a)].
          </me>
          Therefore the complex velocity is given by 
          <me>
            f'(z) = \frac{Q}{2\pi} \left[ \frac{1}{z-a} - \frac{1}{z+a}\right].
          </me>
          Stagnation points are where <m>f'(z) = 0</m>. There are no stagnation points. The streamfunction is given by 
          <me>
            \Im f = \frac{Q}{2\pi}(\theta_1 - \theta_2), 
          </me> 
          where <m>\theta_1</m> and <m>\theta_2</m> are angles measured relative to the positions about <m>\pm a</m>. Thus,
          <me>
            \theta_{1,2} = \tan^{-1} \left( \frac{y}{x \mp a} \right).
          </me>
         The streamlines are given where <m>\psi</m> is constant. The streamlines are shown below.
      </p>

      <figure>
        <caption>Streamlines for a sink and source</caption>
        <image source="potential_almostdoublet.png">
          <shortdescription>Almost doublet</shortdescription>
        </image>
      </figure>
    </answer>
  </task>

    <task>
      <statement>
        <p>
    Let <m>a \to 0</m> and <m>Q \to \infty</m> while keeping the product <m>aQ</m> fixed. This gives the flow due to a <em>doublet</em><idx><h>doublet</h></idx>. Show that its complex potential is <m>\mu/z</m> where <m>\mu</m> is expressed in terms of <m>a</m> and <m>Q</m>. It will be useful for you to use the fact that 
   <me>
    \log(1 + \alpha) = \alpha + O(\alpha^2)
   </me>
   considered as an appropriate approximation when <m>\alpha</m> is small. 
    
    Show that the streamlines are circles through the origin with centres on the <m>y</m>-axis.           
        </p>
      </statement>

      <solution>
        <p>
          Expanding the logarithms for small <m>a</m> gives
          <me>
            \log z - \log z + \log(1 - a/z) - \log(1 + a/z) \sim -\frac{2a}{z}.
          </me>
         Thus in the limit <m>a \to 0</m>, we have
         <me>
          f(z) \sim -\frac{Qa}{\pi} \frac{1}{z}.
         </me>
         Therefore, we let both <m>a \to 0</m> and <m>Q \to \infty</m> in a fashion such that <m>m = aQ</m> is fixed. We then have the potential
         <me>
          f(z) = \frac{\mu}{z}
         </me>
         where <m>\mu = -Qa/\pi.</m>
         
        </p>
      </solution>
    </task>

  </exercise>

  </exercisegroup>

  <exercisegroup>
    <title>Potential flows, part 2</title>
    <introduction>
      <p>
        These exercises will cover the second part of Chapter 4, from sec. 4.4 (the method of images).
      </p>
    </introduction>
  
 <exercise xml:id="ps-image-planar01">
      <title>Single source in a semi-infinite flow</title>
      <statement>
        <p>
       Verify that a single source of strength <m>Q</m> placed at the point <m>z = d > 0</m> is insufficient to describe flow bounded in the semi-infinite region, <m>x > 0</m>, with a planar boundary at <m>x = 0</m>. What is the horizontal and vertical velocities on the boundary? Find an equation for the streamlines and sketch the flow. 
        </p>
      </statement>
    </exercise>
    
  <exercise xml:id="ps-image-planar02">
      <title>A source in a semi-infinite flow</title>
      <statement>
        <p>
          Consider the situation of two point sources of identical strength, <m>Q</m>, placed at <m>z = \pm d</m>, with <m>d \gt 0</m>. Develop equations for the complex potential, <m>f(z) = \phi + \im \psi</m>, and complex velocity, <m>u - \im v</m>. 
        </p>

        <p>
          Demonstrate that the streamlines are given by hyperbolae and develop the equation for their form. 
        </p>
      </statement>
    </exercise>
  
  <exercise xml:id="ps-image-planar03">
      <title>Two vortices and a dividing boundary</title>
      <statement>
        <p>
          Consider the situation of two point vorticies of identical strength, but opposite direction, placed at <m>z = \pm d</m>, with <m>d \gt 0</m>. Develop equations for the complex potential, <m>f(z) = \phi + \im \psi</m>, and complex velocity, <m>u - \im v</m>. 
        </p>

        <p>
          Demonstrate that the streamlines are given by 
          <me>
            \psi = \frac{\Gamma}{2\pi}\log \left( \frac{r_2}{r_1}\right).
          </me>
        </p>
      </statement>
    </exercise>


    <exercise>
      <title>A line source in a flow; stagnation points</title>

      <statement>
        <p>
              Incompressible inviscid fluid occupies the region <m>y > 0</m>, and there is a rigid plane
wall at <m>y = 0</m>. There is a uniform flow, speed <m>U</m>, in the positive <m>x</m>-direction, and a
line source of strength <m>Q</m> at <m>(0, a)</m>, where <m>a &gt; 0</m>. Find the complex potential <m>f(z)</m>
and calculate <m>f'(z)</m>. Let <m>\beta = Q/(2\pi aU)</m>. Show that if <m>\beta &gt; 1</m> there are two stagnation
points, both on the wall, while if <m>\beta &lt; 1</m> there is only one, in the fluid, a distance <m>a</m>
from the origin. Try to sketch the streamlines in either case  
        </p>
      </statement>

      <solution>
        <p>
          The potential is given by 
          <me>
            f(z) = Uz + \frac{Q}{2\pi} [\log(z - a\im) + \log(z + a\im)] = Uz + \frac{Q}{2\pi} \log(z^2 + a^2).
          </me>
          The complex velocity is then 
          <me>
            f'(z) = U + \frac{Qz}{\pi(z^2 + a^2)}.
          </me>
        </p>

        <p>
          A stagnation point requires <m>f'(z) = 0</m> and so we solve the resultant quadratic to obtain 
          <me>
            z = \frac{-Q \pm \sqrt{Q^2 - (2a\pi U)^2}}{2\pi U}.
          </me>
          Setting <m>\beta = Q/(2\pi a U)</m>, there are two real roots if <m>\beta &gt; 1</m>. Hence this is the case of two stagnation points along the axis. If <m>\beta &lt; 1</m>, then there two complex conjugate points, and hence only one stagnation point in the flow field. 
        </p>

        <figure>
          <caption><m>\beta = 0.94</m></caption>
          <image source="potential_stag_2_inflow.png" width="70%">
            <shortdescription>image</shortdescription>
          </image>
        </figure>
        
        <figure>
          <caption><m>\beta = 1.3</m></caption>
          <image source="potential_stag_2_onbound.png" width="70%">
            <shortdescription>image</shortdescription>
          </image>
        </figure>
      </solution>
    </exercise>

    <exercise xml:id='ps-conformal-check-exp-sin'>
      <title>The exponential and sinusoidal conformal maps</title>
     <p>
     Check where each of the labeled points in the associated diagrams for the exponential map <xref ref="eqn-conformal-exp-map"/> and <xref ref="eqn-conformal-sin-map"/> are sent, from the <m>z</m>-plane to the <m>\zeta</m>-plane. In each of these cases, verify that an interior (within the fluid domain) is sent to the upper half-plane. 
     </p> 

     <p>
      Construct the complex potential that corresponds to a single line source placed within the fluid in each of these cases (an infinite strip of height <m>h</m> and a semi-infinite strip). 
     </p>
    </exercise>

    <exercise>
        <title>Elementary conformal maps</title>
      <statement>
        <p>
          Define the term <em>conformal map</em>. 
        </p>

        <p>
          Write down the conformal maps from the wedge <m>0 &lt; \textrm{arg}(z) &lt; \alpha</m>, from the strip <m>-a &lt; y &lt; a</m> and from the semi-infinite strip <m>0 &lt; y &lt; a</m>, <m>x &gt; 0</m> into the upper half-plane. Find all the points at which the map is not conformal. 
        </p>
      </statement>
      
    </exercise>

      <exercise>
        <title>Flow past a flat plate</title>
       
        <statement>
          <p>
            Show that the circle <m>|\zeta| = a</m> is mapped to a line segment 
            <me>
              S = \{ z: \Im z = 0, -2a \leq \Re z \leq 2a\}
            </me>
            along the real <m>z</m>-axis by the Joukowski transformation 
            <me>
              z = \zeta + \frac{a^2}{\zeta}.
            </me>
          </p>

          <p>
            Deduce that the exterior of the line segment is mapped to the exterior of the circle <m>|\zeta| = a</m> by the transformation 
            <me>
              \zeta = \frac{1}{2}\left( z + \sqrt{z^2 - 4a^2}\right).
            </me>
            Carefully define the function <m>\sqrt{z^2 - 4a^2}</m> and determine where the mapping above is conformal.
          </p>

          <p>
            Constuct a flow, by providing the complex potential <m>\phi + \im \psi</m> that consists of the following elements: (i) uniform flow oriented an angle <m>\alpha</m> to the horizontal at infinity; (ii) a line source of strength <m>Q</m> placed in the flow; and (iii) a horizontal flat plate of length <m>2a</m> on the axis, <m>-2a &lt; z &lt; 2a.</m> 
          </p>

          <p>
            Sketch what you believe will be the streamlines of such a flow.
          </p>
        </statement>
        
        
      </exercise>

      <exercise>
        <title>The Magnus effect and flow past a circular cylinder</title>
        <p>
          During the problem class, we will study <xref ref="example-uniform-past-circle-with-vortex"/> corresponding to verifying different properties of uniform flow past a circular cylinder, ending with studying the <em>Magnus effect</em> due to adding an initial line vortex of strength <m>\Gamma</m> into the flow. Please review the derivations and make your own notes on the example so that you are confident with the problem and its conclusions. 
        </p>
      </exercise>

      

<!-- Suggest to do Oxford Sheet 3, Q1, 3  -->
<!-- Suggest Imperial sheet 7, Q1, Q3, maybe Q5  -->
 

  
  </exercisegroup>

</exercises>

</chapter>