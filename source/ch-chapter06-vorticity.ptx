<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter06-vorticity" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Vortex motion</title>

  <introduction>
    <p>
      In this chapter, we will study the motion of vortices in an inviscid fluid.
      We will define vortex lines, which are to the vorticity field as the streamlines defined in
      <xref ref="ch-chapter02-kinematics"/> are to the velocity field. We will show that vortex
      lines move with the fluid and that a fluid that starts irrotational remains irrotational
      for all time.
    </p>

    <sidebyside>
      <figure>
        <caption>A tornado (credit Greg Johnson, Unsplash).</caption>
        <image source="ch-chapter06-greg-johnson-5V3FUicslvo-unsplash.jpg" width="35%" />
      </figure>
      <figure xml:id="fig-wingtip-vortices">
        <caption>Wingtip vortices behind an aircraft (credit NASA Langley Research Center).</caption>
        <image source="ch-chapter06-NASA-Langley-Research-Center-il_wingtipvortexedit_lg.jpg" width="35%" />
      </figure>
      <figure>
        <caption>Vortex created when a cup of tea is stirred, also showing the secondary flow that results,
        which in turn leads to the <em>tea leaf paradox</em> in which tea leaves sprinkled on the bottom
        of a cup migrate into a pile in the centre (you can try this at home). Credit Wikipedia.</caption>
        <image source="ch-chapter06-220px-Tea_leaf_Paradox_Illustration.png" width="25%" />
      </figure>
    </sidebyside>

    <p>
      Examples of vortex motion abound in nature and industry. The most familiar examples are perhaps
      tornadoes and hurricanes, which are large-scale vortices in the atmosphere. Other
      examples include the swirling motion that forms when water drains from a bath or
      sink, the wake vortices that form behind aircraft wings, and the vortices that form
      behind a swimming fish or a flying bird. Vortices are also important in engineering
      applications, for example in the design of aircraft wings and turbine blades.
    </p>
    <p>
      See for example these short videos of the flow produced by
      <url href="https://www-cambridge-org.ezproxy1.bath.ac.uk/core/homsy/category/dynamics/reynolds-number-inertia-and-viscosity/vortices/1712" visual="spoon in tea">drawing a spoon through a cup of tea</url>,
      or
      <url href="https://www-cambridge-org.ezproxy1.bath.ac.uk/core/homsy/category/1153" visual="wingtip vortices">a flying aircraft</url>.
    </p>
  </introduction>

  <section xml:id="sec-vorticity-circulation">
    <title>Vorticity and circulation</title>
    <subsection xml:id="sec-vorticity">
      <title>Vorticity</title>
      <p>
        The fluid vorticity <m>\bomega=\nabla\times\bu</m> was introduced in
        <xref ref="def-vorticity"/>. Many people struggle to understand the
        concept of vorticity when they first encounter it, so you should not worry if it
        takes a while to sink in. The excellent movie `Vorticity, Part 1’
        by Ascher Shapiro available at
        <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>
        gives a clear and comprehensive introduction to the phenomenon.
        Also, <xref ref="ref-homsy"/> gives a
        <url href= "https://www-cambridge-org.ezproxy1.bath.ac.uk/core/homsy/category/576" visual="Simple illustration of vorticity">simple illustration</url> of the vorticity. To recap:
        <ul>
          <li>
            <p>
              Vorticity, <m>\bomega</m>, is a vector field and it is a function of space and time
              (like the fluid velocity).
            </p>
          </li>
          <li>
            <p>
              At each point in the fluid, <m>\bomega</m> points in the direction of the axis of the local fluid rotation.
            </p>
          </li>
          <li>
            <p>
              The magnitude of <m>\bomega</m> is twice the local angular velocity.
            </p>
          </li>
          <li>
            <p>
              In the special case of a two-dimensional flow
              (that is <m>\bu(\bx,t)=(u(x,y,t),v(x,y,t),0)</m>), the vorticity is
              unidirectional, pointing in the <m>z</m>-direction with
              magnitude <me>\pd{v}{x}-\pd{u}{y}</me>.
            </p>
          </li>
        </ul>
      </p>

      <!--
      <example xml:id="ex-vorticity-intro">
      <title>Steady two-dimensional vortex flow</title>
      <statement>
        <p>
          Consider the steady, two-dimensional flow given by <me>\bu = (-y,x, 0)</me>, which is flow
          anti-clockwise around the origin. Note that this flow is a type of <em>rigid body rotation</em>:
          it is the flow that would be generated by a rigid body rotating about the <m>z</m>-axis
          with angular velocity <m>1</m>.
        </p>
        <p>
        <ol>
          <li>
            <p>
              Plot the streamlines of this flow.
            </p>
          </li>
          <li>
            <p>
              Convert this flow to plane polar coordinates <m>(r,\theta)</m> (where
              <m>x = r\cos\theta</m> and <m>y = r\sin\theta</m>), and show that the <m>r</m>-component
              of the velocity is zero and the <m>\theta</m>-component is <m>1</m>.
            </p>
          </li>
          <li>
            <p>
              Hence find the angular velocity of the fluid.
            </p>
          </li>
          <li>
            <p>
              Calculate the vorticity of the flow.
            </p>
          </li>
        </ol>
      </p>
      </statement>
      <solution>
        <p>
          The answers are as follows.
          <ol>
            <li>
                The streamlines satisfy the differential equation
                <me>
                  \dd{\bx}{s}=\bu(\bx(s)),
                </me>
                where <m>s</m> is a parameter along the streamline.
                In components, this reads
                <me>
                  \dd{x}{s}=-y, \quad \dd{y}{s}=x.
                </me>
                Differentiating the first equation with respect to <m>s</m> and using the second gives
                <me>
                  \dd{^2x}{s^2}=-\dd{y}{s}=-x,
                </me>
                which has general solution <m>x=A\cos s + B\sin s</m>.
                Using the first equation then gives <m>y=A\sin s - B\cos s</m>.
                Thus the streamlines are circles around the origin, given by <m>x^2+y^2=A^2+B^2</m>.
            </li>
            <li>
              We have
              <me>\dd{r}{t}=\frac{x}{r}(-y)+\frac{y}{r}(x)=0,</me>
              and
              <md>
                <mrow>
                  \dd{\theta}{t}&amp;=\dd{}{t}\left(\tan^{-1}\frac{y}{x}\right)
                </mrow>
                <mrow>
                  &amp;=\frac{1}{1+y^2/x^2}\left(-\frac{y}{x^2}\right)(-y)+\frac{1}{1+y^2/x^2}\left(\frac{1}{x}\right)(x)
                </mrow>
                <mrow>
                  &amp;=1.
                </mrow>
              </md>
              Thus, in plane polar coordinates, the velocity is <m>(0,1)</m>.
            </li>
            <li>
              The angular velocity is everywhere <m>(0,0,1)</m>.
            </li>
            <li>
              The vorticity of the flow is given by
              <me>
                \bomega = \bnabla\times\bu
                = \begin{vmatrix}
                \bi &amp; \bj &amp; \bk \\
                \pd{}{x} &amp; \pd{}{y} &amp; \pd{}{z} \\
                -y &amp; x &amp; 0
                \end{vmatrix}
                = (0,0,2),
              </me>
              which is twice the local angular momentum
              (magnitude twice the rotation rate, with axis in the direction of the axis of rotation).
            </li>
          </ol>
        </p>
      </solution>

      <task>
        <statement>
          <p>
            Plot the streamlines of this flow.
          </p>
        </statement>
        <solution>
          <p>
            The streamlines satisfy the differential equation
            <me>
              \dd{\bx}{s}=\bu(\bx(s)),
            </me>
            where <m>s</m> is a parameter along the streamline.
            In components, this reads
            <me>
              \dd{x}{s}=-y, \quad \dd{y}{s}=x.
            </me>
            Differentiating the first equation with respect to <m>s</m> and using the second gives
            <me>
              \dd[2]{x}{s}=-\dd{y}{s}=-x,
            </me>
            which has general solution <m>x=A\cos s + B\sin s</m>.
            Using the first equation then gives <m>y=A\sin s - B\cos s</m>.
            Thus the streamlines are circles around the origin, given by <m>x^2+y^2=A^2+B^2</m>.
          </p>
          </solution>
        </task>
        <task>
          <statement>
            <p>
            Convert this flow to plane polar coordinates <m>(r,\theta)</m> (where
            <m>x = r\cos\theta</m> and <m>y = r\sin\theta</m>), and show that the <m>r</m>-component
            of the velocity is zero and the <m>\theta</m>-component is <m>1</m>.              
            </p>
          </statement>
          <solution>
            <p>
              We have
              <me>\dd{r}{t}=\frac{x}{r}(-y)+\frac{y}{r}(x)=0,</me>
              and
              <md>
                <mrow>\dd{\theta}{t}&amp;=\dd{}{t}\left(\tan^{-1}\frac{y}{x}\right)</mrow>
                <mrow>&amp;=\frac{1}{1+y^2/x^2}\left(-\frac{y}{x^2}\right)(-y)+\frac{1}{1+y^2/x^2}\left(\frac{1}{x}\right)(x)</mrow>
                <mrow>&amp;=1.</mrow>
              </md>
              Thus, in plane polar coordinates, the velocity is <m>(0,1)</m>.
            </p>
          </solution>
        </task>
        <task>
          <statement>
            <p>
              Hence find the angular velocity of the fluid.
            </p>
          </statement>
          <solution>
            <p>
              The angular velocity is everywhere <m>(0,0,1)</m>.
            </p>
          </solution>
        </task>
        <task>
          <statement>
            <p>
              Calculate the vorticity of the flow.
            </p>
          </statement>
          <solution>
            <p>
              The vorticity of the flow is given by
              <me>
                \bomega = \bnabla\times\bu
                = \begin{vmatrix}
                \bi &amp; \bj &amp; \bk \\
                \pd{}{x} &amp; \pd{}{y} &amp; \pd{}{z} \\
                -y &amp; x &amp; 0
                \end{vmatrix}
                = (0,0,2),
              </me>
              which is twice the local angular momentum
              (magnitude twice the rotation rate, with axis in the direction of the axis of rotation).
            </p>
          </solution>
        </task>
      </example>-->
      <p>
        As mentioned in <xref ref="ch-chapter03-equations"/>, the vorticity obeys the
        vorticity equation <xref ref="eqn-vorticity-equation-lagrange"/>:
        <me>
          \DD{\bomega}{t} = (\bomega \cdot \nabla)\bu.
        </me>
        In two-dimensional irrotational flow, the right-hand side is zero, so the vorticity of each fluid
        particle is constant in time. This is a special case of the more general result known as
        the <em>Helmholtz principle</em>, which states that in an inviscid fluid, the vorticity
        of each fluid particle is conserved.
      </p>
    </subsection>

    <subsection xml:id="sec-circulation">
      <title>The circulation in a flow</title>
      <p>
        We introduce a definition that was briefly covered in the line vortex example
        <xref ref="example-streamfunction-linevortex"/>.
      </p>
      <definition xml:id="def-circulation">
        <title>The circulation</title>
        <statement>
          <p>
            We define the circulation around a closed loop <m>C</m> in the flow as
            <me>
              \Gamma = \oint_C \mathbf{u} \cdot \de\mathbf{x}.
            </me>
          </p>
        </statement>
      </definition>
      <theorem xml:id="thm-kelvin-circulation-theorem">
        <title>Kelvin's circulation theorem</title>
        <p>
          Assume that a fluid is inviscid and incompressible and that a conservative body force
          (e.g. gravity) acts on it. If a loop <m>C</m> is fixed in the fluid
          (and thus moves around in the Lagrangian sense as the fluid moves)
          then the circulation around <m>C</m> is constant in time.
        </p>
      </theorem>
      <proof>
        <title>Proof of Kelvin's circulation theorem</title>
        <p>
          A proof of this theorem is given in <xref ref="ex-kelvin-circulation-theorem"/>.      
        </p>
      </proof>    
      <remark>
        <title>Importance of Kelvin's circulation theorem</title>
        <p>
          This theorem explains why the circulation is an important physical concept.
          In particular, if a flow is initally irrotational,
          then the circulation around any loop is zero at <m>t=0</m>.
          The theorem then implies that the circulation around any loop is zero for all time.
          Therefore the flow at any time is irrotational.
        </p>
      </remark>    
      <remark xml:id="rem-circulation-vorticity">
        <title>Relationship between circulation and vorticity</title>
        <p>
          Using Stokes' theorem
          <men xml:id="eq-circulationvorticity">
            \Gamma=\oint_C{\bu}\cdot \de{\bx}=\int_S\left(\bnabla\times{\bu}\right)\cdot{\bn}\,{\de}S
            =\int_S\bomega\cdot{\bn}\,{\de}S,
          </men>
          where <m>S</m> is any surface spanning the loop <m>C</m>.
          Thus the circulation equals the flux of vorticity through the spanning surface.
        </p>
      </remark>
      <remark>
        <title>Independence of spanning surface</title>
        <p>
          Note that, for a given closed curve <m>C</m>,
          in the argument given in <xref ref="rem-circulation-vorticity"/>
          we could choose any surface <m>S</m> spanning <m>C</m>,
          and thus the circulation equals the vorticity flux through any
          spanning surface.
        </p>
      </remark>
    </subsection>

    <subsection xml:id="sec-vortex-lines">
      <title>Vortex lines and surfaces</title>
      <definition xml:id="def-vortex-lines">
        <title>Vortex lines</title>
        <statement>
          <p>
            Vortex lines are curves that point in the same direction as the vorticity vector.
            They satisfy the differential equation
            <me>
              \dd{\bx}{s}=\bomega(\bx(s),t),
            </me>
            where <m>t</m> is fixed.
            Just as the streamlines give a picture of the flow field,
            so the vortex lines give a picture of the vorticity field.
            Note that if the vorticity is zero at some point,
            the vortex lines are not defined there.
          </p>
        </statement>
      </definition>
      <remark>
        <title>Analogy with streamlines</title>
        <p>
          The vortex lines are to the vorticity of the fluid as the streamlines are to its velocity.
        </p>
      </remark>    
      <remark>
        <title>Vortex lines in a two-dimensional flow</title>
        <p>
          In a two-dimensional flow, the vorticity is unidirectional, so the vortex lines are
          straight lines parallel to the vorticity vector.
          For example, for a flow in the <m>(x,y)</m>-plane,
          the vorticity points in the <m>z</m>-direction, and the vortex lines are straight
          lines parallel to the <m>z</m>-axis.
        </p>
      </remark>
      <definition xml:id="def-vortex-surface">
        <title>Vortex surface</title>
        <statement>
          <p>
            A vortex surface is a surface such that <m>\bomega</m> is tangent
            to the surface at all points on the surface.
          </p>
        </statement>
      </definition>
      <remark>
        <title>Notes on vortex surfaces</title>
        <p>
          A couple of important points about vortex surfaces:
          <ul>
            <li>
              <p>
                Vortex lines cannot pass through a vortex surface.
              </p>
            </li>
            <li>
              <p>
                In particular, for any given vortex line, it is possible to
                choose two different vortex surfaces such that the vortex line is the
                intersection of the two vortex surfaces.
                This will be important in the next section.
              </p>
            </li>
          </ul>
        </p>
      </remark>
    </subsection>
  </section>

  <section xml:id="sec-helmholtz">
    <title>The Helmholtz vortex theorems</title>
    <introduction>
      <p>
        In this section, we cover some important theorems governing the motion of
        vortices in a fluid flow.
      </p>
      <figure xml:id="fig-helmholtz">
        <caption>Hermann von Helmholtz (1821-1894)</caption>
        <image source="ch-chapter06-Hermann_von_Helmholtz.jpg" width="50%">
          <shortdescription>Helmholtz</shortdescription>
        </image>
      </figure>
    </introduction>
    <subsection>
      <title>The theorems</title>
      <theorem xml:id="thm-helmholtz-vortex-theorems">
        <title>The Helmholtz vortex theorems</title>
        <p>
          For an inviscid, incompressible fluid under the influence of a conservative body force,
          the theorems state:
          <ol>
            <li>
              <p>
                Vortex lines move with the fluid.
                Thus they follow the material paths of the fluid particles.
                We can group nearby vortex lines together to form a vortex tube,
                as shown in <xref ref="fig-vortextube"/>
                (taken from <xref ref="ref-acheson"/>),
                and the vortex tube moves with the flow. The surfaces of the vortex tube are vortex lines.
                This is a strong part of the reason why it is useful to calculate vortex lines.
              </p>
            </li>
            <li>
              <figure xml:id="fig-vortextube">
                <caption>Sketch of a vortex tube.</caption>
                <image source="ch-chapter06-vortextube.jpg" width="50%">
                 <shortdescription>Vortex tube</shortdescription>
                </image>
              </figure>
              <p>
                The circulation of the tube is <m>\Gamma=\oint_C\bu\cdot \de{\bx}</m>
                around any closed curve <m>C</m> that goes once anticlockwise around the vortex tube,
                or equivalently <m>\Gamma=\int_S\bomega\cdot{\bn}\,\de S</m>,
                where <m>S</m> is any cross-section of the vortex tube,
                see <xref ref="eq-circulationvorticity"/>.
                The circulation is independent of the choice of curve <m>C</m>
                or cross-section <m>S</m> at all times.
              </p>
            </li>
          </ol>
        </p>
      </theorem>
      <proof>
        <title>Proof of the Helmholtz vortex theorems</title>
        <p>
          <em>Proof of the first vortex theorem.</em>
          For a given vortex line, choose two vortex surfaces containing the line
          such that the vortex line is the intersection of the two vortex surfaces.
        </p>
        <p>
          Choose a closed curve <m>C</m>
          lying within one the vortex surfaces.
          The circulation around <m>C</m> is
          <me>
            \Gamma=\oint_C\bu\cdot\de\bx=\iint_S\bomega\cdot\bn\,\de S,
          </me>
          where the final equality is by Stokes' theorem. Since the curve is within the
          vortex surface, the vorticity is parallel to the surface, and hence
          <m>\bomega\cdot\bn=0</m>. Thus <m>\Gamma=0</m>, and by Kelvin's circulation theorem
          <xref ref="thm-kelvin-circulation-theorem"/>, <m>\Gamma</m>
          must remain at zero for all times.
        </p>
        <p>
          Thus at time <m>t</m>, the evolved surface has circulation zero for all closed
          curves, and therefore by Stokes' theorem, the integral of <m>\bomega\cdot\bn</m>
          over any sub-surface must be zero. Hence <m>\bomega\cdot\bn=0</m> at all points
          on the surface, meaning that the vorticity is everywhere parallel to the evolved
          surface. This means that the evolved surface must be a vortex surface.
        </p>
        <p>
          Recall that any vortex line can be defined by the intersection of two vortex
          surfaces. Let the two surfaces evolve and the evolution of the vortex line
          remains as the intersection of the two evolved vortex surfaces. As proven
          already, the vorticity is everywhere parallel to the two evolved vortex surfaces
          and thus it is parallel to the evolved vortex line. This means that it remains
          as a vortex line.
        </p>
        <p>
          This completes the proof of the first vortex theorem:
          vortex lines evolve with the fluid.
          We sometimes say that the vortex lines are `frozen' in the fluid,
          meaning that the evolve in the same way as a dye `frozen' into the fluid would.
        </p>
        <p>
          <em>Proof of the second vortex theorem.
          Proof that <m>\Gamma</m> is the same for all cross-sections.</em>
          To prove the second vortex theorem, choose two different cross-sections of the
          vortex tube, <m>S_1</m> and <m>S_2</m> say, and consider the section <m>V</m>
          of the vortex tube lying between <m>S_1</m> and <m>S_2</m>. We integrate over
          the surface of <m>V</m>:
          <me>
            \iint_{\partial V}\bomega\cdot\bn\de S
            =\iint_{S_2}\bomega\cdot\bn\de S
            -\iint_{S_1}\bomega\cdot\bn\de S
            +\iint_{\mathrm{outside}}\bomega\cdot\bn\de S,
          </me>
          where `outside' refers to the outer surface of the vortex tube between
          <m>S_1</m> and <m>S_2</m>. Since vortex lines are paralled to this surface,
          we have <m>\bomega\cdot\bn=0</m> there, and so
          <me>
            \iint_{\partial V}\bomega\cdot\bn\de S
            =\iint_{S_2}\bomega\cdot\bn\de S
            -\iint_{S_1}\bomega\cdot\bn\de S.
          </me>
        </p>
        <p>
          Now, by the divergence theorem,
          <me>
            \iint_{\partial V}\bomega\cdot\bn\de S
            =\iiint_V\nabla\cdot\omega \de V,
          </me>
          but this equals zero, since <m>\nabla\cdot\omega=0</m>
          (divergence of a curl is zero).
        </p>
        <p>
          Putting this together,
          <me>
            \iint_{\partial V}\bomega\cdot\bn\de S
            =\iint_{S_2}\bomega\cdot\bn\de S
            -\iint_{S_1}\bomega\cdot\bn\de S
            =0.
          </me>
          and this was true for any choice of <m>S_1</m> and <m>S_2</m>.
          Hence, <m>\Gamma</m> is the
          same for all cross-sections of a vortex tube.
        </p>
        <p>
          <em>Proof of the second vortex theorem (continued).
          Proof that <m>\Gamma</m> is independent of time.</em>
          To prove that <m>\Gamma</m> is independent of time, we note that, since the
          vortex lines move with the fluid, the vortex tube also moves with the fluid,
          being composed of vortex lines, and the same vortex lines lie on the surface
          and are enclosed within the vortex tube for all time.
        </p>
        <p>
          Moreover,
          <me>
            \Gamma=\iint\omega\cdot\bn\de S
            =\oint\bu\cdot\de\bx
          </me>
          by Stokes' theorem, which is the circulation around the boundary of <m>S</m>.
          As the tube evolves, the material surface <m>S</m> moves with the vortex tube.
          By Kelvin's circulation theorem <xref ref="thm-kelvin-circulation-theorem"/>, <m>\Gamma</m> remains
          independent of <m>t</m>.
        </p>
      </proof>
      <remark>
        <p>
          The second theorem shows us that if a vortex tube becomes stretched
          then by mass conservation, it must get thinner.
          The flux of vorticity along the vortex tube is given by
          <m>\Gamma=\int_S\bomega\cdot{\bn}\,dS</m>, and this must remain constant,
          and therefore, since the area of the cross-section <m>S</m> is decreasing,
          the magnitude of vorticiy  <m>\bomega</m> must increase in the tube.
          This is <em>spin up</em>.
          Conversely, if a vortex tube becomes shorter,
          we get the opposite effect of <em>spin down</em>
          and <m>\bomega</m> gets smaller.          
        </p>
        <p>
          A non-fluids example of the same principle can be seen when dancers perform
          moves involving spins,
          especially ice skaters,
          the dance starts rotating with their arms or legs out, and
          then they pull in to speed up the spin.
        </p>
      </remark>
      <example xml:id="ex-spinup-spindown">
        <title>Everyday examples of spin up and spin down</title>
        <sidebyside>
          <figure xml:id="fig-spinup">
            <caption>Spin up of vorticity as thunderclouds move overhead.</caption>
            <image source="ch-chapter06-spinup.jpg" width="50%">
              <shortdescription>Spin up</shortdescription>
            </image>
          </figure>
          <figure xml:id="fig-spindown">
            <caption>Spin down of a cup of tea. Secondary circulations (shown by the arrows)
              tend to spread the material lines out radially.
              Thus the tall thin column of fluid (a) becomes a short fat one(b).</caption>
            <image source="ch-chapter06-spindown.jpg" width="50%">
              <shortdescription>Spin up</shortdescription>
            </image>
          </figure>
        </sidebyside>
        <p>
          The two sketches in <xref ref="fig-spinup"/> and <xref ref="fig-spindown"/>
          (taken from <xref ref="ref-acheson"/>)
          show examples of spin up and spin down, respectively.
          Spin up occurs in thunderstorms; as the cloud moves, the vortex lines get stretched,
          and this can result in a tornado. Spin up happens in a cup of tea after it has been stirred.
          Secondary flows in the cup tend to spread the column of rotating fluid horizontally,
          making the area of the cross-section of the vortex tube bigger,
          and hence the vorticity smaller, which is spin down.
        </p>
        <p>
          There is a nice video of a
          <url href="https://www.instagram.com/reel/DLfUkDxuxmR/?hl=en" visual="tornado">tornado on Instagram</url>.
          Due to the fast flow in the tornado, the pressure in the core is very low
          (this is an application of Bernoulli's equation), and water condenses out of the air,
          making the tornado visible.
        </p>
      </example>
      <example xml:id="ex-plughole-vortex">
        <title>Plug hole vortex</title>
        <p>
          We saw the vortex that forms around a plug hole in the movie `Vorticity, Part 1’
          at
          <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>.
        </p>
        <p>
          The presenter commented that the angular momentum of a fluid parcel
          remains constant.
          Using angular momentum equals velocity times distance from axis, this implies
          the angular velocity is proportial to the inverse of the radial distance.
          This is precisely the 
        </p>
        <p>
          In it, we saw a reference to `Crocco's theorem', which can be derived from
          the derivation of Bernoulli's equation <xref ref="eqn-bernoulli-vorticity"/>:
          <me>
            \pd{\bu}{t} + \bomega \times \bu = -\nabla B,
          </me>
          where
          <me>
            B = \frac{p}{\rho} + \frac{1}{2} |\bu|^2 + \chi,
          </me>
          with
          <me>
            \bg = -\nabla \chi.
          </me>
        </p>
        <p>
           Noting that this flow is steady and has zero vorticity away from the plughole,
          we must have <m>\bnabla B=0</m>, that is <m>B</m> is constant everywhere.
          On the surface, we have <m>p=p_{\mathrm{atm}}</m> and hence
          <m>|\bu|^2/2 + gz</m> is constant, where <m>z</m> is vertical height. Using
          <xref ref="eq-u-line-vortex"/>, the speed is <m>\Gamma/(2\pi r)</m>. Hence,
          the quantity
          <me>
            \frac{\Gamma^2}{8\pi^2r^2}+gz
          </me>
          is constant, that is
          <me>
            z=z_0-\frac{\Gamma^2}{8\pi^2gr^2},
          </me>
          thus explaining the shape of the surface that was seen.
        </p>
      </example>
      <example>
        <title>Tornado</title>
        <p>
          As commented in the `Vorticity, Part 2’
          at
          <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>,
          the pressure in the middle of a tornado is very low.
          This can also be understood from Bernoulli's equation
          <xref ref="eqn-bernoulli-vorticity"/>:
          <me>
            \pd{\bu}{t} + \bomega \times \bu = -\nabla B,
          </me>
          with
          <me>
            B = \frac{p}{\rho} + \frac{1}{2} |\bu|^2 + \chi.
          </me>
          In the steady case, and outside the vortex core, there is no
          vorticity and hence <m>B</m> is constant, meaning that,
          as we approach the vortex core, the pressure decreases as the
          fluid speed increases. Furthermore, in the vortex core where the vorticity
          is non-zero, the quantity
          <m>\bomega \times \bu</m> points towards the axis. Thus <m>B</m>
          decreases as the axis is approached, further decreasing the pressure.
        </p>
        <p>
          This pressure reduction leads to condensation in the core of the tornado,
          and this is visible, allowing us to see the tornado, and, to some extent,
          visualise the intense air flows associated with it.
        </p>
        <p>
          As commented, in propellors of boats,
          this pressure reduction in the core of a vortex can cause
          the water to boil!
        </p>
      </example>
    </subsection>
    <subsection xml:id="helmholtz-principle">
      <title>The Helmholtz principle</title>
      <remark>
        <title>Recap of line vortex</title>
        <p>
          The Helmholtz vertex theorems help us to understand the concept of a
          line vortex in irrotational flow that was introduced in
          <xref ref="example-streamfunction-linevortex"/>. Recall that this
          is associated with the complex potential
          <me>
            f(z) = -\frac{\im \Gamma}{2\pi} \log z.
          </me>
          (see <xref ref="eq-line-vortex-complex-potential"/>), and has corresponding velocity components
          <me>
            u = -\frac{\Gamma y}{2\pi(x^2+y^2)},\quad
            v = \frac{\Gamma x}{2\pi(x^2+y^2)}.
          </me>
          The vorticity associated with this flow <m>\bomega=\bzero</m> at all
          points except the singularity at the origin.
          However, it was also notes in <xref ref="eq-line-vortex-circulation"/>
          that the circulation around any closed curve containing the
          origin is <m>\Gamma</m>.
        </p>
        <p>
          Thus, a line vortex of strength <m>\Gamma</m> is the limit of a
          vortex tube of strength <m>\Gamma</m> as its thickness goes to zero.
        </p>
        <p>
          We note that in any real fluid, the effects of viscosity would come into play
          in the core of the line vortex, disallowing an infinite concentration of vorticity
          there. Despite this, we can use the concept of a line vortex to gain insight
          into a number of real-world problems.
        </p>
      </remark>
      <p>
        The following corollary is a useful application of the Helmholtz vortex theorems.        
      </p>
      <corollary xml:id="cor-vortex-movement">
        <title>The Helmholtz principle</title>
        <statement>
          <p>
            A useful corollary to the Helmholtz vortex theorems
            <xref ref="thm-helmholtz-vortex-theorems"/> is capture by the following statement:
            `A line vortex moves with the velocity field due to everything except itself.'
          </p>
        </statement>
      </corollary>
      <proof>
        <p>
          A flow with a line vortex has an infinite concentration of vortex lines
          along the axis of the line vortex. By the first vortex theorem
          <xref ref="thm-helmholtz-vortex-theorems"/>, these are frozen in the fluid,
          and thus evolve with the background flow with the line vortex removed.
        </p>
      </proof>
      <remark xml:id="rem-helmholtz-application">
        <title>Application of the Helmholtz principle</title>
        <p>
          In the case of a two-dimensional flow containing a line vortex that is everywhere irrotational
          (apart from in the line vortex core), we can use the Helmholtz principle to
          find the motion of the line vortex. In particular, to find the evolution of the flow
          we can make use of the
          following techniques that were covered in <xref ref="ch-chapter04-potentialflows"/>:
          <ul>
            <li>
              <p>
                the method of images <xref ref="sec-method-of-images"/>, and
              </p>
            </li>
            <li>
              <p>
                conformal mapping <xref ref="sec-conformal-mapping"/>.
              </p>
            </li>
          </ul>
        </p>
      </remark>
      <example>
        <title>Vortex pair</title>
        <p>
          We assume two-dimensional flow, and consider the evolution of two line vortices
          of equal and opposite strengths initially a distance <m>2d</m> apart at locations
          <m>(x,y)=(\pm d,0</m> with the vortex at <m>(d,0)</m> having strength <m>\Gamma</m>
          and that at <m>(-d,0)</m> having strength <m>-\Gamma</m>.
        </p>
        <p>
          The vortex at <m>(d,0)</m> will move under the influence of that at <m>(-d,0)</m>
          with speed <m>\Gamma/(4\pi d)</m> in the <m>-y</m>-direction. Similarly, the vortex
          <m>(-d,0)</m> will also move
          with speed <m>\Gamma/(4\pi d)</m> in the <m>-y</m>-direction.
          Since their separation remains constant, the two vortices will continue to move at
          a constant speed <m>\Gamma/(4\pi d)</m> in the <m>-y</m>-direction.
        </p>
        <p>
          In the frame of reference moving with the vortices, there is a uniform flow
          <m>\Gamma/(4\pi d)</m> in the <m>+y</m>-direction and the flow due to
          each of the vortices.
          The complex potential is the sum of the complex potentials due to these three elements:
          <me>
            f=-\frac{\im \Gamma z}{4\pi d}
            -\frac{\im \Gamma}{2\pi}\log\left(z-d\right)
            +\frac{\im \Gamma}{2\pi}\log\left(z+d\right).
          </me>
          The streamfunction is the imaginary part of this:
          <md>
            <mrow>
              \psi=&amp;-\frac{\Gamma x}{4\pi d}
              -\frac{\Gamma}{2\pi}\log\left|z-d\right|
              +\frac{\Gamma}{2\pi}\log\left|z+d\right|
            </mrow>
            <mrow>
              =&amp;-\frac{\Gamma}{4\pi}\left(\frac{x}{d}+2\log\left|\frac{z-d}{z+d}\right|\right)
            </mrow>
            <mrow>
              =&amp;-\frac{\Gamma}{4\pi}\left(\frac{x}{d}+\log\left(\frac{(x-d)^2+y^2}{(x+d)^2+y^2}\right)\right).
            </mrow>
          </md>
        </p>
        <p>
          To help with plotting the streamfunction, we note that:
          <ul>
            <li>
              <p>
                The derivative of the complex potential is
                <me>
                  f'=-\frac{\im\Gamma}{4\pi}\left(\frac1d+\frac{2}{z-d}-\frac{2}{z+d}\right),
                </me>
                which equals zero at the points <m>z=\pm\sqrt{3}\im d</m>,
                so these are stagnation points of the flow.
              </p>
            </li>
            <li>
              <p>
                We have <m>\psi=0</m> on the line <m>x=0</m>, so this is a streamline.
              </p>
            </li>
            <li>
              <p>
                Far from the vortices (in any direction), the streamfunction is approximately
                <m>\psi\sim-\Gamma x/(4\pi d)</m>, so the streamlines are approximately vertical lines.
              </p>
            </li>
            <li>
              <p>
                As we approach the vortex at <m>z=d</m>, <m>\psi</m> tends to <m>-\infty</m> and 
                as we approach the vortex at <m>z=-d</m>, <m>\psi</m> tends to <m>+\infty</m>.
              </p>
            </li>
          </ul>
        </p>
        <p>
          These points imply that there is a curve on which <m>\psi=0</m> in the right-half plane.
          This curve joins the two stagnation points and goes around the vortex.
          Similarly, there is a curve on which <m>\psi=0</m> in the left-half plane, and
          these two curves are reflections of one another.
        </p>
        <p>
          If we dye the fluid within these two curves, we would create a blob of fluid surrounding the
          vortices. An observer would see this blob of fluid travelling at the speed
          <m>\Gamma/(4\pi d)</m> in the <m>-y</m>-direction without changing shape.
        </p>
      </example>
      <example>
        <title>Vortex near a wall</title>
        <statement>
          <p>
            Consider a vortex of strength <m>\Gamma</m> at a distance <m>d</m> from a flat wall.
          </p>
        </statement>
        <solution>
          <p>
            This can be analysed using the method of images,
            and we put an image vortex a distance <m>d</m> on the other side of the wall,
            directly opposite the real vortex, also of strength <m>-\Gamma</m>.
            Then the problem is equivalent to that of two vortices in free space,
            and we can use the result from the previous example to find the motion of the vortex.            
          </p>
        </solution>
      </example>
      <example xml:id="ex-wing-tip-vortices">
        <title>Example: Wing tip vortices</title>
        <statement>
          <p>
            (From Exercise 5.8 in <xref ref="ref-acheson"/>).
            An inviscid fluid occupies the region <m>x,y\geq0</m>, and is bounded by
            rigid boundaries at <m>x=0</m> and at <m>y=0</m>. Its motion results wholly
            from the presence of a line vortex of strength <m>\Gamma</m>.
            Show that the path taken by the vortex is
            <me>
              \frac1{x^2}+\frac1{y^2}=\mathrm{constant}.
            </me>
          </p>
          <p>
            At take-off, an aircraft generates strong vortices shed from the tips of
            its wings, see <xref ref="fig-wingtip-vortices"/>.
            These are observed to move downwards and outwards under each other's influence.
          </p>
        </statement>
        <solution>
          <p>
            Suppose the vortex is at the point
            <me>
              z_1=x_1+\im y_1.
            </me>
            We use three image vortices at <m>x_1-\im y_1</m> and at <m>-x_1+\im y_1</m>,
            both of strength <m>-\Gamma</m>, and at <m>-x_1-\im y_1</m> of strength
            <m>\Gamma</m>.
          </p>
          <p>
            Recall that the complex potential of a line vortex at <m>z=c</m>
            of strength <m>\Gamma</m> is <m>-\im\Gamma\log(z-c)/(2\pi)</m> and
            its velocity is given by the derivative of this map:
            <m>u-\im v=-\im\Gamma/(2\pi(z-c))</m>.
          </p>
          <p>
            The velocity of the vortex is given by the sum of the velocities due to
            the other three vortices:
            <md>
              <mrow>
                \dd{x_1}{t}-\im\dd{y_1}{t}
                =&amp;\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(x_1-\im y_1))}
              </mrow>
              <mrow>
                &amp;+\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(-x_1+\im y_1))}
              </mrow>
              <mrow>
                &amp;-\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(-x_1-\im y_1))}
              </mrow>
              <mrow>
                &amp;=\frac{\im\Gamma}{4\pi}\left(\frac1{x_1}+\frac1{\im y_1}-\frac1{x_1+\im y_1}\right).
              </mrow>
            </md>
            Hence
            <md>
              <mrow>
                \dd{x_1}{t}
                =\frac{\Gamma}{4\pi}\left(\frac1{y_1}-\frac{y_1}{x_1^2+y_1^2}\right)
                =\frac{\Gamma x_1^2}{4\pi y_1(x_1^2+y_1^2)},
              </mrow>
              <mrow>
                \dd{y_1}{t}
                =\frac{\Gamma}{4\pi}\left(-\frac1{x_1}+\frac{x_1}{x_1^2+y_1^2}\right)
                =-\frac{\Gamma y_1^2}{4\pi x_1(x_1^2+y_1^2)},
              </mrow>
            </md>
            and therefore
            <me>
              \dd{y_1}{x_1}=-\frac{y_1^3}{x_1^3},
            </me>
            which can be solved by separation of variables to give
            <me>
              \int\frac1{y_1^3}\de y_1=-\int\frac1{x_1^3}\de x_1
              \quad\Rightarrow\quad
              -\frac1{2y_1^2}=\frac1{2x_1^2}+c,
            </me>
            where <m>c</m> is constant, and this can be rearranged into the required form.
          </p>
        </solution>
      </example>
      <example>
        <title>Application to airports</title>
        <p>
          At a busy airport, a delay is required between the take off of one aircraft and the next
          in order for the wing tip vortices generated from the take off of the first
          aircraft to move away and break up.
          The time required for this to happen depends on the size and speed of the aircraft,
          as well as the angle of attack of the wings, but it is typically 2 or 3 minutes.
          This need for a delay is the main reason that a given airport runway can only
          take so many aeroplanes
          per day, limiting the flight volume of the airport.
        </p>
        <p>
          You will have heard recent debate about the controversy surrounding
          the building of a third
          runway at London Heathrow, the busiest airport in the UK.
          Although not explained by the media coverage, you now understand the
          crucial role played by the fluid dynamics that underlies these arguments!
        </p>
      </example>
    </subsection>
  </section>
  <section xml:id="sec-axisymmetric-flow">
    <title>Axisymmetric flow</title>
    <introduction>
      <p>
        In the special case in which the flow possesses axisymmetry,
        you might not be surprised to learn that the equations simplify considerably.
        In fact, axisymmetry can be viewed as a reduction of the dimension
        of the problem and axisymmetric flows share some features in common with
        two-dimensional flows.
      </p>
      <definition>
        <title>Axisymmetric flow</title>
        <statement>
          <p>
            Given an axis of symmetry, an axisymmetric flow must possess:
            <ul>
              <li>
                <p>
                  rotational symmetry about the axis, meaning the flow is unaffected by a
                  rotation through any angle about the axis, and
                </p>
              </li>
              <li>
                <p>
                  reflectional symmetry in any plane containing the axis.
                </p>
              </li>
            </ul>
          </p>
        </statement>
      </definition>
      <remark>
        <p>
          Note that rotationally symmetric flows are not in general axisymmetric.
          Working in cylindrical polar coordinates <m>(r,\theta.z)</m>
          centred on the axis of symmetry,
          any flow that is independent of <m>\theta</m> is rotationally symmetric.
          In order to have the stronger property of being axisymmetric,
          the flow must also satisfy <m>u_{\theta}=0</m>.
        </p>
        <p>
          A flow <m>\bu=f(r,z,t)\be_{\theta}</m> is rotationally symmetric but not axisymmetric,
          for example a line vortex <xref ref="example-streamfunction-linevortex"/>.
        </p>
      </remark>
    </introduction>
    <subsection xml:id="subsec-stokes-streamfunction">
      <title>The Stokes streamfunction for axisymmetric flow</title>
      <definition xml:id="def-stokes-streamfunction">
        <title>The Stokes streamfunction</title>
        <statement>
          <p>
            In cylindrical polar coordinates, <m>(r,\theta.z)</m>,
            we define the Stokes streamfunction <m>\Psi(r,z,t)</m> by
            <men xml:id="eq-stokes-streamfunction-cylindrical">
              \bu = \nabla \times \left(\frac{\Psi}{r}\be_{\theta}\right),
            </men>
            and in spherical polar coordinates, <m>(r,\theta.\phi)</m>,
            we define <m>\Psi(r,\theta,t)</m> by
            <men xml:id="eq-stokes-streamfunction-spherical">
              \bu = \nabla \times \left(\frac{\Psi}{r\sin\theta}\be_{\phi}\right).
            </men>
          </p>
        </statement>
      </definition>
      <remark>
        <p>
          Note that you would be given the formula for gradient, divergence and curl in
          cylindrical or spherical polar coordinates.
        </p>
      </remark>
      <remark>
        <p>
          The definitions <xref ref="eq-stokes-streamfunction-cylindrical"/>
          in cylindrical polar coordinates and <xref ref="eq-stokes-streamfunction-cylindrical"/>
          in spherical polar coordinates are equivalent since <m>\be_{\theta}/r</m> in
          cylindrical polar coordinates and <m>\be_{\phi}/(r\sin\theta)</m> in
          spherical polar coordinates are equal to each other.
        </p>
      </remark>
      <remark>
        <p>
          Recall the streamfunction for two-dimensional flow that was introduced in
          <xref ref="sec-streamfunction"/>:
          <me>
            \bu = \nabla \times (\psi \bk).
          </me>
        </p>        
      </remark>
      <remark>
        <p>
          In cylindrical polar coordinates,
          if we had written <m>\bu=\nabla\times\psi'\be_{\theta}</m>
          instead of <xref ref="eq-stokes-streamfunction-cylindrical"/>,
          we would find that <m>\psi'</m> is inversely proportional to <m>r</m>
          on streamlines (instead of being constant).
          This is why it is defined with the factor <m>1/r</m> before taking the curl.
          Similar considerations apply in spherical polar coordinates.
        </p>
      </remark>
      <remark>
        <p>
          The velocity components corresponding to the definitions
          <xref ref="def-stokes-streamfunction"/> are
          in cylindrical polar coordinates
          <men xml:id="streamfunction-velocity-cylindricals">
            u_r=-\frac1r\pd{\Psi}{z},\quad
            u_z=\frac1r\pd{\Psi}{r},
          </men>
          and in cylindrical polar coordinates
          <men xml:id="streamfunction-velocity-sphericals">
            u_r=\frac1{r^2\sin\theta}\pd{\Psi}{\theta},\quad
            u_{\theta}=-\frac1{r\sin\theta}\pd{\Psi}{r}.
          </men>
        </p>
      </remark>
      <theorem xml:id="thm-Stokes-streamfunction-streamlines">
        <title>The Stokes streamfunction is constant along streamlines</title>
        <statement>
          <p>
            The Stokes streamfunction, as defined by <xref ref="eq-stokes-streamfunction-cylindrical"/>
            or <xref ref="eq-stokes-streamfunction-cylindrical"/>, is constant along streamlines.
          </p>
        </statement>
      </theorem>
      <proof>
        <p>
          Since the definitions in cylindrical and spherical coordinates are equivalent, it suffices
          to prove the theorem in spherical coordinates. In this case,
          <me>
            \bu\cdot\nabla\Psi
            =u_r\pd{\Psi}{r}+\frac{u_{\theta}}r\pd{\Psi}{\theta}
          </me>
          and, substituting the velocity components <xref ref="streamfunction-velocity-sphericals"/>,
          this equals zero. Hence <m>\Psi</m> is constant along streamlines.
        </p>
      </proof>
    </subsection>
    <subsection xml:id="subsec-streamfunction-vorticity">
      <title>Relationship to vorticity</title>
      <p>
        In cylindrical polar coordinates, the vorticity is given by
        <men>
          \bomega=\omega\be_{\theta}
        </men>
        where
        <men xml:id="eq-axisym-vorticity-cylindricals">
          \omega=-\frac1r\left(r\pd{}{r}\left(\frac1r\pd{\Psi}{r}\right)+\pd{^2\Psi}{z^2}\right).
        </men>
        In spherical polar coordinates, the vorticity is
        <men>
          \bomega=\omega\be_{\phi}
        </men>
        where
        <men xml:id="eq-axisym-vorticity-sphericals">
          \omega=-\frac1{r\sin\theta}\left(\pd{^2\Psi}{r^2}+\frac{\sin\theta}{r^2}\pd{}{\theta}\left(\frac1{\sin\theta}\pd{\Psi}{\theta}\right)\right).
        </men>
        Note that the two expressions for <m>\omega</m> are equivalent, since <m>\be_{\theta}</m>
        in cylindricals equals <m>\be_{\theta}</m> in spherical polar coordinates.      </p>
      <p>
        In cylindrical polar coordinates, the vorticity equation for axisymmetric flow is
        <men xml:id="eq-vorticity-cylindricals">
          \DD{}{t}\left(\frac{\omega}{r}\right)=0,
        </men>
        and in sphericals it is
        <men xml:id="eq-vorticity-sphericals">
          \DD{}{t}\left(\frac{\omega}{r\sin\theta}\right)=0.
        </men>
      </p>
      <example xml:id="ex-smoke-rings">
        <title>Smoke rings</title>
        <p>
          In <xref ref="ex-axisymmetric-flow"/> you are asked to prove a formulation of the
          vorticity equation <xref ref="eqn-vorticity-equation-lagrange"/>
          in the special case of axisymmetric flow. Note that, in this case,
          the vorticity points purely in the azimuthal direction.
        </p>
        <p>
          A smoke ring is an example of an axisymmetric flow with vorticity, see 6:44-7:53 of
          <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">Vorticity Part 2</url>.
          We may think of the flow as being everywhere irrotational, except in the smoke ring,
          with the smoke ring itself representing a vortex tube.
        </p>
        <p>
          As a ring gets wider, conservation of mass implies the vortex tube gets thinner
          inversely proportional to the distance from the axis,
          and the second Helmholtz vortex theorem implies the vorticity must increase
          in proportion to distance from the axis so that
          the circulation remains constant. In <xref ref="ex-axisymmetric-flow"/>
          you will show that, in cylindrical polar coordinates,
          <me>
            \DD{}{t}\left(\frac{\omega}{r}\right)=0,
          </me>
          which expresses the same result: the vorticity <m>\omega</m> increases in
          proportion to distance from axis <m>r</m>.
        </p>
        <p>
          Note also that, as commented in the movie, the smoke ring
          self-propates. This is another application of the Helmholtz principle, as follows.
          If we consider a part of the ring, it is subject to the velocity field arising
          from all the other parts of the ring. All these parts contribute to a forward
          motion, and this is true for all parts of the ring.
        </p>
      </example>
    </subsection>
    <subsection xml:id="subsec-irrot-sphere">
      <title>Irrotational flow past a sphere</title>
      <p>
        We consider a sphere of radius <m>a</m> travelling at a constant speed <m>U</m> through
        a large reservoir of fluid and find the velocity field. We assume the sphere has been
        travelling for long enough that the flow in a frame of reference moving with the sphere is steady.
      </p>
      <p>
        <em>Proof that the flow is irrotational:</em>
        We work in spherical polar coordinates in the frame of reference moving with the sphere and solve 
        <xref ref="eq-vorticity-sphericals"/> to find the Stokes streamfunction.
        Steady flow implies the simplification
        <me>
          \bu\cdot\nabla\left(\frac{\omega}{r\sin\theta}\right)=0,
        </me>
        which means that <m>\omega/(r\sin\theta)</m> is constant along streamlines.
        As long as there are no closed streamlines, meaning that all streamlines
        originate at infinity where <m>\omega</m> is zero, then <m>\omega</m>
        must be zero everywhere and the flow is irrotational.
      </p>
      <p>
        Setting the vorticity to zero and using the expression
        <xref ref="eq-axisym-vorticity-sphericals"/>, we have to solve
        <men xml:id="eq-sphere-irrotational-eq1">
          \pd{^2\Psi}{r^2}
          +\frac{\sin\theta}{r^2}\pd{}{\theta}\left(\frac1{\sin\theta}\pd{\Psi}{\theta}\right)=0
        </men>
      </p>
      <p>
        As <m>r\rightarrow\infty</m>, we require
        <me>
          u_r\sim-U\cos\theta,\quad
          u_{\theta}\sim U\sin\theta.
        </me>
        Using the expressions given in <xref ref="streamfunction-velocity-sphericals"/>,
        these conditions are equivalent to
        <men xml:id="eq-sphere-irrotational-eq2">
          \Psi\sim-\frac12Ur^2\sin^2\theta
        </men>
        as <m>r\rightarrow\infty</m>.
      </p>
      <p>
        This suggests trying
        <me>
          \Psi=f(r)\sin^2\theta.
        </me>
        We substitute this into <xref ref="eq-sphere-irrotational-eq1"/>,
        and find that it is a solution provided that
        <me>
          f''-\frac{2f}{r^2}=0,
        </me>
        which means that
        <me>
          f=Ar^2+\frac{B}{r},
        </me>
        where <m>A</m> and <m>B</m> are constants of integration.
      </p>
      <p>
        We need to satisfy the condition at infinity <xref ref="eq-sphere-irrotational-eq2"/>
        which gives <m>f\sim Ur^2/2</m> as <m>r\rightarrow\infty</m>,
        and no penetration at the surface of the sphere, which,
        using <xref ref="streamfunction-velocity-sphericals"/>,
        is equivalent to <m>f=0</m> at <m>r=a</m>.
      </p>
      <p>
        These boundary conditions can be satified by the choice <m>A=U/2</m>, <m>B=-Ua^2/2</m>,
        and we have
        <me>
          \Psi=-\frac12U\left(r^2-\frac{a^3}{r}\right)\sin^2\theta.
        </me>
        This can be used to sketch the streamlines.
      </p>
      <p>
        If required, we can use <xref ref="streamfunction-velocity-sphericals"/>
        to find the velocity components
        <me>
          u_r=-U\left(1-\frac{a^3}{r^3}\right)\cos\theta,\quad
          u_{\theta}=U\left(1+\frac{a^3}{2r^3}\right)\sin\theta.
        </me>
      </p>
      <remark>
        <title>Alternative method to find the flow using the velocity potential</title>
        <p>
          Note that we could also use the velocity potential
          <xref ref="theorem-irrotational-potential"/>
          to solve this problem. In this case we assume the flow is irrotational to start with.
        </p>
        <p>
          Again we work in spherical polar coordinates moving at speed <m>U</m>
          with the sphere with the axis pointing in the direction of travel and assume
          the flow is axisymmetric.
          Writing <m>/bu=\nabla\phi</m>, where <m>\phi</m> is the potential,
          the flow is governed by the Laplace equation:
          <me>
            \frac1{r^2}\pd{}{r}\left(r^2\pd{\phi}{r}\right)
            +\frac1{r^2\sin\theta}\pd{}{\theta}\left(\sin\theta\pd{\phi}{\theta}\right)=0.
          </me>
          We solve this equation subject to boundary conditions of no penetration at <m>r=a</m>
          and assume that, far from the sphere, the flow is <m>-U</m> along the axis:
          <ul>
            <li>
              <p>
                No penetration at the sphere's surface implies that <m>{\bf u}\cdot{\bf n}=0</m> there.
                So <m>u_r=\pd{\phi}{r}=0</m>.
              </p>
            </li>
            <li>
              <p>
                That the flow tends to <m>-U</m> implies that <m>u_r\rightarrow-U\cos\theta</m>
                and <m>u_\theta\rightarrow U\sin\theta</m> as <m>r\rightarrow\infty</m>.
                That is, <m>\pd{\phi}{r}\rightarrow-U\cos\theta</m> and
                <m>\pd{\phi}{\theta}\rightarrow rU\sin\theta</m>.
              </p>
            </li>
          </ul>
        </p>
        <p>
          The boundary conditions as <m>r\rightarrow\infty</m> suggest trying
          <m>\phi=f(r)\cos\theta</m>, and, with this assumption, Equation~\eqref{eq:laplacephisimp} becomes
          <me>
            \pd{^2f}{r^2}+\frac2r\pd{f}{r}-\frac{2f}{r^2}=0.
          </me>
          Trying <m>f=r^\alpha</m> yields <m>\alpha=1</m> or~<m>-2</m>. Thus
          <me>
            \phi=\left(Ar+\frac{B}{r^2}\right)\cos\theta,
          </me>
          and the boundary conditions at <m>r=a</m> imply <m>A-2B/a^3=0</m>,
          and those as <m>r\rightarrow\infty</m> imply <m>A=-U</m>. Thus <m>A=-U</m> and <m>B=-Ua^3/2</m>,
          <me>
            \phi=-Ur\left(1+\frac{a^3}{2r^3}\right)\cos\theta,
          </me>
          and
          <me>
            u_r=\pd{\phi}{r}=-U\left(1-\frac{a^3}{r^3}\right)\cos\theta,\quad
            u_\theta=\frac1r\pd{\phi}{\theta}=U\left(1+\frac{a^3}{2r^3}\right)\sin\theta.
          </me>
          This solution has the correct form as <m>r\rightarrow\infty</m>, and
          at the surface of the sphere. It also agrees with the velocity field calculated
          using the streamfunction method.
        </p>
      </remark>
      <remark>
        <p>
          At the spherical surface <m>r=a</m>, we have the velocity
          <m>u_\theta=(3U/2)\sin\theta</m>.
          In practical terms, the large pressure gradients created by this flow
          would lead to <em>boundary layer separation</em>, and a large wake behind the sphere.
        </p>
      </remark>
      <remark>
        <p>
          In <xref ref="sec-low-Reynolds-number-sphere"/> we will calculate the flow past a sphere in a
          low-Reynolds-number flow.
        </p>
      </remark>
    </subsection>
  </section>

  <section xml:id="sec-ncfmf-vorticity-films">
    <title>National Committee for Fluid Mechanics Films: Vorticity Parts 1 and 2</title>
    <introduction>
      <p>
        The excellent fluid dynamics films produced by the
        <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">National Committee for Fluid Mechanics Films</url>
        include two films on vorticity.
        These are available to view online at the above link.
        Please watch both films, and use the notes below to guide your viewing.
      </p>
      <p>
        If you are short of time, you may watch the Part 1 up to 18'35''
        and then watch Part 2 from 3'00'' to 13'25'' and 17'25'' to the end,
        as these parts relate most strongly to the material in this course.
        However, it is recommended that you watch both films in their entirety
      </p>
    </introduction>
    <subsection xml:id="subsec-vorticity-part-1">
      <title>Vorticity Part 1</title>
      <p>
        Here is a list of points to look out for while watching Vorticity Part 1:
        <ul>
          <li>
            <p>
              0'0'': The film starts by defining vorticity, c.f. <xref ref="sec-vorticity"/>.
            </p>
          </li>
          <li>
            <p>
              1'10'': Vortex lines are defined, c.f. <xref ref="sec-vortex-lines"/>.'
            </p>
          </li>
          <li>
            <p>
              2'00'': There is a description of a `vorticity meter',
              which can be used to illustrate the vorticity of various flows.
            </p>
          </li>
          <li>
            <p>
              3'00'': Vorticity in solid body rotation of a fluid
              (a bit like the cup of tea in <xref ref="ex-spinup-spindown"/>).
            </p>
          </li>
          <li>
            <p>
              3'30'': Channel flow. We will study this in <xref ref="ch-viscousflows"/>.
            </p>
          </li>
          <li>
            <p>
              4'30'': Plug hole vortex (<xref ref="ex-plughole-vortex"/>).
              This will nicely illustrate an important concept in this chapter:
              a line vortex <xref ref="example-complexpotential-linevortex"/>.
            </p>
          </li>
          <li>
            <p>
              6'50'': Crocco's theorem applied to the channel flow.
              The theorem as presented is related to the Bernoulli equation
              <xref ref="sec-bernoulli"/>. This section is beyond the scope of this course.
            </p>
          </li>
          <li>
            <p>
              9'20'': Back to the plughole vortex.
              We will derive an equation for the surface profile, the 'hyperboloid'.
              There is also a really nice illustration that the vorticity is zero everywhere
              except on the axis of the vortex, where it is infinite (in an ideal fluid).
            </p>
          </li>
          <li>
            <p>
              11'10'': Definition of the circulation, c.f. <xref ref="sec-circulation"/>,
              and Kelvin's circulation theorem,
              c.f. <xref ref="thm-kelvin-circulation-theorem"/>.
              Several examples of circulation are given, which should help you to conceptualise
              this important quantity, although note that doing calculations on some of these
              (e.g. the developing boundary layer, the creation of a wingtip vortex) is beyond
              the scope of this course.
            </p>
          </li>
          <li>
            <p>
              18'15'': Vorticity dissipates due to friction (viscosity).
              Viscosity is a way of describing the internal friction in the fluid and will be studied
              in <xref ref="ch-viscousflows"/>.
            </p>
          </li>
          <li>
            <p>
              18'35'': This section of the film describes Kelvin's circulation theorem
              in the presence of a non-conservative body force.
              They consider the Coriolis force due to the Earth's rotation;
              this has only a small effect on scales of a few metres, but a big effect on
              long lengthscales such as occur in atmosphere and ocean dynamics,
              so it is important in weather forecasting).
              in more detail than we do it in this course, so this is non-examinable.
              However, it is worth watching to get a better understanding of the theorem
              and fluid dynamics in general.
            </p>
          </li>
        </ul>
      </p>
    </subsection>
    <subsection xml:id="subsec-vorticity-part-2">
      <title>Vorticity Part 2</title>
      <p>
        Here is a list of points to look out for while watching Vorticity Part 2:
        <ul>
          <li>
            <p>
              0'0'': The film starts by continuing to discuss Kelvin's circulation theorem,
              this time in the case of non-constant density.
              Again, this is beyond the scope of this course, although watching this will
              help you to understand the subject better.
            </p>
          </li>
          <li>
            <p>
              3'00'': Aerofoils and how they generate lift. This is at a higher level than
              most of the material on this course, so if you can follow it, it will really
              help your understanding of circulation and vorticity.
            </p>
          </li>
          <li>
            <p>
              5'15'': Helmholtz's vortex laws are introduced,
              As mentioned in the lecture, these are equivalent to the theorems we had
              <xref ref="thm-helmholtz-vortex-theorems"/>.
            </p>
          </li>
          <li>
            <p>
              6'45'': Smoke rings, see <xref ref="ex-smoke-rings"/>.
              This should be understandable.
              It also includes a verbal description of the image vortex,
              c.f. <xref ref="rem-helmholtz-application"/>.
            </p>
          </li>
          <li>
            <p>
              7'55'': Wingtip vortices are described.
            </p>
          </li>
          <li>
            <p>
              8'55'': Another vorticity meter is introduced
              and initially used to measure wingtip vortices.
            </p>
          </li>
          <li>
            <p>
              9'40'': Application to propellors.
            </p>
          </li>
          <li>
            <p>
              10'25'': Application to flying birds.
            </p>
          </li>
          <li>
            <p>
              11'20'': Vortex stretching, see <xref ref="ex-spinup-spindown"/>,
              which includes a description of a figure skater, as mentioned in the lecture.

              At 4:00, the second Helmholtz vortex theorem is described.
              This states that the strength of a vortex tube is constant along its length
              and in time.
              Note that this is a direct consequence of the vorticity equation
              <xref ref="eqn-vorticity-equation-lagrange"/>.
            </p>
          </li>
          <li>
            <p>
              13'25'': Channel flow around a bend.
              This is beyond the scope of this course,
              although, as with other parts of the film,
              it would help your understanding to watch it.
              It also includes a description of secondary flow,
              both in a channel bend, such as a river,
              and in a closed pipe bend, such as an artery.
            </p>
          </li>
          <li>
            <p>
              17'25'': Another example of vortex line stretching,
              see <xref ref="ex-spinup-spindown"/>.
            </p>
          </li>
          <li>
            <p>
              18'20'': Generation of vertical vorticity and tornadoes.
              This includes visual explanations of some of the properties
              we discussed in the lecture.
            </p>
          </li>
          <li>
            <p>
              19'55'': Importance of the Coriolis force in
              large-scale atmospheric and oceanic flows.
            </p>
          </li>
        </ul>
      </p>
    </subsection>
  </section>

  <exercises xml:id="ws-vorticity">
    <!--<introduction>
      <warning>
        <p>
          We look to complete worksheets in the week prior to the content being delivered.
          Once this is done, this disclaimer message will be removed.
        </p>
      </warning>
    </introduction>-->

    <exercise xml:id="ex-kelvin-circulation-theorem">
      <title>Kelvin’s Circulation Theorem</title>
      <statement>
        <p>
          The circulation <m>\Gamma</m> around a closed curve <m>C(t)</m> is defined by
          <me>
            \Gamma = \oint_{C} \mathbf{u} \cdot \de\mathbf{x}.
          </me>
          By transforming to Lagrangian variables show that <m>\Gamma</m> is independent of <m>t</m>.
          Deduce that a flow that is initially irrotational (i.e. <m>\bomega = 0</m> at <m>t=0</m>)
          remains irrotational for all time.
        </p>
        <p>
          Note that this is a key result: if a flow is initially irrotational,
          it remains so indefinitely and we can introduce a velocity potential
          <m>\phi</m> such that <m>\mathbf{u} = \nabla \phi</m>.
        </p>
      </statement>
      <hint>
        <p>
          <em>Method one:</em> Consider the following diagram.
        </p>
        <figure xml:id="kelvin-circulation-theorem-fig">
          <caption>Curve <m>\Gamma</m> at times <m>t</m> and <m>t+\de t</m>.
            The inset shows the relationship between the two curves.</caption>
          <image source="ch-chapter03-kelvin-circulation.png" width="80%"/>
        </figure>
        <p>
          By definition,
          <men xml:id="eq-ex-kelvin-dGammadt">
            \dd{\Gamma}{t}=\lim_{\de t\rightarrow0}\frac1{\de t}\left(\oint_{C(t+\de t)}\bu\cdot\de\bx-\oint_{C(t)}\bu\cdot\de\bx\right).
          </men>
          We therefore need to write <m>\bu</m> and <m>\de\bx</m> at time <m>t+\de t</m>
          on the curve <m>C(t+\de t)</m> to values at time <m>t</m> on the curve <m>C(t)</m>:
          <md>
            <mrow>
              &amp;\left.\bu\cdot\de\bx\right|_{t+\de t}
            </mrow>
            <mrow>
              =&amp;\bu(\bx+\bu(\bx,t)\de t,t+\de t)\cdot
            </mrow>
            <mrow>
              &amp;\left((\bx+\de\bx+\bu(\bx+\de\bx,t)\de t)-(\bx+\bu(\bx,t)\de t)\right).
            </mrow>
          </md>
        </p>
        <p>
          <em>Method two:</em> We can parametrise <m>C(t)</m> via <m>\bx(s,t)</m>
          for <m>0&lt;x&lt;1</m>
          and rewrite the integral as an integral over the parameter <m>s</m>:
          <me>
            \Gamma=\int_0^1\bu(\bx(s,t),t)\cdot\pd{\bx(s,t)}{s}\de s
          </me>
          Then start from <xref ref="eq-ex-kelvin-dGammadt"/> and simplify.
        </p>
      </hint>
      <solution>
        <p>
          We present two methods.
        </p>
        <p>
          <em>Method one:</em>
        </p>
        <p>
          Assuming a conservative body force <m>-\bnabla\chi</m> per unit volume,
          the Euler equation reads
          <me>
            \DD{\bu}{t}=-\bnabla\left(\frac{p}{\rho}-\chi\right).
          </me>
          We have
          <me>
            \dd{\Gamma}{t}=\lim_{\de t\rightarrow0}\frac1{\de t}\oint_C\left(\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx\right)\de t.
          </me>
          We calculate
          <md>
            <mrow>\left.\bu\cdot\de\bx\right|_{t+\de t}=&amp;\bu(\bx+\bu(\bx,t)\de t,t+\de t)\cdot</mrow>
            <mrow>&amp;\left((\bx+\de\bx+\bu(\bx+\de\bx,t)\de t)-(\bx+\bu(\bx,t)\de t)\right)</mrow>
            <mrow>=&amp;\left(\bu(\bx,t)-\bnabla\left(\frac{p}{\rho}-\chi\right)\de t\right)\cdot\left(\de\bx+(\de\bx\cdot\bnabla)\bu\de t\right)</mrow>
            <mrow>=&amp;\left.\bu\cdot\de\bx\right|_{t}+\left(\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx\right)\de t.</mrow>
          </md>
          Hence
          <md>
            <mrow>\dd{\Gamma}{t}&amp;=\lim_{\de t\rightarrow0}\frac1{\de t}\oint_C\left(\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx\right)\de t</mrow>
            <mrow>&amp;=\oint_C\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx</mrow>
            <mrow>&amp;=\oint_C\bnabla\left(\frac12\bu^2\right)\cdot\de\bx-\bnabla\left(\frac{p}{\rho}+\chi\right)\cdot\de\bx</mrow>
            <mrow>&amp;=\oint_C\bnabla\left(\frac12\bu^2-\frac{p}{\rho}-\chi\right)\cdot\de\bx</mrow>
            <mrow>&amp;=0.</mrow>
          </md>
          The final equality above follows because the line integral of a gradient around a closed curve is zero.
          Thus <m>\Gamma</m> is independent of <m>t</m>.
          If the flow is initially irrotational, then <m>\Gamma=0</m> at <m>t=0</m>
          for any closed curve <m>C(0)</m>, and hence <m>\Gamma=0</m> for all time.
          Since this holds for any closed curve, it follows that <m>\omega=\bnabla\times\bu=0</m> for all time.
        </p>
        <p>
          <em>Method two:</em>
          This can also be proven by parametrising <m>C(t)</m> via <m>\bx(s,t)</m> for <m>0&lt;x&lt;1</m>
          and rewriting the integral as an integral over the parameter <m>s</m>:
          <me>
            \Gamma=\int_0^1\bu(\bx(s,t),t)\cdot\pd{\bx(s,t)}{s}\de s.
          </me>
          Then
          <md>
            <mrow>
              \dd{\Gamma}{t}=
              &amp;\int_0^1
              \left.\pd{}{t}\left(\bu(\bx(s,t),t)\cdot\pd{\bx(s,t)}{s}\right)\right|_s\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1
              \left(\left(\pd{\bu}{t}+\pd{\bx}{t}\cdot\nabla\bu\right)\cdot\pd{\bx}{s}
              +\bu\cdot\pd{^2\bx}{s\partial t}\right)\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1
              \left(\left(\pd{\bu}{t}+\bu\cdot\nabla\bu\right)\cdot\pd{\bx}{s}
              +\bu\cdot\pd{\bu}{s}\right)\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1\left(\DD{\bu}{t}\cdot\pd{\bx}{s}+\frac12\pd{|\bu|^2}{s}\right)\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1\left(-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\pd{\bx}{s}+\frac12\pd{|\bu|^2}{s}\right)\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1\left(-\pd{}{s}\left(\frac{p}{\rho}-\chi\right)+\frac12\pd{|\bu|^2}{s}\right)\de s
            </mrow>
            <mrow>
              =&amp;0.
            </mrow>
          </md>
        </p>
      </solution>
    </exercise>
    
    <exercise xml:id="ex-circulation-vortex-tube">
      <title>The circulation around a vortex tube</title>
      <statement>
        <p>
          (Based on Exercise 5.5 in <xref ref="ref-acheson"/>).
          Define a vortex tube.
          Prove that the quantity
          <me>
            \Gamma = \int_S\bomega\cdot\bn\,\de S,
          </me>
          where <m>S</m> is any surface spanning the tube,
          is the same for all such surfaces.
          Relate this quantity to a circulation of the flow.
        </p>
      </statement>
      <hint>
        <p>
          Given two different such surfaces <m>S_1</m> and <m>S_2</m>,
          define a `cylindrical' volume <m>V</m>,
          whose ends are the the two surfaces <m>S_1</m> and <m>S_2</m>
          and whose sides are the sides of the vortex tube,
          and let <m>\Gamma_i = \int_{S_i}\bomega\cdot\bn_i\,\de S</m>,
          for <m>i=1,2</m>.          
        </p>
      </hint>
      <!--<solution>
        <p>
          Given two different such surfaces <m>S_1</m> and <m>S_2</m>,
          define a `cylindrical' volume <m>V</m>,
          whose ends are the the two surfaces <m>S_1</m> and <m>S_2</m>
          and whose sides are the sides of the vortex tube,
          and let <m>\Gamma_i = \int_{S_i}\bomega\cdot\bn_i\,\de S</m>,
          for <m>i=1,2</m>.
        </p>
        <p>
          Consider <m>\int_{\partial V}\bomega\cdot\bn\,\de S</m>.
          This is equal to <m>\Gamma_1</m> minus <m>\Gamma_2</m>
          plus the integral of <m>\bomega\cdot\bn</m> over the sides of the
          cylinder.
          On the sides of the cylinder, we have <m>\bomega\cdot\bn=0</m>.
          Hence, <m>\Gamma_1=\Gamma_2</m> for any two such surfaces.
        </p>
        <p>
          Stokes theorem implies that
          <me>
            \Gamma = \oint_C\bomega\times\de\bx,
          </me>
          where <m>C</m> is the curve around the edge of <m>S</m>,
          which is the circulation.
        </p>
        <p>
          Since the circulation is constant in time,
          this implies the flux of vorticity through any vortex tube is
          uniform and independent of time.
        </p>
      </solution>-->
    </exercise>

    <exercise xml:id="ex-line-integral-evolution">
      <title>Evolution of a line integral</title>
      <statement>
        <p>
          (Based on Exercise 5.6 in <xref ref="ref-acheson"/>).
          Show that if <m>\mathbf{a}(\bx,t)</m> is any suitably smooth vector field and
          <me>
            \mathcal{C}(t)=\int_{C(t)}\mathbf{a}\cdot\de\bx,
          </me>
          where <m>C(t)</m> is a circuit consisting of the same fluid particles
          as time proceeds, then
          <me>
            \dd{\mathcal{C}}{t}=\int_{C(t)}
            \left(\pd{\mathbf{a}}{t}
            +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx.
          </me>
        </p>
      </statement>
      <hint>
        <p>
          Similar to <xref ref="ex-kelvin-circulation-theorem"/>,
          there are two methods of solution possible.
        </p>
        <p>
          <em>First method:</em>
        </p>
        <figure xml:id="line-integral-evolution-fig">
          <caption>Curve <m>C</m> at times <m>t</m> and <m>t+\de t</m>.
            The inset shows the relationship between the two curves.</caption>
          <image source="ch-chapter06-line-integral-evolution.png" width="80%"/>
        </figure>
        <p>
          We write
          <me>
              \dd{\mathcal{C}}{t}=\lim_{\de t\rightarrow0}\frac1{\de t}
              \left(\int_{C(t+\de t)}\mathbf{a}(\bx,t+\de t)\cdot\de\bx
              -\int_{C(t)}\mathbf{a}(\bx,t)\cdot\de\bx\right).
          </me>
        </p>
        <p>
          <em>Second method:</em>
          Parametrise <m>C(t)</m> as <m>\bx(s,t)</m> for <m>0&lt;s&lt;1</m>.
          Then
          <me>
            \mathcal{C}(t)=\int_0^1\mathbf{a}\cdot\pd{\bx}{s}\de s.
          </me>
        </p>
      </hint>
      <!--<solution>
        <p>
          We present two methods of solution.
        </p>
        <p>
          <em>First method:</em>
        </p>
        <figure xml:id="line-integral-evolution-fig">
          <caption>Curve <m>C</m> at times <m>t</m> and <m>t+\de t</m>.
            The inset shows the relationship between the two curves.</caption>
          <image source="ch-chapter06-line-integral-evolution.png" width="80%"/>
        </figure>
        <p>
          We write
          <me>
              \dd{\mathcal{C}}{t}=\lim_{\de t\rightarrow0}\frac1{\de t}
              \left(\int_{C(t+\de t)}\mathbf{a}(\bx,t+\de t)\cdot\de\bx
              -\int_{C(t)}\mathbf{a}(\bx,t)\cdot\de\bx\right)
          </me>
          and note that
          <md>
            <mrow>
              &amp;\int_{C(t+\de t)}\mathbf{a}(\bx,t+\de t)\cdot\de\bx
            </mrow>
            <mrow>
              =&amp;\int_{C(t)}\mathbf{a}\left(\bx+\bu(x,t)\de t+\dots,t+\de t\right)\cdot
              \left(\bx+\de\bx+\bu(\bx+\de\bx,t)\de t-\bx-\bu(\bx,t)\de t\right)
            </mrow>
            <mrow>
              =&amp;\int_{C(t)}\left(\mathbf{a}(\bx,t)+\pd{\mathbf{a}}{t}(\bx,t)\de t
              +\bu(x,t)\cdot\nabla\mathbf{a}(\bx,t)\de t+\dots\right)\cdot
              \left(\de\bx+\left(\de\bx\cdot\nabla\right)\bu(\bx,t)\de t\right)
            </mrow>
          </md>
          Hence
          <md>
            <mrow>
              \dd{\mathcal{C}}{t}=&amp;\lim_{\de t\rightarrow0}\frac1{\de t}
              \int_{C(t)}\left(
                \mathbf{a}(\bx,t)\cdot\left(\left(\de\bx\cdot\nabla\right)\bu(\bx,t)\right)\de t
                +\pd{\mathbf{a}}{t}(\bx,t)\de t\cdot\de\bx
                +\left(\bu(\bx,t)\cdot\nabla\right)\mathbf{a}(\bx,t)\de t\cdot\de\bx
                +\dots\right)
            </mrow>
            <mrow>
              =&amp;\int_{C(t)}\left(
                \mathbf{a}\cdot\left(\left(\de\bx\cdot\nabla\right)\bu\right)
                +\pd{\mathbf{a}}{t}\cdot\de\bx
                +\left(\left(\bu\cdot\nabla\right)\mathbf{a}\right)\cdot\de\bx\right)
            </mrow>
          </md>
          Now we use the identity
          <me>
            \left(\mathbf{p}\times\mathbf{q}\right)\times\mathbf{r}
            =\left(\mathbf{p}\cdot\mathbf{r}\right)\mathbf{q}
            -\left(\mathbf{q}\cdot\mathbf{r}\right)\mathbf{p}
          </me>
          to expand
          <me>
            \left(\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx
            =\left(\left(\bu\cdot\nabla\right)\mathbf{a}\right)\cdot\de\bx
            -\bu\cdot\left(\left(\de\bx\cdot\nabla\right)\mathbf{a}\right).
          </me>
          Hence
          <md>
            <mrow>
              \dd{\mathcal{C}}{t}
              -\int_{C(t)}\left(\pd{\mathbf{a}}{t}
              +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx
              =&amp;
              \int_{C(t)}
              \mathbf{a}\cdot\left(\left(\de\bx\cdot\nabla\right)\bu\right)
              +\bu\cdot\left(\left(\de\bx\cdot\nabla\right)\mathbf{a}\right)
            </mrow>
            <mrow>
              =&amp;\int_{C(t)}
              \mathbf{a}\cdot\de\bu
              +\bu\cdot\de\mathbf{a}
            </mrow>
            <mrow>
              =&amp;\int_{C(t)}
              \de\left(\mathbf{a}\cdot\bu\right)
            </mrow>
            <mrow>
              =&amp;0,
            </mrow>
          </md>
          whence the result.
        </p>
        <p>
          <em>Second method:</em>
          Parametrise <m>C(t)</m> as <m>\bx(s,t)</m> for <m>0&lt;s&lt;1</m>.
          Then
          <me>
            \mathcal{C}(t)=\int_0^1\mathbf{a}\cdot\pd{\bx}{s}\de s
          </me>
          Then
          <md>
            <mrow>
              \dd{\mathcal{C}}{t}
              =&amp;\int_0^1\pd{\mathbf{a}(\bx(s,t),t)}{t}\cdot\pd{\bx}{s}+\mathbf{a}\cdot\pd{\bu}{s}\de s
            </mrow>
            <mrow>
              =&amp;\int_0^1\left(\pd{\mathbf{a}}{t}+\bu\cdot\nabla\mathbf{a}\right)\cdot\pd{\bx}{s}+\mathbf{a}\cdot\pd{\bu}{s}\de s.
            </mrow>
          </md>
          We can rewrite the expression we are aiming for:
          <me>
            \int_{C(t)}\left(\pd{\mathbf{a}}{t}
            +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx
            =\int_0^1\left(\pd{\mathbf{a}}{t}
            +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\pd{\bx}{s}\de s.
          </me>
          We use the identity
          <me>
            \left(\mathbf{p}\times\mathbf{q}\right)\times\mathbf{r}
            =\left(\mathbf{p}\cdot\mathbf{r}\right)\mathbf{q}
            -\left(\mathbf{q}\cdot\mathbf{r}\right)\mathbf{p},
          </me>
          and
          <me>
            \int_{C(t)}\left(\pd{\mathbf{a}}{t}
            +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx
            =\int_0^1\left(\pd{\mathbf{a}}{t}\cdot\pd{\bx}{s}
            +\left(\bu\cdot\nabla\mathbf{a}\right)\cdot\pd{\bx}{s}
            -\left(\pd{\bx}{s}\cdot\nabla\mathbf{a}\right)\cdot\bu\right)\de s.
          </me>
        </p>
        <p>
          Hence,
          <md>
            <mrow>
              \dd{\mathcal{C}}{t}
              -\int_{C(t)}\left(\pd{\mathbf{a}}{t}
              +\left(\nabla\times\mathbf{a}\right)\times\bu\right)\cdot\de\bx
              =&amp;
              \int_0^1\left(\mathbf{a}\cdot\pd{\bu}{s}
              +\left(\pd{\bx}{s}\cdot\nabla\mathbf{a}\right)\cdot\bu\right)\de s
            </mrow>
            <mrow>
              =&amp;
              \int_0^1\left(\mathbf{a}\cdot\pd{\bu}{s}
              +\pd{\mathbf{a}}{s}\cdot\bu\right)\de s
            </mrow>
            <mrow>
              =&amp;
              \int_0^1\pd{}{s}\left(\mathbf{a}\cdot\bu\right)\de s
            </mrow>
            <mrow>
              =&amp;0,
            </mrow>
          </md>
          whence the result.
        </p>
      </solution>-->
    </exercise>

    <exercise xml:id="ex-axisymmetric-flow">
      <title>Axisymmetric flow</title>
      <statement>
        <p>
          <em>Please feel free to omit this problem as we have not covered the material.</em>
        </p>
        <p>
          (Based on Exercise 5.7 in <xref ref="ref-acheson"/>).
          In this question, please make use of the vector calculus formulae given
          in cylindrical polar coordinates, available at
          <url href="https://en.wikipedia.org/wiki/Del_in_cylindrical_and_spherical_coordinates" visual="National Committee for Fluid Mechanics Films">this website</url>.
       
          Consider an axisymmetric flow. Working in cylindrical polar coordinates <m>(r,\theta,z)</m>,
          show that the vorticity is given by
          <me>
            \bomega=\omega\be_{\theta},
          </me>
          and that the vorticity equation <xref ref="eqn-vorticity-equation-lagrange"/> reduces to
          <me>
            \DD{}{t}\left(\frac{\omega}{r}\right)=0.
          </me>
          Thus the vorticity changes in proportion to distance from the axis of symmetry.
        </p>
        <p>
          Note that in spherical polar coordinates <m>(r,\theta,\phi)</m> this is equivalent to
          <me>
            \bomega=\omega\be_{\phi},\quad
            \DD{}{t}\left(\frac{\omega}{r\sin\theta}\right)=0.
          </me>
        </p>
      </statement>
      <hint>
        <p>
          Axisymmetry implies that <m>\bu</m> has no  <m>\theta</m>-component,
          that is <m>\bu\cdot\be_{\theta}=0</m>, and that <m>\partial\bu/\partial\theta=0</m>.
          Hence, <m>\bu=(u_r(r,z,t),0,u_z(r,z,t))</m>.
        </p>
        <p>
          Then, using the formula for curl in cylindrical polar coordinates,
          <me>
            \bomega=\nabla\times\bu
            =\left(\pd{u_r}{z}-\pd{u_z}{r}\right)\be_{\theta}.
          </me>
        </p>
        <p>
          We have
          <md>
            <mrow>
              &amp;\DD{\bomega}{t}-\bomega\cdot\nabla\bu=0
            </mrow>
            <mrow>
              \Rightarrow\quad&amp;\DD{\omega}{t}\be_{\theta}+\omega\DD{\be_{\theta}}{t}
              -\omega\be_{\theta}\cdot\nabla\bu=0.
            </mrow>
          </md>
          Show that <m>\mathrm{D}\be_{\theta}/\mathrm{D}t=0</m> and use
          <me>
            \pd{\bu}{\theta}=u_r\be_{\theta}.
          </me>
        </p>
      </hint>
      <solution>
        <p>
          Axisymmetry implies that <m>\bu</m> has no  <m>\theta</m>-component,
          that is <m>\bu\cdot\be_{\theta}=0</m>, and that <m>\partial\bu/\partial\theta=0</m>.
          Hence, <m>\bu=(u_r(r,z,t),0,u_z(r,z,t))</m>.
        </p>
        <p>
          Then, using the formula for curl in cylindrical polar coordinates,
          <me>
            \bomega=\nabla\times\bu
            =\left(\pd{u_r}{z}-\pd{u_z}{r}\right)\be_{\theta}
            =\omega\be_{\theta},
          </me>
          where <m>\omega=\partial u_r/\partial z-\partial u_z/\partial r</m>.
        </p>
        <p>
          We have
          <md>
            <mrow>
              &amp;\DD{\bomega}{t}-\bomega\cdot\nabla\bu=0
            </mrow>
            <mrow>
              \Rightarrow\quad&amp;\DD{\omega}{t}\be_{\theta}+\omega\DD{\be_{\theta}}{t}
              -\omega\be_{\theta}\cdot\nabla\bu=0.
            </mrow>
          </md>
          We note that <m>\partial\be_{\theta}/\partial t=0</m> and <m>(\bu\cdot\nabla)</m>
          has gradients with respect to <m>r</m> and <m>z</m> (and not with respect to <m>\theta</m>),
          meaning that <m>(\bu\cdot\nabla)\be_{\theta}=0</m>.
          Also, since <m>\partial\be_r/\partial\theta=\be_\theta</m>,
          <me>
            \be_{\theta}\cdot\nabla\bu=\frac1r\pd{}{\theta}\left(u_r(r,z,t)\be_r+u_z(r,z,t)\be_z\right)=\frac{u_r}{r}\be_{\theta}.
          </me>
          Hence, the only non-zero component of the vorticity equation is the <m>\theta</m>-component,
          and this reads:
          <me>
            \DD{\omega}{t}-\omega\frac{u_r}{r}=0.
          </me>
        </p>
        <p>
          Now,
          <me>
            \DD{}{t}\left(\frac{\omega}{r}\right)=\frac1r\DD{\omega}{t}-\frac{\omega}{r^2}\DD{r}{t},
          </me>
          and
          <me>
            \DD{r}{t}=u_r\pd{r}{r}=u_r
          </me>
          and hence
          <me>
            \DD{}{t}\left(\frac{\omega}{r}\right)=\frac1r\DD{\omega}{t}-\frac{\omega u_r}{r^2}.
          </me>
        </p>
        <p>
          Dividing the vorticity equation by <m>r</m>:
          <me>
            \frac1r\DD{\omega}{t}-\frac1r\omega\frac{u_r}{r}=0
            \quad\Rightarrow\quad
            \DD{}{t}\left(\frac{\omega}{r}\right)=0,
          </me>
          as required.
        </p>
      </solution>
    </exercise>

    <exercise xml:id="ex-two-vortices">
      <title>Two vortices</title>
      <statement>
        <p>
          Two vortices, of strengths <m>\Gamma_1</m> and <m>\Gamma_2</m>,
          are at the points <m>z = z_1</m> and <m>z = z_2</m>,
          respectively, in the complex plane.
          Write down the equations of motion for the position vectors
          <m>z_1(t)</m> and <m>z_2(t)</m> if the vortices are free to move.
          Assuming that <m>\Gamma_1+\Gamma_2\neq0</m>, show
          that <m>\de Z/\de t = \de a/\de t = 0</m>, where
          <me>
            Z=\frac{\Gamma_1z_1+\Gamma_2z_2}{\Gamma_1+\Gamma_2}
          </me>
          is the centroid of the two vortices,
          and <m>a = |z_1− z_2|</m> is the distance between them.
        </p>
        <p>
          Deduce that each vortex moves in a circle centred on <m>Z</m>,
          with angular velocity
          <me>
            \Omega=\frac{\Gamma_1+\Gamma_2}{2\pi a^2}.
          </me>
          What happens in the exceptional case where <m>\Gamma_1+\Gamma_2=0</m>?
        </p>
      </statement>
      <hint>
        <p>
          The complex potential for the two vortices is
          <me>
            w(z)=-\frac{\im\Gamma_1}{2\pi}\log(z-z_1)-\frac{\im\Gamma_2}{2\pi}\log(z-z_2).
          </me>
          Hence, the velocity field is given by
          <me>
            u-\im v=-\frac{\im\Gamma_1}{2\pi(z-z_1)}-\frac{\im\Gamma_2}{2\pi(z-z_2)}.
          </me>
          The velocity of each vortex is given by evaluating this
          expression at the position of the other vortex.
        </p>
      </hint>
      <!--<solution>
        <p>
          The complex potential for the two vortices is
          <me>
            w(z)=-\frac{\im\Gamma_1}{2\pi}\log(z-z_1)-\frac{\im\Gamma_2}{2\pi}\log(z-z_2).
          </me>
          Hence, the velocity field is given by
          <me>
            u-\im v=-\frac{\im\Gamma_1}{2\pi(z-z_1)}-\frac{\im\Gamma_2}{2\pi(z-z_2)}.
          </me>
          The velocity of each vortex is given by evaluating this
          expression at the position of the other vortex.
        </p>
        <p>
          Thus, the equations of motion for the vortices are
          <md>
            <mrow>
              \dd{z_1}{t}=&amp;-\frac{\im\Gamma_2}{2\pi(z_1-z_2)},
            </mrow>
            <mrow>
              \dd{z_2}{t}=&amp;-\frac{\im\Gamma_1}{2\pi(z_2-z_1)}.
            </mrow>
          </md>
        </p>
        <p>
          We calculate
          <md>
            <mrow>
              \dd{Z}{t}=&amp;\frac{\Gamma_1}{\Gamma_1+\Gamma_2}\dd{z_1}{t}
              +\frac{\Gamma_2}{\Gamma_1+\Gamma_2}\dd{z_2}{t}
            </mrow>
            <mrow>
              =&amp;-\frac{\im\Gamma_1\Gamma_2}{2\pi(\Gamma_1+\Gamma_2)}
              \left(\frac1{z_1-z_2}-\frac1{z_2-z_1}\right)
            </mrow>
            <mrow>
              =&amp;0.
            </mrow>
          </md>
          Similarly,
          <md>
            <mrow>
              \dd{a^2}{t}=&amp;\dd{}{t}\left((z_1-z_2)(\overline{z_1-z_2})\right)
            </mrow>
            <mrow>
              =&amp;(z_1-z_2)\dd{}t(\overline{z_1-z_2})
              +(\overline{z_1-z_2})\dd{}{t}(z_1-z_2)
            </mrow>
            <mrow>
              =&amp;(z_1-z_2)\left(\overline{\dd{z_1}{t}}-\overline{\dd{z_2}{t}}\right)
              +(\overline{z_1-z_2})\left(\dd{z_1}{t}-\dd{z_2}{t}\right)
            </mrow>
            <mrow>
              =&amp;\frac{\im\Gamma_1\Gamma_2}{2\pi}
              \left(\frac{z_1-z_2}{\overline{z_1-z_2}}
              -\frac{\overline{z_1-z_2}}{z_1-z_2}\right)
            </mrow>
            <mrow>
              =&amp;0.
            </mrow>
          </md>
        </p>
        <p>
          Thus, <m>Z</m> and <m>a</m> are constant in time.
          To find the angular velocity, we set <m>z_1=Z+a\exp(\im\theta_1)</m>
        </p>
      </solution>-->
    </exercise>

    <exercise xml:id="ex-obstacle">
      <title>Obstacle</title>
      <statement>
        <p>
          Fluid occupies the region <m>x^2+y^2>a^2</m> outside a circular obstacle
          of radius <m>a</m>. By using
          the Milne-Thomson Circle Theorem, find the resulting complex potential
          when a vortex of strength
          <m>\Gamma</m> is placed at <m>(x, y) = (b, 0)</m>,
          where <m>b > a</m> (assuming there to be no circulation about
          the obstacle).
        </p>
        <p>
          Explain why the vortex will move in a circle of radius <m>b</m>
          with angular velocity of magnitude
          <me>
            \Omega=\frac{\Gamma a^2}{2\pi b^2(b^2-a^2)}.
          </me>
        </p>
      </statement>
      <!--<solution>
        <p>
          The complex potential associated with the vortex in isolation is
          <me>
            f(z)=-\frac{\im\Gamma}{2\pi}\log(z-b).
          </me>
          We construct the complex potential in the presence of the obstacle
          using the Milne-Thomson Circle Theorem:
          <md>
            <mrow>
              w(z)=&amp;f(z)+\overline{f\left(\frac{a^2}{\overline{z}}\right)}
            </mrow>
            <mrow>
              =&amp;-\frac{\im\Gamma}{2\pi}\log(z-b)
              +\frac{\im\Gamma}{2\pi}\overline{\log\left(\frac{a^2}{\overline{z}}-b\right)}
            </mrow>
            <mrow>
              =&amp;-\frac{\im\Gamma}{2\pi}\log(z-b)
              +\frac{\im\Gamma}{2\pi}\log\left(\frac{a^2}{z}-b\right)
            </mrow>
            <mrow>
              =&amp;\frac{\im\Gamma}{2\pi}\log\left(\frac{a^2-bz}{z(z-b)}\right)
            </mrow>
            <mrow>
              =&amp;\frac{\im\Gamma}{2\pi}\left(\log\left(a^2-bz\right)-\log z-\log(z-b)\right);
            </mrow>
          </md>
          separating the logarithms in the final step enables the derivative to be taken more easily.
          This has a single singularity at the vortex <m>z=b</m> and the circle
          <m>|z|=a</m> is a streamline, as required.
        </p>
        <p>
          The velocity field can be found by taking the derivative of <m>w(z)</m>:
          <md>
            <mrow>
              u-\im v&amp;=\dd{w}{z}
            </mrow>
            <mrow>
              =&amp;-\frac{\im\Gamma}{2\pi}\left(\frac{b}{a^2-bz}+\frac1{z-b}+\frac1{z}\right),
            </mrow>
          </md>
          and, removing the vortex (the term proportional to <m>1/(z-b)</m>),
          the velocity of the vortex at <m>z=b</m> is
          <me>
            u_V-\im v_V=-\frac{\im\Gamma}{2\pi}\left(\frac{b}{a^2-b^2}+\frac1{b}\right),
          </me>
          which is an instantaneous velocity of magnitude
          <me>
            \frac{\Gamma}{2\pi}\left(\frac{b}{a^2-b^2}+\frac1{b}\right)
          </me>
          upwards. By symmetry,
          the vortex moves in a circle of radius <m>b</m> about the origin
          with speed equal to this value, giving an angular velocity of
          <me>
            \frac{\Gamma}{2\pi}\left(\frac1{a^2-b^2}+\frac1{b^2}\right)
            =\frac{\Gamma a^2}{2\pi b^2(a^2-b^2)}+\frac1{b^2},
          </me>
          as required.
        </p>
      </solution>-->
    </exercise>

    <exercise xml:id="ex-quadrant">
      <title>Flow in a quadrant</title>
      <statement>
        <p>
          Fluid occupies the quadrant <m>x > 0</m>, <m>y > 0</m> bounded by
          two rigid boundaries along the
          <m>x</m>- and <m>y</m>-axes.
          Find the complex potential for the flow caused by
          a vortex at a point <m>z=c=a+\im b</m> in the fluid.
          If the vortex is free to move,
          show that it follows a path on which
          <me>
            \frac1{x^2}+\frac1{y^2}=\text{constant}.
          </me>
        </p>
      </statement>
      <solution>
        <p>
          <em>See also <xref ref="ex-wing-tip-vortices"/>.</em>
        </p>
        <p>
          Suppose the vortex is at the point
          <me>
            z_1=x_1+\im y_1.
          </me>
          We use three image vortices at <m>x_1-\im y_1</m> and at <m>-x_1+\im y_1</m>,
          both of strength <m>-\Gamma</m>, and at <m>-x_1-\im y_1</m> of strength
          <m>\Gamma</m>.
        </p>
        <p>
          Recall that the complex potential of a line vortex at <m>z=c</m>
          of strength <m>\Gamma</m> is <m>-\im\Gamma\log(z-c)/(2\pi)</m> and
          its velocity is given by the derivative of this map:
          <m>u-\im v=-\im\Gamma/(2\pi(z-c))</m>.
        </p>
        <p>
          The velocity of the vortex is given by the sum of the velocities due to
          the other three vortices:
          <md>
            <mrow>
              \dd{x_1}{t}-\im\dd{y_1}{t}
              =&amp;\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(x_1-\im y_1))}
            </mrow>
            <mrow>
              &amp;+\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(-x_1+\im y_1))}
            </mrow>
            <mrow>
              &amp;-\frac{\im\Gamma}{2\pi((x_1+\im y_1)-(-x_1-\im y_1))}
            </mrow>
            <mrow>
              &amp;=\frac{\im\Gamma}{4\pi}\left(\frac1{x_1}+\frac1{\im y_1}-\frac1{x_1+\im y_1}\right).
            </mrow>
          </md>
          Hence
          <md>
            <mrow>
              \dd{x_1}{t}
              =\frac{\Gamma}{4\pi}\left(\frac1{y_1}-\frac{y_1}{x_1^2+y_1^2}\right)
              =\frac{\Gamma x_1^2}{4\pi y_1(x_1^2+y_1^2)},
            </mrow>
            <mrow>
              \dd{y_1}{t}
              =\frac{\Gamma}{4\pi}\left(-\frac1{x_1}+\frac{x_1}{x_1^2+y_1^2}\right)
              =-\frac{\Gamma y_1^2}{4\pi x_1(x_1^2+y_1^2)},
            </mrow>
          </md>
          and therefore
          <me>
            \dd{y_1}{x_1}=-\frac{y_1^3}{x_1^3},
          </me>
          which can be solved by separation of variables to give
          <me>
            \int\frac1{y_1^3}\de y_1=-\int\frac1{x_1^3}\de x_1
            \quad\Rightarrow\quad
            -\frac1{2y_1^2}=\frac1{2x_1^2}+c,
          </me>
          where <m>c</m> is constant, and this can be rearranged into the required form.
        </p>
      </solution>
    </exercise>

    <exercise xml:id="ex-channel">
      <title>Channel flow</title>
      <statement>
        <p>
          [Harder] Fluid occupies the semi-infinite channel
          <m>\{z : \Re z > 0,−a &lt; \Im z &lt; a\}</m>.
          Show that the flow induced by a line vortex of strength
          <m>\Gamma>0</m> at the point <m>z = d \in\mathbb{R}^+</m>
          has complex potential
          <md>
            <mrow>
              w(z)=&amp;\frac{\im\Gamma}{2\pi}\left\{
                -\log\left[\sinh\left(\frac{\pi z}{2a}\right)
                -\sinh\left(\frac{\pi d}{2a}\right)\right]\right.
            </mrow>
            <mrow>
              &amp;+\left.
                \log\left[\sinh\left(\frac{\pi z}{2a}\right)
                +\sinh\left(\frac{\pi d}{2a}\right)\right]
                \right\}.
            </mrow>
          </md>
          Show that the velocity components satisfy
          <me>
            u-\im v=\frac{\im\Gamma}{4a}\left\{
              \mathrm{cosech}\left(\frac{\pi(z+d)}{2a}\right)
              -\mathrm{cosech}\left(\frac{\pi(z-d)}{2a}\right)
              \right\}.
          </me>
        </p>
        <p>
          Deduce that, if the vortex is free to move,
          it will instantaneously travel downwards
          with speed <m>(\Gamma/4a)\mathrm{cosech}(\pi d/a)</m>.
        </p>
        <p>
          You may use the identity <m>\sinh^2(x)− \sinh^2(y)
            \equiv \sinh(x + y) \sinh(x− y)</m>.
        </p>
      </statement>
      <hint>
        <p>
          Consider the map
          <me>
            \zeta = \sinh\left(\frac{\pi z}{2a}\right).
          </me>
        </p>
      </hint>
      <solution>
        <p>
          Consider the transformation
          <md>
            <mrow>
              \zeta =&amp; \sinh\left(\frac{\pi z}{2a}\right)
            </mrow>
            <mrow>
              =&amp; \sinh\left(\frac{\pi (x+\im y)}{2a}\right)
            </mrow>
            <mrow>
              =&amp; \sinh\left(\frac{\pi x}{2a}\right)\cosh\left(\frac{\im\pi y}{2a}\right)+\cosh\left(\frac{\pi x}{2a}\right)\sinh\left(\frac{\im\pi y}{2a}\right)
            </mrow>
            <mrow>
              =&amp; \sinh\left(\frac{\pi x}{2a}\right)\cos\left(\frac{\pi y}{2a}\right)+\im\cosh\left(\frac{\pi x}{2a}\right)\sin\left(\frac{\pi y}{2a}\right).
            </mrow>
          </md>
          The inverse transformation is
          <me>
            z = \frac{2a}{\pi}\sinh^{-1}\left(\zeta\right).
          </me>
        </p>
        <p>
          With this map, the line <m>x=0</m> transforms to part of the imaginary axis
          <me>
            \zeta=\im\sin\left(\frac{\pi y}{2a}\right),
          </me>
          and the constraint <m>-a\lt y\lt a</m> corresponds to the line between the points <m>\pm\im</m>. The lines <m>y=\pm a</m> transform to
          <me>
            \zeta=\pm\im\cosh\left(\frac{\pi x}{2a}\right),
          </me>
          and the constraint <m>x>0</m> corresponds to the line segments above <m>+\im</m> and below <m>-\im</m>, respectively.
          Hence the channel is transformed to the right half plane:
        </p>
        <figure xml:id="fig-ex-channel">
          <caption>Conformal map of channel</caption>
          <image source="ch-chapter06-ex-channel.jpg" width="100%">
            <shortdescription>Channel map</shortdescription>
          </image>
        </figure>
        <p>
          We have a vortex of strength <m>\Gamma</m> at the point <m>z=d</m>, which point transforms to <m>\zeta=\sinh(\pi d/(2a))</m>. In the <m>\zeta</m>-plane, we also require an image vortex of strength <m>-\Gamma</m> at the point <m>\zeta=-\sinh(\pi d/(2a))</m>. This will ensure that the transformed channel boundary in the <m>\zeta</m>-plane (i.e. the imaginary axis) has a no-penetration boundary condition.
        </p>
        <p>
          Therefore, the complex potential in the <m>\zeta</m>-plane is given by
          <me>
            g(\zeta) =
            -\frac{\im\Gamma}{2\pi}\log\left(\zeta-\sinh\left(\frac{\pi d}{2a}\right)\right)
            +\frac{\im\Gamma}{2\pi}\log\left(\zeta+\sinh\left(\frac{\pi d}{2a}\right)\right)
          </me>
          Hence in the <m>z</m>-plane, the map is
          <md>
            <mrow>
              f(z) = &amp;
              -\frac{\im\Gamma}{2\pi}\log\left(\sinh\left(\frac{\pi z}{2a}\right)
              -\sinh\left(\frac{\pi d}{2a}\right)\right)
            </mrow>
            <mrow>
              &amp;
              +\frac{\im\Gamma}{2\pi}\log\left(\sinh\left(\frac{\pi z}{2a}\right)+\sinh\left(\frac{\pi d}{2a}\right)\right)
            </mrow>
            <mrow>
              = &amp;
              \frac{\im\Gamma}{2\pi}\log\left(\frac{\sinh(\pi z/(2a))+\sinh(\pi d/(2a))}{\sinh(\pi z/(2a))-\sinh(\pi d/(2a))}\right)
            </mrow>
          </md>
        </p>
        <p>
          The velocity components are given by the derivative:
          <md>
            <mrow>
              u-\im v = &amp; f’(z)
            </mrow>
            <mrow>
              = &amp;
              \frac{\im\Gamma}{4a}\left(
              -\frac{\cosh(\pi z/(2a))}{\sinh(\pi z/(2a))-\sinh(\pi d/(2a))}\right.
            </mrow>
            <mrow>
              &amp;
              \left.+\frac{\cosh(\pi z/(2a))}{\sinh(\pi z/(2a))+\sinh(\pi d/(2a))}
              \right)
            </mrow>
            <mrow>
              = &amp;
              -\frac{\im\Gamma}{2a}\left(
              \frac{\cosh(\pi z/(2a))\sinh(\pi d/(2a))}{\sinh^2(\pi z/(2a))-\sinh^2(\pi d/(2a))}
              \right)
            </mrow>
          </md>
          Using the identity given in the question, we have,
          <md>
            <mrow>
              f’(z)=&amp;
              -\frac{\im\Gamma}{2a}\left(
              \frac{\cosh(\pi z/(2a))\sinh(\pi d/(2a))}{\sinh(\pi(z+d)/(2a))\sinh(\pi(z-d)/(2a))}
              \right)
            </mrow>
            <mrow>
              f’(z)=&amp;
              -\frac{\im\Gamma}{4a}\left(
              \frac{\sinh(\pi(d+z)/(2a))+\sinh(\pi(d-z)/(2a))}{\sinh(\pi(z+d)/(2a))\sinh(\pi(z-d)/(2a))}
              \right)
            </mrow>
            <mrow>
              f’(z)=&amp;
              -\frac{\im\Gamma}{4a}\left(
              \mathrm{cosech}\left(\frac{\pi(z-d)}{2a}\right)
              -\mathrm{cosech}\left(\frac{\pi(z+d)}{2a}\right)
              \right),
            </mrow>
          </md>
          as required.
        </p>
        <p>
          Using the Helmholtz principle, the vortex moves due to the flow of everything but itself.
          Thus at <m>z=d</m>, excluding the part of the flow due to the vortex, if the vortex flow moves with velocity <m>(u_V,v_V)</m>, we have
          <me>
            u_V-\im v_V
            =-\frac{\im\Gamma}{4a}\mathrm{cosech}\left(\frac{\pi d}{a}\right),
          </me>
          corresponding to a downward velocity
          <me>
            \frac{\Gamma}{4a}\mathrm{cosech}\left(\frac{\pi d}{a}\right).
          </me>
        </p>
      </solution>
    </exercise>
  </exercises>
</chapter>