<?xml version="1.0" encoding="UTF-8"?>

<chapter xml:id="ch-chapter06-vorticity" xmlns:xi="http://www.w3.org/2001/XInclude">
  <title>Vortex motion</title>

  <introduction>
    <p>
      In this chapter, we will study the motion of vortices in an inviscid fluid.
      We will define vortex lines, which are to the vorticity field as the streamlines defined in
      <xref ref="ch-chapter02-kinematics"/> are to the velocity field. We will show that vortex
      lines move with the fluid and that a fluid that starts irrotational remains irrotational
      for all time.
    </p>

    <sidebyside>
      <figure>
       <image source="ch-chapter06-greg-johnson-5V3FUicslvo-unsplash.jpg" width="35%" />
        <caption>A tornado (credit Greg Johnson, Unsplash).</caption>
      </figure>
      <figure>
        <image source="ch-chapter06-NASA-Langley-Research-Center-il_wingtipvortexedit_lg.jpg" width="35%" />
        <caption>Wingtip vortices behind an aircraft (credit NASA Langley Research Center).</caption>
      </figure>
      <figure>
        <image source="ch-chapter06-220px-Tea_leaf_Paradox_Illustration.png" width="25%" />
        <caption>Vortex created when a cup of tea is stirred, also showing the secondary flow that results,
        which in turn leads to the <em>tea leaf paradox</em> in which tea leaves sprinkled on the bottom
        of a cup migrate into a pile in the centre (you can try this at home). Credit Wikipedia.</caption>
      </figure>
    </sidebyside>

    <p>
      Examples of vortex motion abound in nature and industry. The most familiar examples are perhaps
      tornadoes and hurricanes, which are large-scale vortices in the atmosphere. Other
      examples include the swirling motion that forms when water drains from a bath or
      sink, the wake vortices that form behind aircraft wings, and the vortices that form
      behind a swimming fish or a flying bird. Vortices are also important in engineering
      applications, for example in the design of aircraft wings and turbine blades.
    </p>

    <p>
      Recall the fluid vorticity <m>\bomega=\nabla\times\bu</m> that was introduced in
      Definition <xref ref="def-vorticity"/>. Many people struggle to understand the
      concept of vorticity when they first encounter it, so you should not worry if it
      takes a while to sink in. The excellent (although dated) movie `Vorticity, Part 1â€™
      by Ascher Shapiro available at
      <url href="https://web.mit.edu/hml/ncfmf.html" visual="National Committee for Fluid Mechanics Films">this website</url>
      gives a clear and comprehensive introduction to the phenomenon. To recap:
      <ul>
        <li>
          <p>
            Vorticity, <m>\bomega</m>, is a vector field and it is a function of space and time
            (like the fluid velocity).
          </p>
        </li>
        <li>
          <p>
            At each point in the fluid, <m>\bomega</m> points in the direction of the axis of the local fluid rotation.
          </p>
        </li>
        <li>
          <p>
            The magnitude of <m>\bomega</m> is twice the local angular velocity.
          </p>
        </li>
        <li>
          <p>
            In the special case of a two-dimensional flow
            (that is <m>\bu(\bx,t)=(u(x,y,t),v(x,y,t),0)</m>), the vorticity is
            unidirectional, pointing in the <m>z</m>-direction with
            magnitude <me>\pd{v}{x}-\pd{u}{y}</me>.
          </p>
        </li>
      </ul>
    </p>

    <example>
      <task>
        <p>
          Consider the steady, two-dimensional flow given by <me>\bu = (-y,x, 0)</me>, which is flow
          anti-clockwise around the origin. Note that this flow is a type of <em>rigid body rotation</em>:
          it is the flow that would be generated by a rigid body rotating about the <m>z</m>-axis
          with angular velocity <m>1</m>.
          Plot the streamlines of this flow.
        </p>
        <solution>
          <p>
            The streamlines are concentric circles around the origin, with flow going anticlockwise
            around the circles.
          </p>
          </solution>
        </task>
        <task>
          <p>
            Convert this flow to plane polar coordinates <m>(r,\theta)</m> (where
            <m>x = r\cos\theta</m> and <m>y = r\sin\theta</m>), and show that the <m>r</m>-component
            of the velocity is zero and the <m>\theta</m>-component is <m>1</m>.
          </p>
          <solution>
            <p>
              We have
              <me>\dd{r}{t}=\frac{x}{r}(-y)+\frac{y}{r}(x)=0,</me>
              and
              <md>
                <mrow>\dd{\theta}{t}\amp=\dd{}{t}\left(\tan^{-1}\frac{y}{x}\right)</mrow>
                <mrow>\amp=\frac{1}{1+y^2/x^2}\left(-\frac{y}{x^2}\right)(-y)+\frac{1}{1+y^2/x^2}\left(\frac{1}{x}\right)(x)</mrow>
                <mrow>\amp=1.</mrow>
              </md>
              Thus, in plane polar coordinates, the velocity is <m>(0,1)</m>.
            </p>
          </solution>
        </task>
        <task>
          <p>
            Hence find the angular velocity of the fluid.
          </p>
          <solution>
            <p>
              The angular velocity is everywhere <m>(0,0,1)</m>.
            </p>
          </solution>
        </task>
        <task>
          <p>
            Calculate the vorticity of the flow.
          </p>
          <solution>
            <p>
              The vorticity of the flow is given by
              <me>
                \bomega = \bnabla\times\bu
                = \begin{vmatrix}
                \bi \amp \bj \amp \bk \\
                \pd{}{x} \amp \pd{}{y} \amp \pd{}{z} \\
                -y \amp x \amp 0
                \end{vmatrix}
                = (0,0,2),
              </me>
              which is twice the local angular momentum
              (magnitude twice the rotation rate, with axis in the direction of the axis of rotation).
            </p>
          </solution>
        </task>
    </example>
  </introduction>

  <section xml:id="sec-helmholtz">
    <title>The Helmholtz principle</title>
    <p>As mentioned in Chapter <xref ref="ch-chapter03-equations"/>, the vorticity obeys the
      vorticity equation <xref ref="eqn-vorticity-equation-lagrange"/>:
      <me>
        \DD{\bomega}{t} = (\bomega \cdot \nabla)\bu.
      </me>
      In two-dimensional irrotational flow, the right-hand side is zero, so the vorticity of each fluid
      particle is constant in time. This is a special case of the more general result known as
      the <em>Helmholtz principle</em>, which states that in an inviscid fluid, the vorticity
      of each fluid particle is conserved.
    </p>
    <subsection>xml:id="sec-circulation">
      <title>The circulation in a flow</title>
      <definition xml:id="def-circulation">
        <title>Circulation</title>
        <p>
          We define the circulation around a closed loop <m>C</m> in the flow as
          <me>
            \Gamma = \oint_C \mathbf{u} \cdot \de\mathbf{x}.
          </me>
        </p>
      </definition>
      <theorem xml:id="thm-kelvin-circulation-theorem">
        <title>Kelvin's circulation theorem</title>
        <p>
          Assume that a fluid is inviscid and incompressible and that a conservative body force
          (e.g. gravity) acts on it. If a loop <m>C</m> is fixed in the fluid
          (and thus moves around in the Lagrangian sense as the fluid moves)
          then the circulation around <m>C</m> is constant in time.
        </p>
      </theorem>
      <proof>
        <title>Proof of Kelvin's circulation theorem</title>
        <p>
          A proof of this theorem is given in Exercise <xref ref="ex-kelvin-circulation-theorem"/>.      
        </p>
      </proof>    
      <remark>
        <title>Importance of Kelvin's circulation theorem</title>
        <p>
          This theorem explains why the circulation is an important physical concept.
          In particular, if a flow is initally irrotational,
          then the circulation around any loop is zero at <m>t=0</m>.
          The theorem then implies that the circulation around any loop is zero for all time.
          Therefore the flow at any time is irrotational.
        </p>
      </remark>    
      <remark>
        <title>Relationship between circulation and vorticity</title>
        <p>
          Using Stokes' theorem
          <men xml:id="eq-circulationvorticity">
            \Gamma=\oint_C{\bu}\cdot \de{\bx}=\int_S\left(\bnabla\times{\bu}\right)\cdot{\bn}\,{\de}S
            =\int_S\bomega\cdot{\bn}\,{\de}S,
          </men>
          where <m>S</m> is any surface spanning the loop <m>C</m>.
          Thus the circulation equals the flux of vorticity through the spanning surface.
        </p>
      </remark>
    </subsection>
    <subsection>
      <title>Vortex lines and the Helmholtz vortex theorems</title>
      <definition xml:id="def-vortex-lines">
        <title>Vortex lines</title>
        <p>
          Vortex lines are curves that point in the same direction as the vorticity vector.
          They satisfy the differential equation
          <me>
          \dd{\bx}{s}=\bomega(\bx(s),t),
          </me>
          where <m>t</m> is fixed.
          Just as the streamlines give a picture of the flow field,
          so the vortex lines give a picture of the vorticity field.
          Note that if the vorticity is zero at some point,
          the vortex lines are not defined there.
        </p>
      </definition>
      <remark>
        <title>Analogy with streamlines</title>
        <p>
          The vortex lines are to the vorticity of the fluid as the streamlines are to its velocity.
        </p>
      </remark>    
      <remark>
        <title>Vortex lines in a two-dimensional flow</title>
        <p>
          In a two-dimensional flow, the vorticity is unidirectional, so the vortex lines are
          straight lines parallel to the vorticity vector.
          For example, for a flow in the <m>(x,y)</m>-plane,
          the vorticity points in the <m>z</m>-direction, and the vortex lines are straight
          lines parallel to the <m>z</m>-axis.
        </p>
      </remark>
      <theorem>xml:id="thm-helmholtz-vortex-theorems">
        <title>The Helmholtz vortex theorems</title>
        <p>
          These state
          <ol>
            <li>
              <p>
                Vortex lines move with the fluid.
                Thus they follow the material paths of the fluid particles.
                We can group nearby vortex lines together to form a vortex tube,
                as shown in <xref ref="fig-vortextube"/>
                (taken from <xref ref="ref-acheson"/>),
                and the vortex tube moves with the flow. The surfaces of the vortex tube are vortex lines.
                This is a strong part of the reason why it is useful to calculate vortex lines.
              </p>
            </li>
            <li>
              <figure xml:id="fig-vortextube">
                <caption>Sketch of a vortex tube.</caption>
                <image source="ch-chapter06-vortextube.jpg" width="50%">
                 <shortdescription>Vortex tube</shortdescription>
                </image>
              </figure>
              <p>
                The circulation of the tube is <m>\Gamma=\oint_C\bu\cdot \de{\bx}</m>
                around any closed curve <m>C</m> that goes once anticlockwise around the vortex tube,
                or equivalently <m>\Gamma=\int_S\bomega\cdot{\bn}\,\de S</m>,
                where <m>S</m> is any cross-section of the vortex tube,
                see <xref ref="eq-circulationvorticity"/>.
                The circulation is independent of the choice of curve <m>C</m>
                or cross-section <m>S</m> at all times.
              </p>
            </li>
          </ol>
        </p>
      </theorem>
      <proof>
        <title>Proof of the Helmholtz vortex theorems</title>
        <p>
          To do.          
        </p>
      </proof>
      <remark>
        <p>
          Thus if a vortex line becomes stretched then <em>spin up</em> occurs.
          If we consider a thin vortex tube surrounding the vortex line,
          then, as the vortex line is stretched, the tube becomes thinner and longer.
          However, <m>\Gamma=\int_S\bomega\cdot{\bn}\,dS</m> must remain constant,
          and therefore, since the area of the cross-section <m>S</m> is decreasing,
          <m>\bomega</m> must get bigger.
          Conversely, if a vortex line shortens we get <em>spin down</em>
          and <m>\bomega</m> gets smaller.          
        </p>
      </remark>
      <example>
        <title>Example of spin up and spin down</title>
        <sidebyside>
          <figure xml:id="fig-spinup">
            <caption>Spin up of vorticity as thunderclouds move overhead.</caption>-->
            <image source="ch-chapter06-spinup.jpg" width="50%">
              <shortdescription>Spin up</shortdescription>
            </image>
          </figure>
          <figure xml:id="fig-spindown">
            <caption>Spin down of a cup of tea. Secondary circulations (shown by the arrows)
              tend to spread the material lines out radially.
              Thus the tall thin column of fluid (a) becomes a short fat one(b).</caption>
            <image source="ch-chapter06-spindown.jpg" width="50%">
              <shortdescription>Spin up</shortdescription>
            </image>
          </figure>
        </sidebyside>
        <p>
          The two sketches in <xref ref="fig-spinup"/> and <xref ref="fig-spindown"/>
          (taken from <xref ref="ref-acheson"/>)
          show examples of spin up and spin down, respectively.
          Spin up occurs in thunderstorms; as the cloud moves, the vortex lines get stretched,
          which could result in a tornado. Spin up happens in a cup of tea after it has been stirred.
          Secondary flows in the cup tend to spread the column of rotating fluid horizontally,
          making the area of the cross-section of the vortex tube bigger,
          and hence the vorticity smaller, which is spin down.
        </p>
      </example>
    </subsection>
  </section>
  <section xml:id="sec-helmholtz-examples">
    <title>Examples illustrating the use of the Helmholtz principle</title>
    <p>
      Here are some examples.
    </p>
  </section>
  <exercises xml:id="ws-vorticity">
    <introduction>
      <warning>
        <p>
          We look to complete worksheets in the week prior to the content being delivered.
          Once this is done, this disclaimer message will be removed.
        </p>
      </warning>
    </introduction>
    <exercise xml:id="ex-kelvin-circulation-theorem">
      <title>Kelvinâ€™s Circulation Theorem</title>
      <statement>
        <p>
          The circulation <m>\Gamma</m> around a closed curve <m>C(t)</m> is defined by
          <me>
            \Gamma = \oint_{C} \mathbf{u} \cdot \de\mathbf{x}.
          </me>
          By transforming to Lagrangian variables show that <m>\Gamma</m> is independent of <m>t</m>.
          Deduce that a flow that is initially irrotational (i.e. <m>\bomega = 0</m> at <m>t=0</m>)
          remains irrotational for all time.
        </p>
      </statement>
      <p>
        Note that this is a key result: if a flow is initially irrotational,
        it remains so indefinitely and we can introduce a velocity potential
        <m>\phi</m> such that <m>\mathbf{u} = \nabla \phi</m>.
      </p>
      <answer>
        <figure xml:id="kelvin-circulation-theorem-fig">
          <caption>Curve <m>\Gamma</m> at times <m>t</m> and <m>t+\de t</m>.
            The inset shows the relationship between the two curves.</caption>
          <image source="ch-chapter03-kelvin-circulation.png" width="80%"/>
        </figure>
        <p>
          Assuming a conservative body force <m>-\bnabla\chi</m> per unit volume,
          the Euler equation reads
          <me>
            \DD{\bu}{t}=-\bnabla\left(\frac{p}{\rho}-\chi\right),
          </me>
          <md>
            <mrow>\left.\bu\cdot\de\bx\right|_{t+\de t}\amp=\bu(\bx+\bu(\bx,t)\de t,t+\de t)\cdot\left((\bx+\de\bx+\bu(\bx+\de\bx,t)\de t)-(\bx+\bu(\bx,t)\de t)\right)</mrow>
            <mrow>\amp=\left(\bu(\bx,t)-\bnabla\left(\frac{p}{\rho}-\chi\right)\de t\right)\cdot\left(\de\bx+(\de\bx\cdot\bnabla)\bu\de t\right)</mrow>
            <mrow>\amp=\left.\bu\cdot\de\bx\right|_{t}+\left(\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx\right)\de t.</mrow>
          </md>
          Hence
          <md>
            <mrow>\dd{\Gamma}{t}\amp=\lim_{\de t\rightarrow0}\frac1{\de t}\oint_C\left(\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx\right)\de t</mrow>
            <mrow>\amp=\oint_C\bu\cdot(\de\bx\cdot\bnabla)\bu-\bnabla\left(\frac{p}{\rho}-\chi\right)\cdot\de\bx</mrow>
            <mrow>\amp=\oint_C\bnabla\left(\frac12\bu^2\right)\cdot\de\bx-\bnabla\left(\frac{p}{\rho}+\chi\right)\cdot\de\bx</mrow>
            <mrow>\amp=\oint_C\bnabla\left(\frac12\bu^2-\frac{p}{\rho}-\chi\right)\cdot\de\bx</mrow>
            <mrow>\amp=0.</mrow>
          </md>
          The final equality above follows because the line integral of a gradient around a closed curve is zero.
          Thus <m>\Gamma</m> is independent of <m>t</m>.
          If the flow is initially irrotational, then <m>\Gamma=0</m> at <m>t=0</m>
          for any closed curve <m>C(0)</m>, and hence <m>\Gamma=0</m> for all time.
          Since this holds for any closed curve, it follows that <m>\omega=\bnabla\times\bu=0</m> for all time.
        </p>
      </answer>
    </exercise>
  </exercises>
</chapter>